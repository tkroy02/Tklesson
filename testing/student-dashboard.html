<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard | Learning Scheduler</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="dashboard.css">

<!-- Firebase SDKs - Using compat version for easier integration -->
<script src="https://www.gstatic.com/firebasejs/12.2.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.2.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore-compat.js"></script>
</head>
<body>

<div class="menu-toggle" id="menuToggle">
  <i class="fas fa-bars"></i>
</div>

<div class="dashboard-container">
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <img src="Tklesson3.png" alt="Tklesson Logo">
        <h1>Tklesson</h1>
      </div>
      <div class="user-info">
        <div class="user-avatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="user-details">
          <h3 id="userName">Loading...</h3>
          <p id="userRole">Student</p>
        </div>
      </div>
    </div>

    <ul class="sidebar-menu">
      <li class="menu-item">
        <a href="#profile" class="active" data-section="profile">
          <i class="fas fa-user-circle"></i>
          <span>Profile</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="#scheduling" data-section="scheduling">
          <i class="fas fa-calendar-alt"></i>
          <span>Scheduling</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="#tutors" data-section="tutors">
          <i class="fas fa-user-tie"></i>
          <span>My Tutors</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="#bookings" data-section="bookings">
          <i class="fas fa-bookmark"></i>
          <span>My Bookings</span>
        </a>
      </li>
      <li class="menu-item">
        <a href="#sessions" data-section="sessions">
          <i class="fas fa-history"></i>
          <span>Sessions History</span>
        </a>
      </li>
    </ul>
  </aside>

  <main class="main-content">
    <div class="top-bar">
      <div class="page-title">
        <h2>Student Dashboard</h2>
        <p>Welcome back! Here's your learning overview</p>
      </div>
      <div class="top-bar-actions">
        <div class="notification-btn">
          <i class="fas fa-bell"></i>
          <span class="notification-badge">3</span>
        </div>
        <button class="logout-btn" id="logoutBtn">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>

    <div class="stats-container">
      <div class="stat-card">
        <div class="stat-icon blue">
          <i class="fas fa-bookmark"></i>
        </div>
        <div class="stat-value" id="upcomingSessionsCount">0</div>
        <div class="stat-label">Upcoming Sessions</div>
      </div>
      <div class="stat-card">
        <div class="stat-icon green">
          <i class="fas fa-user-tie"></i>
        </div>
        <div class="stat-value" id="tutorsCount">0</div>
        <div class="stat-label">Active Tutors</div>
      </div>
      <div class="stat-card">
        <div class="stat-icon pink">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-value" id="hoursLearned">0</div>
        <div class="stat-label">Hours Learned</div>
      </div>
    </div>

    <section id="profile" class="dashboard-section active">
      <div class="section-header">
        <h3><i class="fas fa-user-circle"></i> Profile Information</h3>
      </div>

      <div class="profile-card">
        <div class="profile-avatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="profile-details">
          <h3 id="profileName">Loading...</h3>
          <p><i class="fas fa-envelope"></i> <span id="profileEmail">Loading...</span></p>
          <p><i class="fas fa-user-tag"></i> <span id="profileRole">Student Account</span></p>
          <span class="status-badge status-verified" id="profileStatus">Verified</span>
        </div>
        <button class="edit-profile-btn" id="editProfileBtn">Edit Profile</button>
      </div>

      <div class="section-header">
        <h3><i class="fas fa-cog"></i> Account Settings</h3>
      </div>

      <form id="profileForm" style="display: none;">
        <div class="form-row">
          <div class="form-group">
            <label for="fullName">Full Name</label>
            <input type="text" id="fullName" class="form-control">
          </div>
          <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" class="form-control" disabled>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" id="phone" class="form-control">
          </div>
          <div class="form-group">
            <label for="role">Account Type</label>
            <input type="text" id="role" class="form-control" value="Student" disabled>
          </div>
        </div>
        <button type="button" class="save-btn" id="saveProfileBtn">Save Changes</button>
      </form>
    </section>

    <section id="scheduling" class="dashboard-section">
      <div class="section-header">
        <h3><i class="fas fa-calendar-alt"></i> New Booking</h3>
      </div>
      
      <form id="schedulingForm">
        <div class="form-group">
          <label for="tutor">Select Tutor *</label>
          <select id="tutor" class="form-control" required>
            <option value="">Select a tutor...</option>
          </select>
          <div class="spinner" id="tutorSpinner" style="display: none;"></div>
        </div>
        
        <div class="form-group">
          <label for="subject">Subject *</label>
          <select id="subject" class="form-control" required disabled>
            <option value="">Select a tutor first</option>
          </select>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="date">Date *</label>
            <input type="date" id="date" class="form-control" required>
          </div>
          <div class="form-group">
            <label for="time">Time *</label>
            <input type="time" id="time" class="form-control" required min="08:00" max="20:00">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="duration">Duration *</label>
            <select id="duration" class="form-control" required>
              <option value="1">1 hour</option>
              <option value="1.5" selected>1.5 hours</option>
              <option value="2">2 hours</option>
            </select>
          </div>
          <div class="form-group">
            <label for="sessionType">Session Type *</label>
            <select id="sessionType" class="form-control" required>
              <option value="online">Online (Google Meet)</option>
              <option value="in-person">In-Person</option>
            </select>
          </div>
        </div>
        
        <div class="form-group">
          <label for="notes">Session Notes (Optional)</label>
          <textarea id="notes" class="form-control" rows="4" 
                    placeholder="What would you like to focus on during this session? Any specific topics or areas of difficulty?"></textarea>
        </div>
        
        <div class="form-group" id="priceSummary" style="display: none;">
          <h4>Price Summary</h4>
          <p>Hourly Rate: $<span id="hourlyRate">0</span></p>
          <p>Duration: <span id="durationDisplay">0</span> hours</p>
          <p><strong>Total: $<span id="totalPrice">0</span></strong></p>
        </div>
        
        <button type="submit" class="save-btn" id="scheduleBtn">
          <i class="fas fa-calendar-check"></i> Schedule Session
        </button>
      </form>
    </section>

    <section id="tutors" class="dashboard-section">
      <div class="section-header">
        <h3><i class="fas fa-user-tie"></i> Find Tutors</h3>
      </div>

      <div class="tabs">
        <div class="tab active" data-tab="my-tutors">My Tutors</div>
        <div class="tab" data-tab="available-tutors">Available Tutors</div>
      </div>

      <div class="search-container" style="margin-bottom: 20px; display: none;" id="tutorSearchContainer">
        <input type="text" id="tutorSearch" class="form-control" placeholder="Search tutors by name or subject...">
      </div>

      <div class="tab-content active" id="my-tutors-tab">
        <div id="myTutorsContainer">
          <p>Loading your tutors...</p>
        </div>
      </div>

      <div class="tab-content" id="available-tutors-tab">
        <div id="availableTutorsContainer">
          <div class="spinner" id="tutorsSpinner"></div>
        </div>
      </div>
    </section>

    <section id="bookings" class="dashboard-section">
      <div class="section-header">
        <h3><i class="fas fa-bookmark"></i> My Bookings</h3>
      </div>
      
      <div style="margin-bottom: 20px;">
        <label>Filter by:</label>
        <select id="bookingFilter" class="form-control" style="width: 200px;">
          <option value="all">All Bookings</option>
          <option value="upcoming">Upcoming</option>
          <option value="reschedule">Reschedule Requests</option>
          <option value="pending">Pending</option>
        </select>
      </div>
      
      <div id="bookingsContainer">
        <p>Loading your bookings...</p>
      </div>
    </section>

    <section id="sessions" class="dashboard-section">
      <div class="section-header">
        <h3><i class="fas fa-history"></i> Sessions History</h3>
      </div>
      
      <div style="margin-bottom: 20px; display: flex; gap: 15px; align-items: center;">
        <div>
          <label>Filter by:</label>
          <select id="historyFilter" class="form-control" style="width: 200px;">
            <option value="all">All Time</option>
            <option value="month">This Month</option>
            <option value="3months">Last 3 Months</option>
            <option value="year">This Year</option>
          </select>
        </div>
        <div>
          <label>Action Type:</label>
          <select id="actionTypeFilter" class="form-control" style="width: 200px;">
            <option value="all">All Actions</option>
            <option value="student booked">Student Booked</option>
            <option value="tutor confirmed">Tutor Confirmed</option>
            <option value="auto-confirmed">Auto-Confirmed</option>
            <option value="completed">Completed</option>
            <option value="student cancelled">Student Cancelled</option>
            <option value="tutor cancelled">Tutor Cancelled</option>
            <option value="tutor reschedule request">Tutor Reschedule Request</option>
            <option value="student reschedule request">Student Reschedule Request</option>
            <option value="rescheduled">Rescheduled</option>
          </select>
        </div>
      </div>

      <div id="sessionsContainer">
        <div class="spinner" id="sessionsSpinner"></div>
      </div>
      <button id="loadMoreBtn" class="btn-outline" style="display: none; margin: 20px auto;">
        <i class="fas fa-chevron-down"></i> Load More Sessions
      </button>
    </section>
  </main>
</div>

<script src="js/tutor-dashboard.js" defer></script>
</body>

</html>
