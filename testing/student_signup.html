<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Registration Form</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<script src="https://tklesson.com/resources-loader.js"></script>
<script>loadCommonResources();</script>

<style>
        :root {
            --primary: #4361ee;
            --primary-light: #6a7de9;
            --secondary: #3a0ca3;
            --success: #4cc9f0;
            --accent: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --radius: 16px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fb 0%, #e4e9f2 100%);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 1100px;
            overflow: hidden;
            transform: translateY(0);
            transition: var(--transition);
        }
        
        .container:hover {
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 35px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 60%);
            transform: rotate(30deg);
        }
        
        header h1 {
            margin-bottom: 15px;
            font-size: 36px;
            font-weight: 700;
            position: relative;
        }
        
        header p {
            opacity: 0.9;
            font-size: 18px;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }
        
        .progress-container {
            padding: 25px 35px;
            background: var(--light);
            position: relative;
        }
        
        .progress-bar {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin-bottom: 30px;
        }
        
        .progress-bar::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            transform: translateY(-50%); 
            height: 8px;
            width: 100%;
            background-color: var(--light-gray);
            z-index: 1;
            border-radius: 4px;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            height: 8px;
            width: var(--progress, 0%);
            background: linear-gradient(to right, var(--primary), var(--success));
            z-index: 1;
            transition: width 0.5s ease;
            border-radius: 4px;
        }
        
        .progress-step {
            width: 55px;
            height: 55px;
            background-color: var(--light-gray);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--dark);
            z-index: 2;
            position: relative;
            transition: var(--transition);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .progress-step.active {
            background-color: var(--primary);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(67, 97, 238, 0.4);
        }
        
        .progress-step i {
            display: none;
        }
        
        .progress-step.completed {
            background-color: var(--success);
            color: white;
            box-shadow: 0 6px 15px rgba(76, 201, 240, 0.4);
        }
        
        .progress-step.completed span {
            display: none;
        }
        
        .progress-step.completed i {
            display: block;
        }
        
        .progress-step-title {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 12px;
            font-size: 14px;
            color: var(--gray);
            white-space: nowrap;
            font-weight: 600;
        }
        
.btn-outline {
    background: transparent;
    color: var(--primary);
    border: 2px solid var(--primary);
    padding: 14px 25px;
}

.btn-outline:hover {
    background: var(--primary);
    color: white;
}

        .form-container {
            padding: 40px;
        }
        
        .form-step {
            display: none;
        }
        
        .form-step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h2 {
            margin-bottom: 30px;
            color: var(--primary);
            text-align: center;
            font-size: 32px;
            font-weight: 700;
            position: relative;
            padding-bottom: 15px;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 5px;
            background: linear-gradient(to right, var(--primary), var(--success));
            border-radius: 3px;
        }
        
        .form-group {
            margin-bottom: 30px;
        }
        
        label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--dark);
            font-size: 17px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--light-gray);
            border-radius: var(--radius);
            font-size: 16px;
            transition: var(--transition);
            background-color: #f8f9fa;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.2);
            background-color: white;
        }
        

        /* Availability Slots Styles */
.availability-container {
    max-height: 400px;
    overflow-y: auto;
    padding: 15px;
    border: 2px solid var(--light-gray);
    border-radius: var(--radius);
    background: white;
}

.availability-slot {
    background: #f8f9fa;
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 15px;
    border-left: 4px solid var(--primary);
    transition: var(--transition);
}

.availability-slot:hover {
    background: #e9ecef;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.slot-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--light-gray);
}

.slot-header span {
    font-weight: 600;
    color: var(--primary);
}

.remove-slot {
    background: #e63946;
    color: white;
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition);
}

.remove-slot:hover {
    background: #c1121f;
    transform: scale(1.1);
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 15px;
}

@media (max-width: 768px) {
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .availability-slot {
        padding: 15px;
    }
} 

        textarea {
            min-height: 130px;
            resize: vertical;
        }
        
        .checkbox-container {
            max-height: 300px;
            overflow-y: auto;
            padding: 15px;
            border: 2px solid var(--light-gray);
            border-radius: var(--radius);
            background: white;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(230px, 1fr));
            gap: 15px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background-color: #f8f9fa;
            border-radius: var(--radius);
            transition: var(--transition);
        }
        
        .checkbox-item:hover {
            background-color: #e9ecef;
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.05);
        }
        
        .checkbox-item input {
            width: auto;
            margin-right: 15px;
            transform: scale(1.2);
        }
        
        .btn-container {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        
        button {
            padding: 16px 35px;
            border: none;
            border-radius: var(--radius);
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .btn-prev {
            background-color: var(--light);
            color: var(--dark);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-prev:hover {
            background-color: #e2e6ea;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .btn-next, .btn-submit {
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            color: white;
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }
        
        .btn-next:hover, .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(67, 97, 238, 0.4);
            background: linear-gradient(to right, var(--primary-light), var(--primary));
        }


  .btn-loading {
    position: relative;
    color: transparent !important;
  }
  
  .btn-loading::after {
    content: '';
    position: absolute;
    width: 20px;
    height: 20px;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    margin: auto;
    border: 3px solid transparent;
    border-top-color: #ffffff;
    border-radius: 50%;
    animation: button-loading-spinner 1s ease infinite;
  }
  
  @keyframes button-loading-spinner {
    from {
      transform: rotate(0turn);
    }
    to {
      transform: rotate(1turn);
    }
  }

        
        .firestore-response {
            margin-top: 30px;
            padding: 25px;
            border-radius: var(--radius);
            background-color: #f0f9ff;
            border-left: 5px solid var(--primary);
            display: none;
        }
        
        .success-message {
            display: none;
            text-align: center;
            padding: 60px 40px;
        }
        
        .success-message i {
            font-size: 80px;
            color: var(--success);
            margin-bottom: 30px;
            animation: bounce 1s ease;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-25px);}
            60% {transform: translateY(-15px);}
        }
        
        .success-message h2 {
            color: var(--success);
            margin-bottom: 25px;
            animation: fadeIn 1s ease;
        }
        
        .success-message p {
            margin-bottom: 20px;
            font-size: 18px;
            color: var(--gray);
            line-height: 1.8;
        }
        
        .hidden {
            display: none;
        }
        
        .subject-category {
            margin-top: 20px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-gray);
            color: var(--primary);
            font-weight: 600;
            font-size: 18px;
        }
        
        .error-message {
            color: #e63946;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
        
/* Terms and Conditions Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: none; /* Correctly hidden by default */
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }


        .modal-overlay.active {
            display: flex; /* Correctly shown when active */
            opacity: 1;
            visibility: visible;
        }
        
        .terms-modal {
            background-color: white;
            border-radius: var(--radius);
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: translateY(50px);
            transition: transform 0.4s ease;
        }
        
        .modal-overlay.active .terms-modal {
            transform: translateY(0);
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px 25px;
            position: relative;
        }
        
        .modal-header h2 {
            color: white;
            margin: 0;
            padding: 0;
            text-align: left;
            font-size: 24px;
        }
        
        .modal-header h2::after {
            display: none;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 25px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            padding: 25px;
            overflow-y: auto;
            flex-grow: 1;
        }
        
        .modal-content section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .modal-content h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .modal-content ul {
            margin: 10px 0 10px 20px;
        }
        
        .modal-content li {
            margin-bottom: 8px;
        }
        
        .modal-footer {
            padding: 20px 25px;
            background-color: var(--light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .terms-agreement {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .terms-agreement input {
            width: auto;
            transform: scale(1.2);
        }
        
        .modal-buttons {
            display: flex;
            gap: 15px;
        }
        
        .btn-cancel {
            background-color: var(--light);
            color: var(--dark);
        }
        
        .btn-agree {
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            color: white;
        }


        @media (max-width: 768px) {
            .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .progress-step {
                width: 45px;
                height: 45px;
            }
            
            .btn-container {
                flex-direction: column;
                gap: 20px;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
            
            header {
                padding: 25px 20px;
            }
            
            .form-container {
                padding: 25px;
            }
            
            h2 {
                font-size: 26px;
            }
        }
    </style>
</head>
<body>

<div class="modal-overlay" id="termsModal">
    <div class="terms-modal">
        <div class="modal-header">
            <h2>Tklesson Student Terms and Conditions</h2>
            <button class="close-modal" id="closeModal">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-content">
            <h3>1. Introduction</h3>
            <p>Welcome to Tklesson! These Terms and Conditions govern your use of our student registration services. By registering, you agree to these terms.</p>
            
            <h3>2. User Responsibilities</h3>
            <ul>
                <li>Provide accurate and complete personal and academic information.</li>
                <li>Maintain the confidentiality of your account password.</li>
                <li>Use the platform for its intended purpose of connecting with tutors for educational assistance.</li>
            </ul>
            
            <h3>3. Privacy Policy</h3>
            <p>Your privacy is important to us. Our Privacy Policy, which is incorporated by reference, describes how we collect, use, and protect your personal information.</p>
            
            <h3>4. Tutoring Services</h3>
            <p>Tklesson acts as a platform to connect students and tutors. We are not responsible for the quality of tutoring services provided by individual tutors.</p>
            
            <h3>5. Prohibited Conduct</h3>
            <ul>
                <li>Using the platform for any illegal or unauthorized purpose.</li>
                <li>Harassing or bullying other users.</li>
                <li>Distributing malicious code or content.</li>
            </ul>
            
            <h3>6. Limitation of Liability</h3>
            <p>Tklesson will not be liable for any damages arising from your use of the platform. Your use of the service is at your own risk.</p>
            
            <h3>7. Termination</h3>
            <p>We reserve the right to terminate or suspend your account at our sole discretion, without notice, for conduct that we believe violates these Terms and Conditions or is harmful to other users of the platform.</p>
        </div>
        <div class="modal-footer">
            <div class="terms-agreement">
                <input type="checkbox" id="agreeTerms" required>
                <label for="agreeTerms">I have read and agree to the Tklesson Terms and Conditions and Privacy Policy</label>
            </div>
            <div class="modal-buttons">
                <button class="btn-cancel" id="cancelButton">Cancel</button>
                <button class="btn-agree" id="agreeButton" disabled>Agree & Continue</button>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <header>
        <h1>Student Registration Form</h1>
        <p>Join our learning community and find the perfect tutor for your needs</p>
    </header>
    
    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-step active" data-title="Personal">
                <span>1</span>
                <i class="fas fa-check"></i>
                <div class="progress-step-title">Personal</div>
            </div>
            <div class="progress-step" data-title="Academic">
                <span>2</span>
                <i class="fas fa-check"></i>
                <div class="progress-step-title">Academic</div>
            </div>
            <div class="progress-step" data-title="Account">
                <span>3</span>
                <i class="fas fa-check"></i>
                <div class="progress-step-title">Account</div>
            </div>
        </div>
    </div>
    
    <div class="form-container">
        <form id="studentRegistration">
            <div class="form-step active" id="step-1">
                <h2>Personal Information</h2>
                
                <div class="form-group">
                    <label for="fullName">Full Name *</label>
                    <input type="text" id="fullName" name="fullName" required>
                    <div class="error-message" id="nameError">Please enter your full name</div>
                </div>
                
                <div class="form-group">
                    <label for="email">Email Address *</label>
                    <input type="email" id="email" name="email" required>
                    <div class="error-message" id="emailError">Please enter a valid email address</div>
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" name="phone">
                </div>
                
                <div class="form-group">
                    <label for="age">Age *</label>
                    <input type="number" id="age" name="age" min="5" max="100" required>
                    <div class="error-message" id="ageError">Please enter a valid age</div>
                </div>
                
                <div class="form-group">
                    <label for="parentName">Parent/Guardian Name (if under 18)</label>
                    <input type="text" id="parentName" name="parentName">
                </div>
                
                <div class="form-group">
                    <label for="parentEmail">Parent/Guardian Email (if under 18)</label>
                    <input type="email" id="parentEmail" name="parentEmail">
                </div>
                
                <div class="btn-container">
                    <div></div>
                    <button type="button" class="btn-next">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>

            <div class="form-step" id="step-2">
                <h2>Academic Information</h2>
                
                <div class="form-group">
                    <label for="gradeLevel">Current Grade Level *</label>
                    <select id="gradeLevel" name="gradeLevel" required>
                        <option value="">Select grade level</option>
                        <option value="Elementary School">Elementary School</option>
                        <option value="Middle School">Middle School</option>
                        <option value="High School">High School</option>
                        <option value="College">College</option>
                        <option value="Adult Education">Adult Education</option>
                    </select>
                    <div class="error-message" id="gradeError">Please select a grade level</div>
                </div>

                <div class="form-group">
                    <label for="specificgradeLevel">Specific Grade Level *</label>
                    <select id="specificgradeLevel" name="specificgradeLevel" required>
                        <option value="">Select grade level</option>
                        <option value="5th Grade">5th Grade</option>
                        <option value="6th Grade">6th Grade</option>
                        <option value="7th Grade">7th Grade</option>
                        <option value="8th Grade">8th Grade</option>
                        <option value="9th Grade">9th Grade</option>
                        <option value="10th Grade">10th Grade</option>
                        <option value="11th Grade">11th Grade</option>
                        <option value="12th Grade">12th Grade</option>
                    </select>
                    <div class="error-message" id="specificGradeError">Please select a specific grade level</div>
                </div>

                <div class="form-group">
                    <label for="schoolName">School Name</label>
                    <input type="text" id="schoolName" name="schoolName">
                </div>
                
<div class="form-group">
                        <label>Subjects of Interest *</label>
                        <div class="checkbox-container">
                            <div class="subject-category">Mathematics</div>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="math" name="subjects" value="Mathematics">
                                    <label for="math">Mathematics</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="algebra1" name="subjects" value="Algebra 1">
                                    <label for="algebra1">Algebra 1</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="algebra2" name="subjects" value="Algebra 2">
                                    <label for="algebra2">Algebra 2</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="geometry" name="subjects" value="Geometry">
                                    <label for="geometry">Geometry</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="pre-calc" name="subjects" value="Pre-Calculus">
                                    <label for="pre-calc">Pre-Calculus</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-calc" name="subjects" value="AP Calculus">
                                    <label for="ap-calc">AP Calculus</label>
                                </div>
                            </div>

                            <div class="subject-category">Sciences</div>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="physics9" name="subjects" value="Physics 9">
                                    <label for="physics9">Physics 9</label>
                                </div>

                                <div class="checkbox-item">
                                    <input type="checkbox" id="physics10" name="subjects" value="Physics 10">
                                    <label for="physics10">Physics 10</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="physics11" name="subjects" value="Physics 11">
                                    <label for="physics11">Physics 12</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="physics12" name="subjects" value="Physics 12">
                                    <label for="physics12">Physics 12</label>
                                </div>


                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-physics1" name="subjects" value="AP Physics 1">
                                    <label for="ap-physics1">AP Physics 1</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-physics2" name="subjects" value="AP Physics 2">
                                    <label for="ap-physics2">AP Physics 2</label>
                                </div>

                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-physics-c-mech" name="subjects" value="AP Physics C (Mechanics)">
                                    <label for="ap-physics-c-mech">AP Physics C (Mechanics)</label>
                                </div>

                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-physics-c-e-m" name="subjects" value="AP Physics C (E&M)">
                                    <label for="ap-physics-c-e-m">AP Physics C (E&M)</label>
                                </div>

                                <div class="checkbox-item">
                                    <input type="checkbox" id="chemistry10" name="subjects" value="Chemistry 10">
                                    <label for="chemistry10">Chemistry 10</label>
                                </div>

                                <div class="checkbox-item">
                                    <input type="checkbox" id="chemistry11" name="subjects" value="Chemistry 11">
                                    <label for="chemistry11">Chemistry 11</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="chemistry12" name="subjects" value="Chemistry 12">
                                    <label for="chemistry12">Chemistry 12</label>
                                </div>

                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-chemistry" name="subjects" value="AP Chemistry">
                                    <label for="ap-chemistry">AP Chemistry</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="biology11" name="subjects" value="Biology 11">
                                    <label for="biology11">Biology 11</label>
                                </div>

                                <div class="checkbox-item">
                                    <input type="checkbox" id="biology12" name="subjects" value="Biology 12">
                                    <label for="biology12">Biology 12</label>
                                </div>

                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-biology" name="subjects" value="AP Biology">
                                    <label for="ap-biology">AP Biology</label>
                                </div>

                            </div>

                            <div class="subject-category">English & Humanities</div>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="english" name="subjects" value="English">
                                    <label for="english">English</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="literature" name="subjects" value="Literature">
                                    <label for="literature">Literature</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="writing" name="subjects" value="Writing">
                                    <label for="writing">Writing</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="history" name="subjects" value="History">
                                    <label for="history">History</label>
                                </div>
                            </div>


                            <div class="subject-category">Social Science & Business</div>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="economics" name="subjects" value="Economics">
                                    <label for="economics">Economics</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-macroeconomics" name="subjects" value="AP Macroeconomics">
                                    <label for="ap-macroeconomics">AP Macroeconomics</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-microeconomics" name="subjects" value="AP Microeconomics">
                                    <label for="ap-microeconomics">AP Microeconomics</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="psychology" name="subjects" value="Psychology">
                                    <label for="psychology">Psychology</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="ap-psychology" name="subjects" value="AP Psychology">
                                    <label for="ap-psychology">AP Psychology</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="sociology" name="subjects" value="Sociology">
                                    <label for="sociology">Sociology</label>
                                </div>

                            </div>

                            <div class="subject-category">Foreign Languages</div>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="spanish" name="subjects" value="Spanish">
                                    <label for="spanish">Spanish</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="french" name="subjects" value="French">
                                    <label for="french">French</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="german" name="subjects" value="German">
                                    <label for="german">German</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="italian" name="subjects" value="Italian">
                                    <label for="italian">Italian</label>
                                </div>
                            </div>
                            
                            <div class="subject-category">Test Preparation</div>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="sat" name="subjects" value="SAT">
                                    <label for="sat">SAT</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="act" name="subjects" value="ACT">
                                    <label for="act">ACT</label>
                                </div>
                            </div>
                        </div>
                        <div class="error-message" id="subjectError">Please select at least one subject</div>
                    </div>


                <div class="form-group">
                    <label for="learningGoals">Learning Goals</label>
                    <textarea id="learningGoals" name="learningGoals" placeholder="What do you hope to achieve with tutoring?"></textarea>
                </div>
                
                <div class="form-group">
    <label for="timezone">Your Time Zone *</label>
    <select id="timezone" name="timezone" required>
        <option value="">Select your time zone</option>
        <option value="EST">Eastern Time (EST)</option>
        <option value="CST">Central Time (CST)</option>
        <option value="MST">Mountain Time (MST)</option>
        <option value="PST">Pacific Time (PST)</option>
        <option value="AKST">Alaska Time (AKST)</option>
        <option value="HST">Hawaii Time (HST)</option>
    </select>
    <div class="error-message" id="timezoneError">Please select your time zone</div>
</div>

<div class="form-group">
    <label>Preferred Session Days & Times *</label>
    <div class="availability-container" id="availabilityContainer">
        <!-- Availability slots will be added here dynamically -->
        <div class="availability-slot">
            <div class="slot-header">
                <span>Session Time Slot 1</span>
                <button type="button" class="remove-slot" onclick="removeAvailabilitySlot(this)" style="display: none;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="slot-fields">
                <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label>Day of Week *</label>
                        <select name="preferredDays" required>
                            <option value="">Select day</option>
                            <option value="monday">Monday</option>
                            <option value="tuesday">Tuesday</option>
                            <option value="wednesday">Wednesday</option>
                            <option value="thursday">Thursday</option>
                            <option value="friday">Friday</option>
                            <option value="saturday">Saturday</option>
                            <option value="sunday">Sunday</option>
                        </select>
                    </div>
                    <div>
                        <label>Start Time *</label>
                        <input type="time" name="startTime" required min="06:00" max="23:00">
                    </div>
                    <div>
                        <label>End Time *</label>
                        <input type="time" name="endTime" required min="07:00" max="24:00">
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <button type="button" class="btn-outline" onclick="addAvailabilitySlot()" style="margin-top: 10px;">
        <i class="fas fa-plus"></i> Add Another Time Slot
    </button>
    <div class="error-message" id="availabilityError">Please add at least one preferred time slot</div>
</div>

<div class="form-group">
    <label for="urgency">How soon do you need tutoring? *</label>
    <select id="urgency" name="urgency" required>
        <option value="">Select urgency</option>
        <option value="asap">ASAP - Within 24 hours</option>
        <option value="this_week">This Week</option>
        <option value="next_week">Next Week</option>
        <option value="flexible">Flexible - No specific deadline</option>
        <option value="ongoing">Ongoing Support</option>
    </select>
    <div class="error-message" id="urgencyError">Please select how soon you need tutoring</div>
</div>

                <div class="btn-container">
                    <button type="button" class="btn-prev"><i class="fas fa-arrow-left"></i> Previous</button>
                    <button type="button" class="btn-next">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>

            <div class="form-step" id="step-3">
                <h2>Account Creation</h2>
                
                <div class="form-group">
                    <label for="password">Create Password *</label>
                    <input type="password" id="password" name="password" required>
                    <div class="error-message" id="passwordError">Password must be at least 6 characters</div>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password *</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required>
                    <div class="error-message" id="confirmError">Passwords do not match</div>
                </div>
                
                <div class="form-group">
                    <label for="terms">
                        <input type="checkbox" id="terms" name="terms" required>
                        I agree to the <a href="#" id="showTerms">Terms and Conditions</a> *
                    </label>
                    <div class="error-message" id="termsError">You must agree to the terms</div>
                </div>

                <div class="btn-container">
                    <button type="button" class="btn-prev"><i class="fas fa-arrow-left"></i> Previous</button>
                    <button type="submit" class="btn-submit">Create Account</button>
                </div>
            </div>

            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i>
                <h2>Registration Successful!</h2>
                <p>Thank you for registering as a student. A verification email has been sent to your inbox.</p>
                <p>You will be redirected to the login page in <span id="countdown">5</span> seconds.</p>
            </div>
        </form>

<div class="firestore-response" id="firestoreResponse">
                <h3>Firestore Data Structure</h3>
                <pre id="firestoreData">Data will appear here after submission</pre>
            </div>
        </div>
    </div>
        

    <script type="module">
    // Import the functions you need from the SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyBjo5LY4EsFlX8j_8NbLUObooUsCqJM8KM",
        authDomain: "tk-scheduler.firebaseapp.com",
        projectId: "tk-scheduler",
        storageBucket: "tk-scheduler.appspot.com",
        messagingSenderId: "746606755052",
        appId: "1:746606755052:web:d7eae92976cb2f2fa9f9c9",
        measurementId: "G-Q5L607R3N7"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Global functions for availability slots
    window.addAvailabilitySlot = function() {
        const container = document.getElementById('availabilityContainer');
        const slots = container.querySelectorAll('.availability-slot');
        const slotCount = slots.length + 1;
        
        const newSlot = document.createElement('div');
        newSlot.className = 'availability-slot';
        newSlot.innerHTML = `
            <div class="slot-header">
                <span>Session Time Slot ${slotCount}</span>
                <button type="button" class="remove-slot" onclick="removeAvailabilitySlot(this)">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="slot-fields">
                <div class="form-row">
                    <div>
                        <label>Day of Week *</label>
                        <select name="preferredDays" required>
                            <option value="">Select day</option>
                            <option value="monday">Monday</option>
                            <option value="tuesday">Tuesday</option>
                            <option value="wednesday">Wednesday</option>
                            <option value="thursday">Thursday</option>
                            <option value="friday">Friday</option>
                            <option value="saturday">Saturday</option>
                            <option value="sunday">Sunday</option>
                        </select>
                    </div>
                    <div>
                        <label>Start Time *</label>
                        <input type="time" name="startTime" required min="06:00" max="23:00">
                    </div>
                    <div>
                        <label>End Time *</label>
                        <input type="time" name="endTime" required min="07:00" max="24:00">
                    </div>
                </div>
            </div>
        `;
        
        container.appendChild(newSlot);
        
        // Show remove buttons on all slots if we have more than one
        const removeButtons = document.querySelectorAll('.remove-slot');
        if (slotCount > 1) {
            removeButtons.forEach(btn => {
                btn.style.display = 'flex';
            });
        }
        
        // Add event listeners for time validation
        addTimeValidation(newSlot);
    };

    window.removeAvailabilitySlot = function(button) {
        const slot = button.closest('.availability-slot');
        slot.remove();
        
        // Update slot numbers
        const slots = document.querySelectorAll('.availability-slot');
        slots.forEach((slot, index) => {
            slot.querySelector('.slot-header span').textContent = `Session Time Slot ${index + 1}`;
        });
        
        // Hide remove button if only one slot remains
        if (slots.length === 1) {
            document.querySelector('.remove-slot').style.display = 'none';
        }
    };

    // Helper functions
    function addTimeValidation(slot) {
        const startTimeInput = slot.querySelector('input[name="startTime"]');
        const endTimeInput = slot.querySelector('input[name="endTime"]');
        
        startTimeInput.addEventListener('change', validateTimeSlot);
        endTimeInput.addEventListener('change', validateTimeSlot);
    }

    function validateTimeSlot() {
        const slot = this.closest('.availability-slot');
        const startTime = slot.querySelector('input[name="startTime"]').value;
        const endTime = slot.querySelector('input[name="endTime"]').value;
        
        if (startTime && endTime) {
            if (startTime >= endTime) {
                slot.style.borderLeftColor = '#e63946';
                return false;
            } else {
                slot.style.borderLeftColor = 'var(--primary)';
                return true;
            }
        }
        return true;
    }

    function validateTimeSlots() {
        const slots = document.querySelectorAll('.availability-slot');
        let isValid = true;
        
        slots.forEach((slot) => {
            const startTime = slot.querySelector('input[name="startTime"]').value;
            const endTime = slot.querySelector('input[name="endTime"]').value;
            
            if (startTime && endTime && startTime >= endTime) {
                isValid = false;
                slot.style.borderLeftColor = '#e63946';
            } else {
                slot.style.borderLeftColor = 'var(--primary)';
            }
        });
        
        return isValid;
    }

    // Main application logic
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize time validation for the first slot
        const firstSlot = document.querySelector('.availability-slot');
        if (firstSlot) {
            addTimeValidation(firstSlot);
        }

        // Form steps navigation
        const form = document.getElementById('studentRegistration');
        const steps = document.querySelectorAll('.form-step');
        const progressSteps = document.querySelectorAll('.progress-step');
        const progressBar = document.querySelector('.progress-bar');
        const firestoreResponse = document.getElementById('firestoreResponse');
        const firestoreData = document.getElementById('firestoreData');
        const successMessage = document.getElementById('successMessage');
        const countdownElement = document.getElementById('countdown');

        // Get all next and previous buttons
        const nextBtns = document.querySelectorAll('.btn-next');
        const prevBtns = document.querySelectorAll('.btn-prev');
        
        let currentStep = 0;
        let countdown = 5;
        let countdownInterval;
        
        // Update form steps
        function updateFormSteps() {
            steps.forEach((step, idx) => {
                if (idx === currentStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
            
            progressSteps.forEach((step, idx) => {
                if (idx < currentStep) {
                    step.classList.add('completed');
                } else {
                    step.classList.remove('completed');
                }
                
                if (idx === currentStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
            
            // Update progress bar
            const progressPercent = (currentStep / (steps.length - 1)) * 100;
            progressBar.style.setProperty('--progress', `${progressPercent}%`);
        }
        
        // Validate email format
        function isValidEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
        
        // Show error message
        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            errorElement.textContent = message;
            errorElement.style.display = 'block';
            return false;
        }
        
        // Hide error message
        function hideError(elementId) {
            const errorElement = document.getElementById(elementId);
            errorElement.style.display = 'none';
            return true;
        }
        
        // Validate current step
        function validateStep(step) {
            let isValid = true;
            
            if (step === 0) {
                // Validate personal information
                const fullName = document.getElementById('fullName').value.trim();
                const email = document.getElementById('email').value.trim();
                const age = document.getElementById('age').value;
                
                if (!fullName) {
                    isValid = showError('nameError', 'Please enter your full name');
                } else {
                    hideError('nameError');
                }
                
                if (!email || !isValidEmail(email)) {
                    isValid = showError('emailError', 'Please enter a valid email address');
                } else {
                    hideError('emailError');
                }
                
                if (!age || age < 5 || age > 100) {
                    isValid = showError('ageError', 'Please enter a valid age');
                } else {
                    hideError('ageError');
                }
            } else if (step === 1) {
                // Validate academic information
                const gradeLevel = document.getElementById('gradeLevel').value;
                const specificGradeLevel = document.getElementById('specificgradeLevel').value;
                const subjects = document.querySelectorAll('input[name="subjects"]:checked');
                const timezone = document.getElementById('timezone').value;
                const urgency = document.getElementById('urgency').value;
                
                // Validate availability slots
                const slots = document.querySelectorAll('.availability-slot');
                let hasValidSlot = false;
                
                slots.forEach(slot => {
                    const day = slot.querySelector('select[name="preferredDays"]').value;
                    const startTime = slot.querySelector('input[name="startTime"]').value;
                    const endTime = slot.querySelector('input[name="endTime"]').value;
                    
                    if (day && startTime && endTime) {
                        hasValidSlot = true;
                    }
                });
                
                if (!gradeLevel) {
                    isValid = showError('gradeError', 'Please select a grade level');
                } else {
                    hideError('gradeError');
                }
                
                if (!specificGradeLevel) {
                    isValid = showError('specificGradeError', 'Please select a specific grade level');
                } else {
                    hideError('specificGradeError');
                }
                
                if (!timezone) {
                    isValid = showError('timezoneError', 'Please select your time zone');
                } else {
                    hideError('timezoneError');
                }
                
                if (!hasValidSlot) {
                    isValid = showError('availabilityError', 'Please add at least one preferred time slot');
                } else {
                    hideError('availabilityError');
                }
                
                if (!urgency) {
                    isValid = showError('urgencyError', 'Please select how soon you need tutoring');
                } else {
                    hideError('urgencyError');
                }
                
                if (subjects.length === 0) {
                    isValid = showError('subjectError', 'Please select at least one subject');
                } else {
                    hideError('subjectError');
                }
            } else if (step === 2) {
                // Validate account information
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const terms = document.getElementById('terms').checked;
                
                if (!password || password.length < 6) {
                    isValid = showError('passwordError', 'Password must be at least 6 characters');
                } else {
                    hideError('passwordError');
                }
                
                if (password !== confirmPassword) {
                    isValid = showError('confirmError', 'Passwords do not match');
                } else {
                    hideError('confirmError');
                }
                
                if (!terms) {
                    isValid = showError('termsError', 'You must agree to the terms');
                } else {
                    hideError('termsError');
                }
            }
            
            return isValid;
        }
        
        // Next button event listeners
        nextBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                if (validateStep(currentStep)) {
                    currentStep++;
                    updateFormSteps();
                }
            });
        });
        
        // Previous button event listeners
        prevBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                currentStep--;
                updateFormSteps();
            });
        });
        
        // Start countdown and redirect
        function startCountdown() {
            countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    window.location.href = 'student-login.html';
                }
            }, 1000);
        }

        // Terms and Conditions Modal functionality
        const termsModal = document.getElementById('termsModal');
        const showTermsLink = document.getElementById('showTerms');
        const closeModal = document.getElementById('closeModal');
        const cancelButton = document.getElementById('cancelButton');
        const agreeButton = document.getElementById('agreeButton');
        const agreeTermsCheckbox = document.getElementById('agreeTerms');
        const termsCheckbox = document.getElementById('terms');

        // Open modal when Terms link is clicked
        showTermsLink.addEventListener('click', function(e) {
            e.preventDefault();
            termsModal.classList.add('active');
        });

        // Close modal functions
        function closeTermsModal() {
            termsModal.classList.remove('active');
        }

        closeModal.addEventListener('click', closeTermsModal);
        cancelButton.addEventListener('click', closeTermsModal);

        // Handle agreement
        agreeButton.addEventListener('click', function() {
            if (agreeTermsCheckbox.checked) {
                termsCheckbox.checked = true;
                hideError('termsError');
                closeTermsModal();
            }
        });

        // Enable/disable Agree button based on checkbox
        agreeTermsCheckbox.addEventListener('change', function() {
            agreeButton.disabled = !this.checked;
        });

        // Close modal when clicking outside content
        termsModal.addEventListener('click', function(e) {
            if (e.target === termsModal) {
                closeTermsModal();
            }
        });
        
        // Form submission
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!validateStep(2)) return;
            
            // Get the submit button
            const submitButton = document.querySelector('.btn-submit');
            
            try {
                // Show loading state
                submitButton.classList.add('btn-loading');
                submitButton.disabled = true;
                submitButton.innerHTML = 'Processing...';

                // Collect availability slots
                const availabilitySlots = [];
                document.querySelectorAll('.availability-slot').forEach(slot => {
                    const day = slot.querySelector('select[name="preferredDays"]').value;
                    const startTime = slot.querySelector('input[name="startTime"]').value;
                    const endTime = slot.querySelector('input[name="endTime"]').value;
                    
                    if (day && startTime && endTime) {
                        availabilitySlots.push({
                            day: day,
                            startTime: startTime,
                            endTime: endTime
                        });
                    }
                });
                
                // Get form values
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const fullName = document.getElementById('fullName').value;
                const phone = document.getElementById('phone').value;
                const age = parseInt(document.getElementById('age').value);
                const parentName = document.getElementById('parentName').value;
                const parentEmail = document.getElementById('parentEmail').value;
                const gradeLevel = document.getElementById('gradeLevel').value;
                const specificgradeLevel = document.getElementById('specificgradeLevel').value;                    
                const schoolName = document.getElementById('schoolName').value;
                const learningGoals = document.getElementById('learningGoals').value;
                const timezone = document.getElementById('timezone').value;
                const urgency = document.getElementById('urgency').value;
                
                // Get selected subjects
                const subjectElements = document.querySelectorAll('input[name="subjects"]:checked');
                const subjects = Array.from(subjectElements).map(el => el.value);

                // Create user with email and password
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;
                
                // Send email verification
                await sendEmailVerification(user);

                // Prepare student data for Firestore
                const studentData = {
                    // Personal Information
                    fullName: fullName,
                    email: email,
                    phone: phone || null,
                    age: age,
                    parentName: parentName || null,
                    parentEmail: parentEmail || null,

                    // Academic Information
                    gradeLevel: gradeLevel,
                    specificgradeLevel: specificgradeLevel,
                    schoolName: schoolName || null,
                    subjects: subjects,
                    learningGoals: learningGoals || null,
                    
                    // NEW: Specific Availability Information
                    timezone: timezone,
                    availabilitySlots: availabilitySlots,
                    urgency: urgency,
                    
                    // Account Information
                    role: "student",
                    status: "active",
                    emailVerified: false,
                    createdAt: serverTimestamp(),
                    updatedAt: serverTimestamp()
                };
                
                // Save student data to Firestore
                await setDoc(doc(db, 'students', user.uid), studentData);

                // Hide all form steps
                steps.forEach(step => {
                    step.style.display = 'none';
                });
                
                // Show success message
                successMessage.style.display = 'block';

                // Start countdown for redirect
                startCountdown();
                
                console.log('Student registered successfully:', user.uid);
                
            } catch (error) {
                console.error('Error during registration:', error);
                let errorMessage = 'An error occurred during registration. ';
                
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage += 'This email is already registered.';
                } else if (error.code === 'auth/weak-password') {
                    errorMessage += 'The password is too weak.';
                } else {
                    errorMessage += 'Please try again.';
                }
                
                alert(errorMessage);
                
                // Reset submit button
                submitButton.classList.remove('btn-loading');
                submitButton.disabled = false;
                submitButton.innerHTML = 'Create Account';
            }
        });

        // Initialize form steps
        updateFormSteps();
        
        // Real-time validation for email field
        document.getElementById('email').addEventListener('blur', function() {
            if (this.value && !isValidEmail(this.value)) {
                showError('emailError', 'Please enter a valid email address');
            } else {
                hideError('emailError');
            }
        });
        
        // Real-time validation for password confirmation
        document.getElementById('confirmPassword').addEventListener('input', function() {
            const password = document.getElementById('password').value;
            if (this.value !== password) {
                showError('confirmError', 'Passwords do not match');
            } else {
                hideError('confirmError');
            }
        });
    });

</script>
</body>
</html>
