<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Section 2.1 – Derivative Definition and Basic Rules</title>

  <script src="https://tklesson.com/resources-loader.js"></script>
  <script>loadCommonResources();</script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    * { box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      line-height: 1.6;
      background: #ffffff;
      color: #00274d;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    #header-placeholder, #footer-placeholder { width: 100%; }

    .page-container { display: flex; flex-grow: 1; }

    .sidebar {
      width: 250px;
      background: #00274d;
      color: white;
      padding: 20px;
      flex-shrink: 0;
      overflow-y: auto;
      max-height: 100vh;
    }

    .sidebar h3 { color: white; margin-top: 0; }
    .sidebar ul { list-style-type: none; padding: 0; }
    .sidebar ul li a {
      display: block;
      padding: 10px;
      color: #c0c0c0;
      text-decoration: none;
      border-bottom: 1px solid #0056b3;
    }
    .sidebar ul li a:hover { background: #0056b3; color: white; }
    .sidebar ul li a.active { background: #0056b3; color: white; font-weight: bold; }

    header {
      background: #00274d;
      color: white;
      padding: 20px;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header img { height: 50px; flex-shrink: 0; }
    header h1 {
      margin: 0;
      font-size: 1.8em;
      color: white;
      text-align: center;
      flex-grow: 1;
      flex-shrink: 1;
      min-width: 0;
      padding: 0 10px;
    }
    header a.home-link {
      color: white;
      text-decoration: none;
      font-size: 1em;
      background: #0056b3;
      padding: 6px 12px;
      border-radius: 6px;
      flex-shrink: 0;
    }
    header a.home-link:hover { background: #0073e6; }

    .footer {
      background: #00274d;
      color: white;
      text-align: center;
      padding: 20px;
      width: 100%;
      flex-shrink: 0;
    }

    .main-content { flex-grow: 1; }
    .container { padding: 20px; max-width: 900px; margin: auto; }

    h2 { color: #0056b3; border-bottom: 2px solid #0056b3; padding-bottom: 5px; }
    h3 { color: #0056b3; }

    .nav-buttons { display: flex; justify-content: space-between; margin: 30px auto; }
    .nav-btn {
      background: #0056b3;
      color: white;
      padding: 12px 25px;
      border-radius: 8px;
      text-decoration: none;
      font-size: 1.1em;
    }
    .nav-btn:hover { background: #0073e6; }

    .example, .tip, .check, .definition, .key-concept, .ap-exam-tip, .worked-example {
      background: #f0f8ff;
      border-left: 5px solid #0056b3;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
    }
    
    .worked-example { border-left-color: #28a745; }
    .definition { border-left-color: #28a745; }
    .key-concept { border-left-color: #ffc107; }
    .ap-exam-tip { border-left-color: #dc3545; }
    
    .check p { font-size: 1.2em; }

    .solution {
      display: none;
      background: #e6f2ff;
      border: 1px solid #0056b3;
      padding: 10px;
      margin-top: 10px;
      border-radius: 6px;
    }

    .show-solution-btn {
      background: #0056b3;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }
    .show-solution-btn:hover { background: #0073e6; }
    
    .interactive-widget {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
    }
    
    .interactive-controls {
      display: flex;
      gap: 10px;
      margin: 10px 0;
    }
    
    .interactive-controls input, .interactive-controls button {
      padding: 8px 12px;
      border: 1px solid #ced4da;
      border-radius: 4px;
    }
    
    .interactive-controls button {
      background: #0056b3;
      color: white;
      cursor: pointer;
    }
    
    .interactive-controls button:hover {
      background: #0073e6;
    }
    
    .interactive-result {
      margin-top: 15px;
      padding: 10px;
      background: #e9ecef;
      border-radius: 4px;
    }
    
    .learning-objectives {
      background: #e7f3ff;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    
    .learning-objectives h3 {
      margin-top: 0;
    }
    
    .learning-objectives ul {
      padding-left: 20px;
    }
    
    .learning-objectives li {
      margin-bottom: 8px;
    }
    
    .table-container {
      overflow-x: auto;
      margin: 20px 0;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th, td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    
    th {
      background-color: #0056b3;
      color: white;
    }
    
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    
    .progress-container {
      margin: 20px 0;
      background: #f1f1f1;
      border-radius: 8px;
      height: 10px;
    }
    
    .progress-bar {
      height: 100%;
      background: #0056b3;
      border-radius: 8px;
      width: 0%;
      transition: width 0.5s ease-in-out;
    }
    
    .section-completion {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .section-completion button {
      background: #0056b3;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
    }
    
    .section-completion button:hover {
      background: #0073e6;
    }
    
    .step-by-step {
      margin: 15px 0;
      padding-left: 20px;
    }
    
    .step {
      margin-bottom: 10px;
      position: relative;
    }
    
    .step-number {
      position: absolute;
      left: -20px;
      background: #0056b3;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8em;
    }
    
    .example-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .example-type {
      background: #0056b3;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.8em;
    }

    @media (max-width: 768px) {
      .page-container { flex-direction: column; }
      .sidebar { width: 100%; max-height: none; order: -1; }
      .interactive-controls { flex-direction: column; }
    }
  </style>
</head>
<body>

  <script type="module" src="firebase-auth.js"></script>

  <div id="header-placeholder"></div>

  <div class="page-container">
    <div id="sidebar-placeholder"></div>

    <div class="main-content">
      <div class="container">
        <h2>2.1 – Derivative Definition and Basic Rules</h2>
        
        <div class="learning-objectives">
          <h3>Learning Objectives</h3>
          <p>By the end of this section, you should be able to:</p>
          <ul>
            <li>Understand the limit definition of the derivative</li>
            <li>Apply the power rule, constant rule, sum/difference rule, and constant multiple rule</li>
            <li>Differentiate polynomial functions</li>
            <li>Interpret derivatives as instantaneous rates of change</li>
            <li>Solve basic derivative problems using multiple approaches</li>
          </ul>
        </div>
        
        <div class="section-completion">
          <span>Section Progress</span>
          <button id="mark-complete-btn">Mark as Complete</button>
        </div>
        <div class="progress-container">
          <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="definition">
          <h3>Definition of the Derivative</h3>
          <p>The derivative of a function at a point represents the instantaneous rate of change of the function at that point. Geometrically, it represents the slope of the tangent line to the function's graph.</p>
          <p>The derivative of function \( f(x) \) is defined as:</p>
          <p>\[ f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h} \]</p>
          <p>This is sometimes called the <strong>difference quotient</strong> or the <strong>limit definition of the derivative</strong>.</p>
        </div>

        <div class="example">
          <p><strong>Example 1:</strong> Let \( f(x) = x^2 \). Find the derivative using the limit definition.</p>
          <p><strong>Solution:</strong></p>
          <p>\[ f'(x) = \lim_{h \to 0} \frac{(x+h)^2 - x^2}{h} \]</p>
          <p>\[ = \lim_{h \to 0} \frac{x^2 + 2xh + h^2 - x^2}{h} \]</p>
          <p>\[ = \lim_{h \to 0} \frac{2xh + h^2}{h} \]</p>
          <p>\[ = \lim_{h \to 0} (2x + h) = 2x \]</p>
          <p>So, \( f'(x) = 2x \).</p>
        </div>
        
        <div class="key-concept">
          <h3>Key Concept: Alternative Notation</h3>
          <p>The derivative can be represented in several ways:</p>
          <ul>
            <li>\( f'(x) \) - Lagrange notation</li>
            <li>\( \frac{dy}{dx} \) - Leibniz notation</li>
            <li>\( \frac{d}{dx}[f(x)] \) - Operator notation</li>
            <li>\( \dot{y} \) - Newton's notation (less common in calculus)</li>
          </ul>
        </div>

        <h2>Basic Rules of Differentiation</h2>
        
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Rule Name</th>
                <th>Function</th>
                <th>Derivative</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Constant Rule</td>
                <td>\( f(x) = c \)</td>
                <td>\( f'(x) = 0 \)</td>
              </tr>
              <tr>
                <td>Power Rule</td>
                <td>\( f(x) = x^n \)</td>
                <td>\( f'(x) = nx^{n-1} \)</td>
              </tr>
              <tr>
                <td>Constant Multiple Rule</td>
                <td>\( f(x) = c \cdot g(x) \)</td>
                <td>\( f'(x) = c \cdot g'(x) \)</td>
              </tr>
              <tr>
                <td>Sum/Difference Rule</td>
                <td>\( f(x) = g(x) \pm h(x) \)</td>
                <td>\( f'(x) = g'(x) \pm h'(x) \)</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h2>Worked Examples</h2>
        
        <div class="worked-example">
          <div class="example-header">
            <h3>Example 1: Quadratic Function</h3>
            <span class="example-type">Power Rule Application</span>
          </div>
          <p><strong>Problem:</strong> Find the derivative of \( f(x) = x^2 + 2x - 5 \) and evaluate it at \( x = 3 \).</p>
          
          <div class="step-by-step">
            <div class="step">
              <div class="step-number">1</div>
              <p><strong>Apply the power rule to each term:</strong></p>
              <p>\[ f(x) = x^2 + 2x - 5 \]</p>
              <p>\[ f'(x) = \frac{d}{dx}[x^2] + \frac{d}{dx}[2x] - \frac{d}{dx}[5] \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">2</div>
              <p><strong>Differentiate each term:</strong></p>
              <p>\[ \frac{d}{dx}[x^2] = 2x \]</p>
              <p>\[ \frac{d}{dx}[2x] = 2 \]</p>
              <p>\[ \frac{d}{dx}[5] = 0 \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">3</div>
              <p><strong>Combine the results:</strong></p>
              <p>\[ f'(x) = 2x + 2 \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">4</div>
              <p><strong>Evaluate at \( x = 3 \):</strong></p>
              <p>\[ f'(3) = 2(3) + 2 = 6 + 2 = 8 \]</p>
            </div>
          </div>
          
          <div class="tip">
            <p><strong>Interpretation:</strong> At \( x = 3 \), the function \( f(x) = x^2 + 2x - 5 \) has an instantaneous rate of change of 8. This means the slope of the tangent line at that point is 8.</p>
          </div>
        </div>
        
        <div class="worked-example">
          <div class="example-header">
            <h3>Example 2: Function with Radical (Surd Form)</h3>
            <span class="example-type">Power Rule with Fractional Exponents</span>
          </div>
          <p><strong>Problem:</strong> Find the derivative of \( g(x) = 3\sqrt{x} + \frac{2}{\sqrt{x}} \).</p>
          
          <div class="step-by-step">
            <div class="step">
              <div class="step-number">1</div>
              <p><strong>Rewrite using fractional exponents:</strong></p>
              <p>\[ g(x) = 3x^{1/2} + 2x^{-1/2} \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">2</div>
              <p><strong>Apply the power rule to each term:</strong></p>
              <p>\[ g'(x) = \frac{d}{dx}[3x^{1/2}] + \frac{d}{dx}[2x^{-1/2}] \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">3</div>
              <p><strong>Differentiate each term:</strong></p>
              <p>\[ \frac{d}{dx}[3x^{1/2}] = 3 \cdot \frac{1}{2}x^{-1/2} = \frac{3}{2}x^{-1/2} \]</p>
              <p>\[ \frac{d}{dx}[2x^{-1/2}] = 2 \cdot \left(-\frac{1}{2}\right)x^{-3/2} = -x^{-3/2} \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">4</div>
              <p><strong>Combine the results:</strong></p>
              <p>\[ g'(x) = \frac{3}{2}x^{-1/2} - x^{-3/2} \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">5</div>
              <p><strong>Rewrite in radical form:</strong></p>
              <p>\[ g'(x) = \frac{3}{2\sqrt{x}} - \frac{1}{x\sqrt{x}} \]</p>
              <p>\[ g'(x) = \frac{3}{2\sqrt{x}} - \frac{1}{x^{3/2}} \]</p>
            </div>
          </div>
          
          <div class="tip">
            <p><strong>Key Insight:</strong> When working with radicals, convert to fractional exponents before differentiating. Remember that \( \sqrt{x} = x^{1/2} \) and \( \frac{1}{\sqrt{x}} = x^{-1/2} \).</p>
          </div>
        </div>
        
        <div class="worked-example">
          <div class="example-header">
            <h3>Example 3: Third-Degree Polynomial</h3>
            <span class="example-type">Combining Multiple Rules</span>
          </div>
          <p><strong>Problem:</strong> Find the derivative of \( h(x) = 2x^3 - 5x^2 + 3x - 7 \).</p>
          
          <div class="step-by-step">
            <div class="step">
              <div class="step-number">1</div>
              <p><strong>Apply differentiation rules term by term:</strong></p>
              <p>\[ h(x) = 2x^3 - 5x^2 + 3x - 7 \]</p>
              <p>\[ h'(x) = \frac{d}{dx}[2x^3] - \frac{d}{dx}[5x^2] + \frac{d}{dx}[3x] - \frac{d}{dx}[7] \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">2</div>
              <p><strong>Apply the constant multiple and power rules:</strong></p>
              <p>\[ \frac{d}{dx}[2x^3] = 2 \cdot 3x^{2} = 6x^2 \]</p>
              <p>\[ \frac{d}{dx}[5x^2] = 5 \cdot 2x^{1} = 10x \]</p>
              <p>\[ \frac{d}{dx}[3x] = 3 \cdot 1x^{0} = 3 \]</p>
              <p>\[ \frac{d}{dx}[7] = 0 \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">3</div>
              <p><strong>Combine the results:</strong></p>
              <p>\[ h'(x) = 6x^2 - 10x + 3 \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">4</div>
              <p><strong>Interpret the derivative:</strong></p>
              <p>The derivative \( h'(x) = 6x^2 - 10x + 3 \) represents the instantaneous rate of change of the cubic function \( h(x) \). This quadratic function tells us how the slope of \( h(x) \) changes at each point.</p>
            </div>
          </div>
          
          <div class="tip">
            <p><strong>Pattern Recognition:</strong> For any polynomial, the derivative will be another polynomial of one degree lower. A cubic function (degree 3) has a quadratic derivative (degree 2).</p>
          </div>
        </div>

        <div class="interactive-widget">
          <h3>Interactive Derivative Calculator</h3>
          <p>Enter a function to see its derivative:</p>
          <div class="interactive-controls">
            <input type="text" id="function-input" placeholder="e.g., 3x^2 + 2x - 5" style="flex-grow: 1;">
            <button id="calculate-derivative">Calculate</button>
          </div>
          <div class="interactive-result" id="derivative-result">
            The derivative will appear here.
          </div>
        </div>

        <div class="tip">
          <p><strong>Tip:</strong> Always simplify before differentiating, and remember these basic rules—they form the foundation of all derivative calculations.</p>
        </div>
        
        <div class="ap-exam-tip">
          <h3>AP Exam Tip</h3>
          <p>On the AP Calculus exam, you may be asked to:</p>
          <ul>
            <li>Find derivatives using the limit definition (especially for simple functions)</li>
            <li>Apply basic differentiation rules to polynomial functions</li>
            <li>Interpret the meaning of a derivative in context</li>
            <li>Find the equation of a tangent line at a point</li>
          </ul>
          <p>Practice these skills thoroughly as they appear frequently on both the multiple-choice and free-response sections.</p>
        </div>

        <h2>Check Yourself</h2>
        <div class="check">
          <p>1. Find \( \frac{d}{dx}[3x^4 - 5x + 7] \)</p>
          <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
          <div class="solution">\[
            \frac{d}{dx}[3x^4 - 5x + 7] = 12x^3 - 5
          \]</div>
        </div>

        <div class="check">
          <p>2. Differentiate \( f(x) = 7 \)</p>
          <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
          <div class="solution">\[
            f'(x) = 0
          \]</div>
        </div>
        
        <div class="check">
          <p>3. Find the derivative of \( f(x) = 2x^3 - 4x^2 + x - 8 \)</p>
          <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
          <div class="solution">\[
            f'(x) = 6x^2 - 8x + 1
          \]</div>
        </div>
        
        <div class="check">
          <p>4. Use the limit definition to find the derivative of \( f(x) = 3x + 2 \)</p>
          <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
          <div class="solution">
            <p>\[ f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h} \]</p>
            <p>\[ = \lim_{h \to 0} \frac{[3(x+h) + 2] - [3x + 2]}{h} \]</p>
            <p>\[ = \lim_{h \to 0} \frac{3x + 3h + 2 - 3x - 2}{h} \]</p>
            <p>\[ = \lim_{h \to 0} \frac{3h}{h} = \lim_{h \to 0} 3 = 3 \]</p>
            <p>So, \( f'(x) = 3 \).</p>
          </div>
        </div>

        <div class="nav-buttons">
          <a href="Ch2_Sec1.0_apcalc_txb.html" class="nav-btn">Back ⬅</a>
          <a href="Ch2_Sec2.2_apcalc_txb.html" class="nav-btn">Next ➡</a>
        </div>
      </div>
    </div>
  </div>

  <div id="footer-placeholder"></div>

  <script>
    function toggleSolution(button) {
      const solution = button.nextElementSibling;
      if (solution.style.display === "none" || solution.style.display === "") {
        solution.style.display = "block";
        button.textContent = "Hide Solution";
      } else {
        solution.style.display = "none";
        button.textContent = "Show Solution";
      }
    }
    
    // Interactive derivative calculator
    document.getElementById('calculate-derivative').addEventListener('click', function() {
      const input = document.getElementById('function-input').value;
      const resultElement = document.getElementById('derivative-result');
      
      if (!input) {
        resultElement.innerHTML = 'Please enter a function.';
        return;
      }
      
      // Simple derivative calculation for polynomials
      try {
        // This is a simplified implementation - a real implementation would use a proper parser
        const derivative = calculateSimpleDerivative(input);
        resultElement.innerHTML = `The derivative of \( ${input} \) is \( ${derivative} \).`;
        
        // Re-render MathJax
        if (window.MathJax) {
          MathJax.typeset();
        }
      } catch (error) {
        resultElement.innerHTML = 'Error: Could not calculate derivative. Please check your input.';
      }
    });
    
    function calculateSimpleDerivative(expression) {
      // This is a very simplified implementation for demonstration
      // A real implementation would use a proper parser like math.js
      
      // Remove spaces
      expression = expression.replace(/\s/g, '');
      
      // Handle simple polynomial terms like ax^n
      const terms = expression.split(/(?=[+-])/);
      let derivativeTerms = [];
      
      for (let term of terms) {
        if (term === '') continue;
        
        // Handle constant term
        if (!term.includes('x')) {
          // Constant term - derivative is 0, so we skip it
          continue;
        }
        
        // Handle terms like ax, ax^n
        let coefficient = 1;
        let exponent = 1;
        
        // Extract coefficient
        const coefficientMatch = term.match(/^([+-]?\d*)/);
        if (coefficientMatch && coefficientMatch[1]) {
          if (coefficientMatch[1] === '+' || coefficientMatch[1] === '') {
            coefficient = 1;
          } else if (coefficientMatch[1] === '-') {
            coefficient = -1;
          } else {
            coefficient = parseFloat(coefficientMatch[1]);
          }
        }
        
        // Extract exponent
        const exponentMatch = term.match(/\^(\d+)/);
        if (exponentMatch) {
          exponent = parseInt(exponentMatch[1]);
        }
        
        // Calculate derivative
        const newCoefficient = coefficient * exponent;
        const newExponent = exponent - 1;
        
        // Format the term
        let derivativeTerm = '';
        if (newCoefficient !== 0) {
          if (newCoefficient > 0 && derivativeTerms.length > 0) {
            derivativeTerm += '+';
          }
          
          if (newCoefficient === 1 && newExponent !== 0) {
            // Omit coefficient if it's 1
          } else if (newCoefficient === -1 && newExponent !== 0) {
            derivativeTerm += '-';
          } else {
            derivativeTerm += newCoefficient;
          }
          
          if (newExponent === 1) {
            derivativeTerm += 'x';
          } else if (newExponent > 1) {
            derivativeTerm += `x^${newExponent}`;
          } else if (newExponent === 0) {
            // Just the constant
          }
        }
        
        if (derivativeTerm !== '') {
          derivativeTerms.push(derivativeTerm);
        }
      }
      
      if (derivativeTerms.length === 0) {
        return '0';
      }
      
      return derivativeTerms.join('');
    }
    
    // Progress tracking
    document.getElementById('mark-complete-btn').addEventListener('click', function() {
      const progressBar = document.getElementById('progress-bar');
      progressBar.style.width = '100%';
      this.textContent = 'Completed!';
      this.disabled = true;
      
      // In a real implementation, you would save this to localStorage or a database
      localStorage.setItem('section-2.1-completed', 'true');
    });
    
    // Load progress on page load
    document.addEventListener('DOMContentLoaded', function() {
      if (localStorage.getItem('section-2.1-completed')) {
        const progressBar = document.getElementById('progress-bar');
        progressBar.style.width = '100%';
        const button = document.getElementById('mark-complete-btn');
        button.textContent = 'Completed!';
        button.disabled = true;
      }
    });

    async function loadComponent(url, elementId, pageTitle = null) {
      try {
        const response = await fetch(url, { cache: "no-store" });
        if (!response.ok) throw new Error(`Failed to load ${url}: ${response.status}`);
        const html = await response.text();
        const container = document.getElementById(elementId);
        if (!container) return;
        container.innerHTML = html;
        if (pageTitle && elementId === 'header-placeholder') {
          const titleEl = container.querySelector('#section-title') || container.querySelector('h1');
          if (titleEl) titleEl.textContent = pageTitle;
          document.title = pageTitle;
        }
      } catch (err) {
        console.error(err);
        const el = document.getElementById(elementId);
        if (el) el.innerHTML = `<p style="color:red;">Error loading component: ${url}</p>`;
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await loadComponent('textbookheader.html', 'header-placeholder', 'Section 2.1 – Derivative Definition and Basic Rules');
      await loadComponent('textbooksidebar.html', 'sidebar-placeholder');
      await loadComponent('textbookfooter.html', 'footer-placeholder');

      const currentUrl = window.location.pathname.split('/').pop().split('?')[0];
      const links = document.querySelectorAll('#sidebar-placeholder a');
      links.forEach(link => {
        const linkUrl = link.getAttribute('href').split('?')[0];
        if (linkUrl === currentUrl) {
          link.classList.add('active');
          link.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      });
    });
  </script>

</body>
</html>
