<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Algebra 1 – Factoring Polynomials | Tklesson</title>

<link rel="canonical" href="https://tklesson.com/" />
<link rel="icon" type="image/png" sizes="16x16" href="/Tklesson1-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/Tklesson1-32x32.png">
<link rel="apple-touch-icon" href="/Tklesson1-192x192.png">
<meta name="theme-color" content="#0f4c81">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Slab:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --primary: #0f4c81;
  --primary-light: #1a5d9f;
  --primary-dark: #0a3a66;
  --secondary: #9b59b6;
  --secondary-light: #af7ac5;
  --secondary-dark: #8e44ad;
  --accent: #2ecc71;
  --light: #f8fafc;
  --dark: #1e293b;
  --gray: #94a3b8;
  --success: #27ae60;
  --error: #e74c3c;
  --warning: #f39c12;
  --text: #2d3748;
  --text-light: #718096;
  --border: #e2e8f0;
  --card-bg: #ffffff;
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Poppins', sans-serif;
  line-height: 1.6;
  color: var(--text);
  background: linear-gradient(135deg, #f8f9fa 0%, #f5f0ff 100%);
  min-height: 100vh;
}

.container {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1.5rem;
}

/* Header */
.quiz-header {
  background: var(--gradient);
  color: white;
  padding: 1.5rem 2rem;
  text-align: center;
  position: relative;
  overflow: hidden;
  box-shadow: var(--shadow);
}

.header-content {
  position: relative;
  z-index: 1;
}

.header-logo {
  height: 60px;
  margin-bottom: 0.5rem;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
}

.header-title {
  font-family: 'Roboto Slab', serif;
  font-size: 2.2rem;
  margin-bottom: 0.5rem;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.header-subtitle {
  font-size: 1.1rem;
  opacity: 0.9;
  color: #e2e8f0;
  font-weight: 400;
}

/* Quiz Container */
.quiz-container {
  background: white;
  border-radius: 1rem;
  margin: 2rem auto;
  padding: 2rem;
  box-shadow: var(--shadow-lg);
  position: relative;
  overflow: hidden;
}

.quiz-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 5px;
  background: var(--gradient);
}

.questions-container {
  margin-bottom: 2rem;
}

.question-card {
  background: #f8fafc;
  border-radius: 0.75rem;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  border-left: 4px solid var(--secondary);
  transition: all 0.3s ease;
  position: relative;
}

.question-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow);
}

.question-number {
  position: absolute;
  top: -12px;
  left: 15px;
  background: var(--secondary);
  color: white;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 0.9rem;
  box-shadow: var(--shadow);
}

.question-text {
  font-weight: 600;
  margin-bottom: 1.5rem;
  color: var(--dark);
  font-size: 1.1rem;
  padding-top: 0.5rem;
}

/* MathJax specific styling */
.question-text .MathJax {
  font-size: 1.2rem !important;
}

.mjx-chtml {
  font-size: 1.2rem !important;
}

.options-container {
  display: grid;
  gap: 0.75rem;
}

.option {
  background: white;
  border: 2px solid var(--border);
  border-radius: 0.5rem;
  padding: 0.75rem 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 1rem;
  display: flex;
  align-items: flex-start;
}

.option-label {
  font-weight: 600;
  margin-right: 10px;
  min-width: 25px;
  color: var(--primary);
}

.option-content {
  flex: 1;
  font-family: 'Courier New', monospace;
  font-size: 1.1rem;
}

.option:hover {
  border-color: var(--primary);
  background: rgba(15, 76, 129, 0.03);
}

.option.selected {
  border-color: var(--primary);
  background: rgba(15, 76, 129, 0.08);
}

.option.correct {
  border-color: var(--success);
  background: rgba(39, 174, 96, 0.1);
}

.option.incorrect {
  border-color: var(--error);
  background: rgba(231, 76, 60, 0.1);
}

/* Buttons */
.buttons-container {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  margin-bottom: 1.5rem;
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  border: none;
  outline: none;
  font-size: 1rem;
  font-family: 'Poppins', sans-serif;
}

.btn-primary {
  background: var(--primary);
  color: white;
}

.btn-primary:hover {
  background: var(--primary-light);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-secondary {
  background: var(--secondary);
  color: white;
}

.btn-secondary:hover {
  background: var(--secondary-light);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-success {
  background: var(--success);
  color: white;
}

.btn-success:hover {
  background: #219653;
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

/* Results */
.results-container {
  margin-top: 2rem;
  padding: 1.5rem;
  border-radius: 0.75rem;
  background: #f1f5f9;
  display: none;
  border-left: 4px solid var(--primary);
}

.score-display {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 1rem;
  text-align: center;
  color: var(--dark);
}

/* Message */
.message {
  padding: 1rem;
  border-radius: 0.5rem;
  margin-top: 1rem;
  font-weight: 500;
  text-align: center;
  display: none;
}

.message-error {
  background: #fee2e2;
  color: var(--error);
  border: 1px solid #fecaca;
}

.message-success {
  background: #d1fae5;
  color: var(--success);
  border: 1px solid #a7f3d0;
}

/* Animation */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fadeIn {
  animation: fadeIn 0.5s ease forwards;
}

/* Progress Bar */
.progress-container {
  margin: 1.5rem 0;
}

.progress-bar {
  height: 8px;
  background: #e2e8f0;
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--primary);
  width: 0%;
  transition: width 0.5s ease;
}

.progress-text {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
  font-size: 0.9rem;
  color: var(--text-light);
}

/* Responsive */
@media (max-width: 768px) {
  .quiz-header {
    padding: 1rem;
  }
  
  .header-title {
    font-size: 1.8rem;
  }
  
  .header-subtitle {
    font-size: 1rem;
  }
  
  .quiz-container {
    padding: 1.5rem;
    margin: 1rem;
  }
  
  .buttons-container {
    flex-direction: column;
  }
  
  .btn {
    width: 100%;
  }
  
  .option-content {
    font-size: 1rem;
  }
}

/* MathJax styling */
.MathJax {
  font-size: 1.2rem !important;
}

.mjx-chtml {
  outline: none;
}

.mjx-math {
  font-size: 1.2rem !important;
}
</style>
<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>

<header class="quiz-header">
    <div class="header-content">
        <img src="Tklesson1.png" alt="Tklesson Logo" class="header-logo">
        <h1 class="header-title">Algebra 1 – Factoring Polynomials</h1>
        <p class="header-subtitle">Master GCF, Trinomials, DOTS, and Grouping Techniques</p>
    </div>
</header>

<div class="container">
    <div class="quiz-container">
        <div id="startScreen" style="text-align: center; padding: 2rem;">
            <h2 style="color: var(--primary); margin-bottom: 1rem;">Algebra 1 Factoring Challenge</h2>
            <p style="font-size: 1.1rem; margin-bottom: 1.5rem; line-height: 1.6;">
                This 10-question quiz tests your ability to factor various polynomial expressions using multiple techniques.
            </p>
            <div style="background: #f5f0ff; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 2rem;">
                <h3 style="color: var(--secondary-dark); margin-bottom: 0.75rem;">Factoring Methods Covered:</h3>
                <ul style="text-align: left; display: inline-block; margin: 0 auto; list-style: none; padding: 0;">
                    <li>✓ Greatest Common Factor (GCF)</li>
                    <li>✓ Basic Trinomials ($a = 1$)</li>
                    <li>✓ Difference of Two Squares (DOTS)</li>
                    <li>✓ Perfect Square Trinomials</li>
                    <li>✓ Factoring by Grouping</li>
                    <li>✓ AC Method ($a > 1$)</li>
                </ul>
            </div>
            <div style="margin-bottom: 1.5rem;">
                <span style="background: var(--secondary); color: white; padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.8rem; font-weight: 600;">Algebra 1 Level</span>
                <span style="font-size: 0.9rem; color: var(--text-light); margin-left: 0.5rem;">Essential factoring skills for Algebra 1</span>
            </div>
            <button id="startBtn" class="btn btn-primary" style="font-size: 1.2rem; padding: 1rem 2rem;">Begin Factoring Quiz</button>
        </div>

        <div id="quizContent" style="display: none;">
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
                <div class="progress-text">
                    <span>Question: <span id="currentQuestion">1</span>/10</span>
                    <span>Time: <span id="quizTimer">20:00</span></span>
                </div>
            </div>
            
            <div id="questions-container" class="questions-container"></div>

            <div class="buttons-container">
                <button id="prevBtn" class="btn btn-secondary">Previous</button>
                <button id="nextBtn" class="btn btn-primary">Next Question</button>
                <button id="submitBtn" class="btn btn-success" style="display: none;">Submit Quiz</button>
                <button id="restartBtn" class="btn btn-secondary">Restart Quiz</button>
            </div>

            <div id="results-container" class="results-container"></div>
            <div id="message" class="message"></div>
        </div>
    </div>
</div>

<script>
// ============================================================
// Algebra 1: Factoring Polynomials Quiz (10 Questions)
// ============================================================

const questions = [
  {
    q: `Factor completely: $12x^4 - 18x^2$`,
    options: [
      "$6x^2(2x^2 - 3)$",
      "$6x(2x^3 - 3x)$",
      "$3x^2(4x^2 - 6)$",
      "$2x^2(6x^2 - 9)$"
    ],
    answer: 0,
    explanation: "Step 1: Find GCF of coefficients: 12 and 18 → GCF = 6\nStep 2: Find GCF of variables: $x^4$ and $x^2$ → GCF = $x^2$\nStep 3: Factor out $6x^2$: $6x^2(2x^2 - 3)$\nCheck: $6x^2 \\times 2x^2 = 12x^4$, $6x^2 \\times (-3) = -18x^2$"
  },
  {
    q: `Factor: $x^2 - 9x + 20$`,
    options: [
      "$(x - 4)(x - 5)$",
      "$(x - 2)(x - 10)$",
      "$(x + 4)(x + 5)$",
      "$(x - 4)(x + 5)$"
    ],
    answer: 0,
    explanation: "Looking for two numbers that:\nMultiply to +20 (last term)\nAdd to -9 (middle coefficient)\nFactors of 20: (1,20), (2,10), (4,5)\nSince sum is negative (-9) but product positive (+20), both numbers are negative\n-4 and -5: $-4 \\times -5 = 20$, $-4 + (-5) = -9$\nThus: $(x - 4)(x - 5)$"
  },
  {
    q: `Factor completely: $25x^2 - 64$`,
    options: [
      "$(5x - 8)(5x + 8)$",
      "$(5x - 8)^2$",
      "$(5x + 8)^2$",
      "$(25x - 64)(x + 1)$"
    ],
    answer: 0,
    explanation: "Difference of Two Squares pattern: $a^2 - b^2 = (a - b)(a + b)$\nIdentify perfect squares:\n$25x^2 = (5x)^2$\n$64 = 8^2$\nApply formula: $(5x)^2 - 8^2 = (5x - 8)(5x + 8)$\nAlways check with FOIL: $(5x)(5x) = 25x^2$, $(5x)(8) = 40x$, $(-8)(5x) = -40x$, $(-8)(8) = -64$\nMiddle terms cancel: $40x - 40x = 0$"
  },
  {
    q: `Factor: $x^2 + 2x - 24$`,
    options: [
      "$(x + 6)(x - 4)$",
      "$(x - 6)(x + 4)$",
      "$(x + 8)(x - 3)$",
      "$(x - 8)(x + 3)$"
    ],
    answer: 0,
    explanation: "Since constant term is negative (-24), numbers have opposite signs\nLooking for numbers that:\nMultiply to -24\nAdd to +2\nList factor pairs of 24: (1,24), (2,12), (3,8), (4,6)\nSince sum is positive (+2), larger number is positive\n6 and -4: $6 \\times -4 = -24$, $6 + (-4) = 2$\nThus: $(x + 6)(x - 4)$"
  },
  {
    q: `Factor: $x^2 + 10x + 25$`,
    options: [
      "$(x + 5)^2$",
      "$(x - 5)^2$",
      "$(x + 25)(x + 1)$",
      "$(x + 5)(x - 5)$"
    ],
    answer: 0,
    explanation: "Perfect Square Trinomial pattern: $a^2 + 2ab + b^2 = (a + b)^2$\nIdentify: $x^2 = (x)^2$, $25 = 5^2$\nCheck middle term: $2 \\times x \\times 5 = 10x$ ✓\nThus: $(x + 5)^2$\nDouble check: $(x + 5)(x + 5) = x^2 + 5x + 5x + 25 = x^2 + 10x + 25$"
  },
  {
    q: `Factor completely: $3x^2 - 12x - 36$`,
    options: [
      "$3(x - 6)(x + 2)$",
      "$3(x + 6)(x - 2)$",
      "$(3x - 6)(x + 6)$",
      "$(x - 6)(3x + 6)$"
    ],
    answer: 0,
    explanation: "Step 1: Factor out GCF of 3: $3(x^2 - 4x - 12)$\nStep 2: Factor the trinomial inside: $x^2 - 4x - 12$\nFind numbers that multiply to -12 and add to -4\nFactors of 12: (1,12), (2,6), (3,4)\nSince sum is negative (-4) and product negative (-12), numbers have opposite signs with negative larger\n-6 and 2: $-6 \\times 2 = -12$, $-6 + 2 = -4$\nThus: $3(x - 6)(x + 2)$"
  },
  {
    q: `Factor completely: $x^3 + 5x^2 - 4x - 20$`,
    options: [
      "$(x - 2)(x + 2)(x + 5)$",
      "$(x^2 - 4)(x + 5)$",
      "$(x + 2)^2(x - 5)$",
      "$(x - 2)^2(x + 5)$"
    ],
    answer: 0,
    explanation: "Factor by grouping:\nStep 1: Group terms: $(x^3 + 5x^2) + (-4x - 20)$\nStep 2: Factor each group: $x^2(x + 5) - 4(x + 5)$\nStep 3: Factor out $(x + 5)$: $(x^2 - 4)(x + 5)$\nStep 4: Recognize $x^2 - 4$ is difference of squares: $(x - 2)(x + 2)$\nFinal: $(x - 2)(x + 2)(x + 5)$"
  },
  {
    q: `Factor: $2x^2 + 7x + 3$`,
    options: [
      "$(2x + 1)(x + 3)$",
      "$(2x + 3)(x + 1)$",
      "$(x + 1)(2x + 3)$",
      "$(x + 3)(2x + 1)$"
    ],
    answer: 0,
    explanation: "AC Method for $a > 1$:\nStep 1: $a \\times c = 2 \\times 3 = 6$\nStep 2: Find factors of 6 that add to 7: 6 and 1\nStep 3: Rewrite middle term: $2x^2 + 6x + 1x + 3$\nStep 4: Factor by grouping: $2x(x + 3) + 1(x + 3)$\nStep 5: Factor out $(x + 3)$: $(2x + 1)(x + 3)$\nCheck: $(2x)(x) = 2x^2$, $(2x)(3) = 6x$, $(1)(x) = x$, $(1)(3) = 3$"
  },
  {
    q: `Factor: $100a^2 - 49b^2$`,
    options: [
      "$(10a - 7b)(10a + 7b)$",
      "$(10a - 7b)^2$",
      "$(100a - 49b)(a + b)$",
      "$(5a - 7b)(20a + 7b)$"
    ],
    answer: 0,
    explanation: "Difference of Two Squares with variables:\n$100a^2 = (10a)^2$\n$49b^2 = (7b)^2$\nApply formula: $a^2 - b^2 = (a - b)(a + b)$\nThus: $(10a)^2 - (7b)^2 = (10a - 7b)(10a + 7b)$\nCheck: $(10a)(10a) = 100a^2$, $(10a)(7b) = 70ab$, $(-7b)(10a) = -70ab$, $(-7b)(7b) = -49b^2$\nMiddle terms cancel: $70ab - 70ab = 0$"
  },
  {
    q: `Factor completely: $x^2 + 4$`,
    options: [
      "Cannot be factored",
      "$(x + 2)^2$",
      "$(x - 2)^2$",
      "$(x + 2)(x - 2)$"
    ],
    answer: 0,
    explanation: "CRITICAL DISTINCTION:\n$x^2 - 4$ factors as $(x + 2)(x - 2)$ (Difference of Squares)\nBUT $x^2 + 4$ is a SUM of squares, which does NOT factor using real numbers\nCommon mistake: Students try to factor as $(x + 2)^2$ or $(x - 2)^2$, but these give $x^2 ± 4x + 4$, not $x^2 + 4$\nThus: $x^2 + 4$ is prime over the real numbers\nNote: Over complex numbers it factors as $(x + 2i)(x - 2i)$"
  }
];

// Helper function to properly render math content
function renderMathContent(content) {
    // Convert LaTeX delimiters to MathJax format and escape HTML
    return content
        .replace(/\\\[/g, '[')  // Keep \[ for display math
        .replace(/\\\]/g, ']')  // Keep \] for display math
        .replace(/\\\(/g, '(')  // Keep \( for inline math
        .replace(/\\\)/g, ')')  // Keep \) for inline math
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;')
        .replace(/\n/g, '<br>');  // Convert newlines to line breaks
}

// DOM elements
const questionsContainer = document.getElementById('questions-container');
const submitBtn = document.getElementById('submitBtn');
const restartBtn = document.getElementById('restartBtn');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const resultsContainer = document.getElementById('results-container');
const messageEl = document.getElementById('message');
const startBtn = document.getElementById('startBtn');
const startScreen = document.getElementById('startScreen');
const quizContent = document.getElementById('quizContent');
const progressFill = document.getElementById('progressFill');
const currentQuestionEl = document.getElementById('currentQuestion');
const quizTimer = document.getElementById('quizTimer');

// Quiz state
let currentQuestionIndex = 0;
let userAnswers = new Array(questions.length).fill(-1);
let quizSubmitted = false;
let timeLeft = 1200; // 20 minutes in seconds
let timerInterval;

// Shuffle questions and options
function shuffleQuestions() {
    const shuffledQuestions = questions.map(q => {
        const indices = [0, 1, 2, 3];
        // Fisher-Yates shuffle
        for (let i = indices.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [indices[i], indices[j]] = [indices[j], indices[i]];
        }
        
        return {
            ...q,
            shuffledOptions: indices.map(i => q.options[i]),
            correctAnswerIndex: indices.indexOf(q.answer)
        };
    });
    
    // Shuffle the questions themselves
    for (let i = shuffledQuestions.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffledQuestions[i], shuffledQuestions[j]] = [shuffledQuestions[j], shuffledQuestions[i]];
    }
    
    return shuffledQuestions;
}

let currentQuestions = [];

// Initialize quiz
function initQuiz() {
    currentQuestions = shuffleQuestions();
    currentQuestionIndex = 0;
    quizSubmitted = false;
    userAnswers = new Array(currentQuestions.length).fill(-1);
    timeLeft = 1200;
    
    resultsContainer.style.display = 'none';
    messageEl.style.display = 'none';
    submitBtn.style.display = 'none';
    prevBtn.style.display = 'inline-block';
    nextBtn.style.display = 'inline-block';
    
    updateProgressBar();
    startTimer();
    renderQuestion();
}

// Start timer
function startTimer() {
    clearInterval(timerInterval);
    updateTimerDisplay();
    
    timerInterval = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            if (!quizSubmitted) {
                showMessage("Time's up! Submitting your quiz...", 'error');
                setTimeout(checkAnswers, 1000);
            }
        }
    }, 1000);
}

// Update timer display
function updateTimerDisplay() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    quizTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    
    // Color code for last 5 minutes
    if (timeLeft <= 300) {
        quizTimer.style.color = 'var(--error)';
        quizTimer.style.fontWeight = '600';
    }
}

// Update progress bar
function updateProgressBar() {
    const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
    progressFill.style.width = `${progress}%`;
    currentQuestionEl.textContent = currentQuestionIndex + 1;
}

// Render current question
function renderQuestion() {
    if (!currentQuestions.length) return;
    
    const question = currentQuestions[currentQuestionIndex];
    
    let optionsHTML = '';
    question.shuffledOptions.forEach((option, optionIndex) => {
        const isSelected = userAnswers[currentQuestionIndex] === optionIndex;
        const optionId = `q${currentQuestionIndex}_${optionIndex}`;
        const labels = ['A', 'B', 'C', 'D'];
        
        optionsHTML += `
            <div class="option ${isSelected ? 'selected' : ''}" data-index="${currentQuestionIndex}" data-option="${optionIndex}">
                <div class="option-label">${labels[optionIndex]}.</div>
                <div class="option-content">${option}</div>
                <input type="radio" id="${optionId}" name="q${currentQuestionIndex}" ${isSelected ? 'checked' : ''}>
            </div>
        `;
    });
    
    questionsContainer.innerHTML = `
        <div class="question-card animate-fadeIn">
            <div class="question-number">${currentQuestionIndex + 1}</div>
            <div class="question-text">${question.q}</div>
            <div class="options-container">${optionsHTML}</div>
        </div>
    `;
    
    // Update button states
    prevBtn.disabled = currentQuestionIndex === 0;
    nextBtn.textContent = currentQuestionIndex === currentQuestions.length - 1 ? 'Final Review' : 'Next Question';
    submitBtn.style.display = currentQuestionIndex === currentQuestions.length - 1 ? 'inline-block' : 'none';
    
    // Add event listeners to options
    document.querySelectorAll('.option').forEach(option => {
        option.addEventListener('click', function() {
            if (quizSubmitted) return;
            
            const questionIndex = parseInt(this.dataset.index);
            const optionIndex = parseInt(this.dataset.option);
            
            const questionOptions = document.querySelectorAll(`.option[data-index="${questionIndex}"]`);
            questionOptions.forEach(opt => opt.classList.remove('selected'));
            
            this.classList.add('selected');
            
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            
            userAnswers[questionIndex] = optionIndex;
            
            // Auto-advance on mobile for better UX
            if (window.innerWidth < 768 && currentQuestionIndex < currentQuestions.length - 1) {
                setTimeout(() => nextQuestion(), 300);
            }
        });
    });
    
    updateProgressBar();
    
    // Re-render MathJax
    if (window.MathJax && MathJax.typesetPromise) {
        MathJax.typesetPromise();
    }
}

// Next question
function nextQuestion() {
    if (currentQuestionIndex < currentQuestions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
    } else {
        // At last question
        window.scrollTo({ top: 0, behavior: 'smooth' });
        showMessage("Final question. Review carefully before submitting.", 'success');
    }
}

// Previous question
function prevQuestion() {
    if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        renderQuestion();
    }
}

// Check answers
function checkAnswers() {
    const unanswered = userAnswers.filter(answer => answer === -1).length;
    
    if (unanswered > 0) {
        if (!confirm(`You have ${unanswered} unanswered questions. Submit anyway?`)) {
            return;
        }
    }
    
    clearInterval(timerInterval);
    
    let score = 0;
    let resultsHTML = '';
    
    currentQuestions.forEach((question, index) => {
        const userAnswerIndex = userAnswers[index];
        const isCorrect = userAnswerIndex === question.correctAnswerIndex;
        
        if (isCorrect) {
            score++;
        }
        
        const labels = ['A', 'B', 'C', 'D'];
        const userAnswer = userAnswerIndex === -1 ? 'Not answered' : 
            `${labels[userAnswerIndex]}: ${question.shuffledOptions[userAnswerIndex]}`;
        const correctAnswer = `${labels[question.correctAnswerIndex]}: ${question.shuffledOptions[question.correctAnswerIndex]}`;
        
        resultsHTML += `
            <div style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);">
                <div><strong>Question ${index + 1}:</strong> ${renderMathContent(question.q)}</div>
                <div style="margin-top: 0.5rem;"><strong style="color: ${userAnswerIndex === question.correctAnswerIndex ? 'var(--success)' : 'var(--error)'}">Your answer:</strong> ${renderMathContent(userAnswer)}</div>
                <div><strong>Correct answer:</strong> ${renderMathContent(correctAnswer)}</div>
                <div style="margin-top: 0.5rem; background: #f0f8ff; padding: 0.75rem; border-radius: 0.5rem; font-size: 0.9rem;">
                    <strong>Solution:</strong><br>${renderMathContent(question.explanation)}
                </div>
            </div>
        `;
    });
    
    const percentage = (score / currentQuestions.length) * 100;
    let grade = '';
    let feedback = '';
    
    if (percentage >= 90) {
        grade = 'A (Excellent)';
        feedback = 'Outstanding! You have mastered all factoring techniques for Algebra 1.';
    } else if (percentage >= 80) {
        grade = 'B (Good)';
        feedback = 'Very good! You understand most factoring methods but should practice a few specific areas.';
    } else if (percentage >= 70) {
        grade = 'C (Satisfactory)';
        feedback = 'Good effort! Focus on distinguishing between different factoring patterns and checking your work.';
    } else if (percentage >= 60) {
        grade = 'D (Needs Improvement)';
        feedback = 'Needs work. Practice basic factoring (GCF, trinomials) before tackling more complex problems.';
    } else {
        grade = 'F (Unsatisfactory)';
        feedback = 'Substantial review needed. Start with GCF and simple trinomial factoring.';
    }
    
    resultsContainer.style.display = 'block';
    resultsContainer.innerHTML = `
        <div class="score-display">Score: ${score} / ${currentQuestions.length} (${percentage.toFixed(1)}%)</div>
        <div style="text-align: center; margin-bottom: 1.5rem; padding: 1rem; background: white; border-radius: 0.5rem; box-shadow: var(--shadow);">
            <div style="font-size: 1.2rem; color: var(--primary); margin-bottom: 0.5rem;">Grade: ${grade}</div>
            <div>${feedback}</div>
        </div>
        <h3 style="margin-bottom: 1rem; color: var(--primary);">Detailed Solutions:</h3>
        ${resultsHTML}
        <div style="text-align: center; margin-top: 1.5rem; font-size: 0.9rem; color: var(--text-light);">
            <strong>Factoring Strategy:</strong> Always look for GCF first. Then check for special patterns (DOTS, perfect squares). For trinomials, remember the AC method when $a > 1$.
        </div>
    `;
    
    // Scroll to results
    setTimeout(() => {
        resultsContainer.scrollIntoView({ behavior: 'smooth' });
        
        // Re-render MathJax for the results
        if (window.MathJax && MathJax.typesetPromise) {
            MathJax.typesetPromise([resultsContainer]).catch(err => {
                console.log('MathJax typeset error:', err);
                if (MathJax.typeset) {
                    MathJax.typeset();
                }
            });
        }
    }, 500);
    
    quizSubmitted = true;
    submitBtn.style.display = 'none';
    prevBtn.style.display = 'none';
    nextBtn.style.display = 'none';
    
    showMessage(`Quiz submitted! Score: ${score}/${currentQuestions.length}`, 'success');
}

// Show message
function showMessage(text, type) {
    messageEl.textContent = text;
    messageEl.className = `message message-${type}`;
    messageEl.style.display = 'block';
    
    if (type !== 'error') {
        setTimeout(() => {
            messageEl.style.display = 'none';
        }, 4000);
    }
}

// Event listeners
startBtn.addEventListener('click', () => {
    startScreen.style.display = 'none';
    quizContent.style.display = 'block';
    initQuiz();
});

prevBtn.addEventListener('click', prevQuestion);
nextBtn.addEventListener('click', nextQuestion);
submitBtn.addEventListener('click', checkAnswers);

restartBtn.addEventListener('click', () => {
    if (confirm('Are you sure you want to restart? All progress will be lost.')) {
        initQuiz();
        showMessage('Quiz restarted. Remember to factor completely!', 'success');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
});

// Keyboard navigation
document.addEventListener('keydown', (e) => {
    if (!quizSubmitted) {
        if (e.key === 'ArrowLeft') {
            if (currentQuestionIndex > 0) prevQuestion();
        } else if (e.key === 'ArrowRight') {
            if (currentQuestionIndex < currentQuestions.length - 1) nextQuestion();
        } else if (e.key >= 'a' && e.key <= 'd') {
            const optionIndex = e.key.charCodeAt(0) - 97;
            if (optionIndex >= 0 && optionIndex <= 3) {
                userAnswers[currentQuestionIndex] = optionIndex;
                renderQuestion();
            }
        } else if (e.key === 'Enter' && currentQuestionIndex === currentQuestions.length - 1) {
            checkAnswers();
        }
    }
});

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    quizContent.style.display = 'none';
    startScreen.style.display = 'block';
});
</script>

</body>
</html>
