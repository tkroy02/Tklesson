<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Section 2.4 – The Product Rule</title>

  <script src="https://tklesson.com/resources-loader.js"></script>
  <script>loadCommonResources();</script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    * { box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      line-height: 1.6;
      background: #ffffff;
      color: #00274d;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    #header-placeholder, #footer-placeholder { width: 100%; }

    .page-container { display: flex; flex-grow: 1; }

    .sidebar {
      width: 250px;
      background: #00274d;
      color: white;
      padding: 20px;
      flex-shrink: 0;
      overflow-y: auto;
      max-height: 100vh;
    }

    .sidebar h3 { color: white; margin-top: 0; }
    .sidebar ul { list-style-type: none; padding: 0; }
    .sidebar ul li a {
      display: block;
      padding: 10px;
      color: #c0c0c0;
      text-decoration: none;
      border-bottom: 1px solid #0056b3;
    }
    .sidebar ul li a:hover { background: #0056b3; color: white; }
    .sidebar ul li a.active { background: #0056b3; color: white; font-weight: bold; }

    header {
      background: #00274d;
      color: white;
      padding: 20px;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header img { height: 50px; flex-shrink: 0; }
    header h1 {
      margin: 0;
      font-size: 1.8em;
      color: white;
      text-align: center;
      flex-grow: 1;
      flex-shrink: 1;
      min-width: 0;
      padding: 0 10px;
    }
    header a.home-link {
      color: white;
      text-decoration: none;
      font-size: 1em;
      background: #0056b3;
      padding: 6px 12px;
      border-radius: 6px;
      flex-shrink: 0;
    }
    header a.home-link:hover { background: #0073e6; }

    .footer {
      background: #00274d;
      color: white;
      text-align: center;
      padding: 20px;
      width: 100%;
      flex-shrink: 0;
    }

    .main-content { flex-grow: 1; }
    .container { padding: 20px; max-width: 900px; margin: auto; }

    h2 { color: #0056b3; border-bottom: 2px solid #0056b3; padding-bottom: 5px; }
    h3 { color: #0056b3; }

    .nav-buttons { display: flex; justify-content: space-between; margin: 30px auto; }
    .nav-btn {
      background: #0056b3;
      color: white;
      padding: 12px 25px;
      border-radius: 8px;
      text-decoration: none;
      font-size: 1.1em;
    }
    .nav-btn:hover { background: #0073e6; }

    .example, .tip, .check, .definition, .key-concept, .ap-exam-tip, .worked-example, .real-world-app, .practice-problem, .rule-box {
      background: #f0f8ff;
      border-left: 5px solid #0056b3;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
    }
    
    .rule-box { border-left-color: #28a745; background: #e8f5e8; }
    .worked-example { border-left-color: #28a745; }
    .practice-problem { border-left-color: #ff6b35; }
    .real-world-app { border-left-color: #ff6b35; }
    .definition { border-left-color: #28a745; }
    .key-concept { border-left-color: #ffc107; }
    .ap-exam-tip { border-left-color: #dc3545; }
    
    .check p { font-size: 1.2em; }

    .solution {
      display: none;
      background: #e6f2ff;
      border: 1px solid #0056b3;
      padding: 15px;
      margin-top: 10px;
      border-radius: 6px;
    }

    .show-solution-btn {
      background: #0056b3;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }
    .show-solution-btn:hover { background: #0073e6; }
    
    .interactive-widget {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
    }
    
    .interactive-controls {
      display: flex;
      gap: 10px;
      margin: 10px 0;
      flex-wrap: wrap;
    }
    
    .interactive-controls input, .interactive-controls button, .interactive-controls select {
      padding: 8px 12px;
      border: 1px solid #ced4da;
      border-radius: 4px;
    }
    
    .interactive-controls button {
      background: #0056b3;
      color: white;
      cursor: pointer;
      border: none;
    }
    
    .interactive-controls button:hover {
      background: #0073e6;
    }
    
    .interactive-result {
      margin-top: 15px;
      padding: 15px;
      background: #e9ecef;
      border-radius: 4px;
    }
    
    .learning-objectives {
      background: #e7f3ff;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    
    .learning-objectives h3 {
      margin-top: 0;
    }
    
    .learning-objectives ul {
      padding-left: 20px;
    }
    
    .learning-objectives li {
      margin-bottom: 8px;
    }
    
    .table-container {
      overflow-x: auto;
      margin: 20px 0;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th, td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    
    th {
      background-color: #0056b3;
      color: white;
    }
    
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    
    .progress-container {
      margin: 20px 0;
      background: #f1f1f1;
      border-radius: 8px;
      height: 10px;
    }
    
    .progress-bar {
      height: 100%;
      background: #0056b3;
      border-radius: 8px;
      width: 0%;
      transition: width 0.5s ease-in-out;
    }
    
    .section-completion {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .section-completion button {
      background: #0056b3;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
    }
    
    .section-completion button:hover {
      background: #0073e6;
    }
    
    .step-by-step {
      margin: 15px 0;
      padding-left: 20px;
    }
    
    .step {
      margin-bottom: 10px;
      position: relative;
    }
    
    .step-number {
      position: absolute;
      left: -20px;
      background: #0056b3;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8em;
    }
    
    .example-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .example-type {
      background: #0056b3;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.8em;
    }
    
    .problem-set {
      display: grid;
      gap: 20px;
      margin: 25px 0;
    }
    
    .problem-card {
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .problem-card h4 {
      margin-top: 0;
      color: #0056b3;
      border-bottom: 1px solid #e9ecef;
      padding-bottom: 10px;
    }
    
    .difficulty-easy { border-left: 4px solid #28a745; }
    .difficulty-medium { border-left: 4px solid #ffc107; }
    .difficulty-hard { border-left: 4px solid #dc3545; }
    
    .quiz-container {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      margin: 25px 0;
    }
    
    .quiz-question {
      margin-bottom: 20px;
    }
    
    .quiz-options {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 15px 0;
    }
    
    .quiz-option {
      padding: 10px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .quiz-option:hover {
      background: #e9ecef;
    }
    
    .quiz-option.correct {
      background: #d4edda;
      border-color: #c3e6cb;
    }
    
    .quiz-option.incorrect {
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .quiz-feedback {
      margin-top: 10px;
      padding: 10px;
      border-radius: 4px;
      display: none;
    }
    
    .quiz-feedback.correct {
      background: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
    }
    
    .quiz-feedback.incorrect {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }
    
    .product-rule-formula {
      text-align: center;
      font-size: 1.4em;
      margin: 20px 0;
      padding: 20px;
      background: linear-gradient(135deg, #e3f2fd, #bbdefb);
      border-radius: 8px;
      border: 2px solid #0056b3;
    }
    
    .notation-guide {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
    }

    @media (max-width: 768px) {
      .page-container { flex-direction: column; }
      .sidebar { width: 100%; max-height: none; order: -1; }
      .interactive-controls { flex-direction: column; }
      .problem-set { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <script type="module" src="firebase-auth.js"></script>

  <div id="header-placeholder"></div>

  <div class="page-container">
    <div id="sidebar-placeholder"></div>

    <div class="main-content">
      <div class="container">
        <h2>2.4 – The Product Rule</h2>
        
        <div class="learning-objectives">
          <h3>Learning Objectives</h3>
          <p>By the end of this section, you should be able to:</p>
          <ul>
            <li>State and apply the Product Rule using the notation: \( \frac{dy}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} \)</li>
            <li>Differentiate products of functions using the u-v notation</li>
            <li>Recognize when to use the Product Rule vs. other rules</li>
            <li>Simplify derivatives obtained using the Product Rule</li>
            <li>Apply the Product Rule to solve real-world problems</li>
          </ul>
        </div>
        
        <div class="section-completion">
          <span>Section Progress</span>
          <button id="mark-complete-btn">Mark as Complete</button>
        </div>
        <div class="progress-container">
          <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="notation-guide">
          <h3>Notation Guide</h3>
          <p>In this section, we'll use the following notation:</p>
          <ul>
            <li>Let \( y = u \cdot v \) where u and v are functions of x</li>
            <li>\( \frac{du}{dx} \) = derivative of u with respect to x</li>
            <li>\( \frac{dv}{dx} \) = derivative of v with respect to x</li>
            <li>The Product Rule: \( \frac{dy}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} \)</li>
          </ul>
        </div>

        <div class="rule-box">
          <h3>The Product Rule</h3>
          <div class="product-rule-formula">
            <p>If \( y = u \cdot v \), then:</p>
            <p>\[ \frac{dy}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} \]</p>
          </div>
          <p><strong>In words:</strong> The derivative of a product equals the second function times the derivative of the first, plus the first function times the derivative of the second.</p>
        </div>

        <div class="definition">
          <h3>Why We Need the Product Rule</h3>
          <p>The derivative of a product is <strong>NOT</strong> the product of the derivatives. For example:</p>
          <p>If \( u = x^2 \) and \( v = x^3 \), then:</p>
          <p>\[ \frac{du}{dx} \cdot \frac{dv}{dx} = (2x)(3x^2) = 6x^3 \]</p>
          <p>But the actual derivative of \( y = u \cdot v = x^5 \) is:</p>
          <p>\[ \frac{dy}{dx} = 5x^4 \]</p>
          <p>These are different! This shows why we need a special rule for products.</p>
        </div>

        <div class="interactive-widget">
          <h3>Product Rule Calculator</h3>
          <p>Enter u and v functions to find the derivative of their product:</p>
          <div class="interactive-controls">
            <input type="text" id="u-function" placeholder="u function, e.g., x^2" style="flex: 1;">
            <input type="text" id="v-function" placeholder="v function, e.g., x^3" style="flex: 1;">
            <button id="calculate-product">Calculate Derivative</button>
          </div>
          <div class="interactive-result" id="product-result">
            <p><strong>Step-by-step solution:</strong></p>
            <div id="product-solution"></div>
          </div>
        </div>

        <h2>Worked Examples</h2>
        
        <div class="worked-example">
          <div class="example-header">
            <h3>Example 1: Basic Product Rule Application</h3>
            <span class="example-type">Fundamental Application</span>
          </div>
          <p><strong>Problem:</strong> Find the derivative of \( y = (x^2 + 3x)(4x - 1) \)</p>
          
          <div class="step-by-step">
            <div class="step">
              <div class="step-number">1</div>
              <p><strong>Identify u and v:</strong></p>
              <p>Let \( u = x^2 + 3x \) and \( v = 4x - 1 \)</p>
            </div>
            
            <div class="step">
              <div class="step-number">2</div>
              <p><strong>Find \( \frac{du}{dx} \) and \( \frac{dv}{dx} \):</strong></p>
              <p>\[ \frac{du}{dx} = 2x + 3 \]</p>
              <p>\[ \frac{dv}{dx} = 4 \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">3</div>
              <p><strong>Apply the Product Rule:</strong></p>
              <p>\[ \frac{dy}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} \]</p>
              <p>\[ \frac{dy}{dx} = (4x - 1)(2x + 3) + (x^2 + 3x)(4) \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">4</div>
              <p><strong>Expand and simplify:</strong></p>
              <p>\[ \frac{dy}{dx} = (8x^2 + 12x - 2x - 3) + (4x^2 + 12x) \]</p>
              <p>\[ \frac{dy}{dx} = 8x^2 + 10x - 3 + 4x^2 + 12x \]</p>
              <p>\[ \frac{dy}{dx} = 12x^2 + 22x - 3 \]</p>
            </div>
          </div>
        </div>
        
        <div class="worked-example">
          <div class="example-header">
            <h3>Example 2: Product with Radical Functions</h3>
            <span class="example-type">Advanced Application</span>
          </div>
          <p><strong>Problem:</strong> Find the derivative of \( y = x^3 \cdot \sqrt{x} \)</p>
          
          <div class="step-by-step">
            <div class="step">
              <div class="step-number">1</div>
              <p><strong>Rewrite using exponents and identify u and v:</strong></p>
              <p>\[ y = x^3 \cdot x^{1/2} = x^{7/2} \]</p>
              <p>Let \( u = x^3 \) and \( v = x^{1/2} \)</p>
            </div>
            
            <div class="step">
              <div class="step-number">2</div>
              <p><strong>Find \( \frac{du}{dx} \) and \( \frac{dv}{dx} \):</strong></p>
              <p>\[ \frac{du}{dx} = 3x^2 \]</p>
              <p>\[ \frac{dv}{dx} = \frac{1}{2}x^{-1/2} \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">3</div>
              <p><strong>Apply the Product Rule:</strong></p>
              <p>\[ \frac{dy}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} \]</p>
              <p>\[ \frac{dy}{dx} = (x^{1/2})(3x^2) + (x^3)\left(\frac{1}{2}x^{-1/2}\right) \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">4</div>
              <p><strong>Simplify:</strong></p>
              <p>\[ \frac{dy}{dx} = 3x^{5/2} + \frac{1}{2}x^{5/2} = \frac{7}{2}x^{5/2} \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">5</div>
              <p><strong>Verify with power rule:</strong></p>
              <p>Since \( y = x^{7/2} \), using power rule:</p>
              <p>\[ \frac{dy}{dx} = \frac{7}{2}x^{5/2} \] ✓</p>
            </div>
          </div>
        </div>
        
        <div class="worked-example">
          <div class="example-header">
            <h3>Example 3: Real-World Application</h3>
            <span class="example-type">Economics Context</span>
          </div>
          <p><strong>Problem:</strong> A company's revenue is \( R = x \cdot p(x) \), where \( x \) is quantity sold and \( p(x) = 100 - 0.5x \) is the price function. Find the marginal revenue.</p>
          
          <div class="step-by-step">
            <div class="step">
              <div class="step-number">1</div>
              <p><strong>Identify u and v:</strong></p>
              <p>Let \( u = x \) and \( v = 100 - 0.5x \)</p>
              <p>So \( R = u \cdot v \)</p>
            </div>
            
            <div class="step">
              <div class="step-number">2</div>
              <p><strong>Find \( \frac{du}{dx} \) and \( \frac{dv}{dx} \):</strong></p>
              <p>\[ \frac{du}{dx} = 1 \]</p>
              <p>\[ \frac{dv}{dx} = -0.5 \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">3</div>
              <p><strong>Apply the Product Rule:</strong></p>
              <p>\[ \frac{dR}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} \]</p>
              <p>\[ \frac{dR}{dx} = (100 - 0.5x)(1) + (x)(-0.5) \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">4</div>
              <p><strong>Simplify:</strong></p>
              <p>\[ \frac{dR}{dx} = 100 - 0.5x - 0.5x = 100 - x \]</p>
            </div>
            
            <div class="step">
              <div class="step-number">5</div>
              <p><strong>Interpretation:</strong></p>
              <p>The marginal revenue is \( \frac{dR}{dx} = 100 - x \). This means selling one additional unit increases revenue by \( 100 - x \) dollars.</p>
            </div>
          </div>
        </div>

        <div class="key-concept">
          <h3>When to Use the Product Rule</h3>
          <p>Use the Product Rule when you have:</p>
          <ul>
            <li>A product of two different functions: \( y = u \cdot v \)</li>
            <li>A product where one function is not a constant multiple of the other</li>
            <li>Functions that cannot be easily multiplied together before differentiating</li>
          </ul>
          <p><strong>When NOT to use the Product Rule:</strong></p>
          <ul>
            <li>When one function is a constant (use Constant Multiple Rule)</li>
            <li>When you can easily multiply the functions first</li>
            <li>For sums or differences of functions (use Sum/Difference Rule)</li>
          </ul>
        </div>

        <div class="interactive-widget">
          <h3>Product Rule Practice</h3>
          <p>Test your understanding with these practice problems:</p>
          <div class="interactive-controls">
            <button id="generate-product-problem">New Problem</button>
            <button id="show-hint">Show Hint</button>
            <button id="show-solution">Show Solution</button>
          </div>
          <div class="interactive-result" id="practice-area">
            <div id="problem-display"></div>
            <div id="hint-area" style="display: none; margin-top: 10px; padding: 10px; background: #fff3cd; border-radius: 4px;"></div>
            <div id="solution-area" style="display: none; margin-top: 10px;"></div>
          </div>
        </div>

        <h2>Common Mistakes to Avoid</h2>
        
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Mistake</th>
                <th>Why It's Wrong</th>
                <th>Correct Approach</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>\( \frac{d}{dx}[uv] = \frac{du}{dx} \cdot \frac{dv}{dx} \)</td>
                <td>Derivative of product ≠ Product of derivatives</td>
                <td>Use Product Rule: \( v\frac{du}{dx} + u\frac{dv}{dx} \)</td>
              </tr>
              <tr>
                <td>Forgetting to differentiate both factors</td>
                <td>Product Rule requires derivatives of both u and v</td>
                <td>Always include both \( v\frac{du}{dx} \) and \( u\frac{dv}{dx} \)</td>
              </tr>
              <tr>
                <td>Not simplifying the result</td>
                <td>Leaves answer in unnecessarily complex form</td>
                <td>Expand and combine like terms</td>
              </tr>
              <tr>
                <td>Using Product Rule for sums</td>
                <td>Product Rule is only for products</td>
                <td>Use Sum Rule for sums: \( \frac{d}{dx}[u+v] = \frac{du}{dx} + \frac{dv}{dx} \)</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="quiz-container">
          <h3>Quick Concept Check</h3>
          
          <div class="quiz-question">
            <p><strong>Question 1:</strong> If \( y = u \cdot v \), what is \( \frac{dy}{dx} \)?</p>
            <div class="quiz-options">
              <div class="quiz-option" onclick="checkAnswer(this, 'correct')">\( v\frac{du}{dx} + u\frac{dv}{dx} \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( \frac{du}{dx} \cdot \frac{dv}{dx} \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( u\frac{du}{dx} + v\frac{dv}{dx} \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( \frac{u}{v}\frac{du}{dx} + \frac{v}{u}\frac{dv}{dx} \)</div>
            </div>
            <div class="quiz-feedback correct">✓ Correct! This is the Product Rule formula.</div>
            <div class="quiz-feedback incorrect">✗ Remember the correct formula: \( \frac{dy}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} \)</div>
          </div>
          
          <div class="quiz-question">
            <p><strong>Question 2:</strong> Find \( \frac{dy}{dx} \) for \( y = (x^2 + 1)(3x - 2) \)</p>
            <div class="quiz-options">
              <div class="quiz-option" onclick="checkAnswer(this, 'correct')">\( 9x^2 - 4x + 3 \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( 6x^2 - 4x + 3 \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( (2x)(3) = 6x \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( 3x^2 + 2x - 2 \)</div>
            </div>
            <div class="quiz-feedback correct">✓ Correct! You applied the Product Rule properly.</div>
            <div class="quiz-feedback incorrect">✗ Remember: \( \frac{d}{dx}[uv] = v\frac{du}{dx} + u\frac{dv}{dx} \), not \( \frac{du}{dx} \cdot \frac{dv}{dx} \)</div>
          </div>
        </div>

        <div class="tip">
          <h3>Problem-Solving Strategy</h3>
          <ol>
            <li><strong>Identify</strong> if you have a product of two functions: \( y = u \cdot v \)</li>
            <li><strong>Label</strong> the functions as u and v</li>
            <li><strong>Find</strong> \( \frac{du}{dx} \) and \( \frac{dv}{dx} \) separately</li>
            <li><strong>Apply</strong> the Product Rule: \( v\frac{du}{dx} + u\frac{dv}{dx} \)</li>
            <li><strong>Simplify</strong> the result by expanding and combining like terms</li>
            <li><strong>Verify</strong> your answer makes sense</li>
          </ol>
        </div>
        
        <div class="ap-exam-tip">
          <h3>AP Exam Tip</h3>
          <p>On the AP Calculus exam, Product Rule problems often appear in both multiple-choice and free-response sections. Remember to:</p>
          <ul>
            <li>Show all steps when using the Product Rule</li>
            <li>Clearly identify u and v in free-response questions</li>
            <li>Simplify your final answer</li>
            <li>Check your work by multiplying first (when possible) and differentiating</li>
            <li>Watch for opportunities to simplify before differentiating</li>
          </ul>
        </div>

        <h2>Practice Problems</h2>
        
        <div class="problem-set">
          <div class="problem-card difficulty-easy">
            <h4>Problem 1: Basic Product</h4>
            <p>Find \( \frac{dy}{dx} \) for \( y = (x^3)(2x^2 - 1) \)</p>
            <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
            <div class="solution">
              <p>Let \( u = x^3 \), \( v = 2x^2 - 1 \)</p>
              <p>\[ \frac{du}{dx} = 3x^2 \], \( \frac{dv}{dx} = 4x \)</p>
              <p>\[ \frac{dy}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} = (2x^2 - 1)(3x^2) + (x^3)(4x) \]</p>
              <p>\[ \frac{dy}{dx} = 6x^4 - 3x^2 + 4x^4 = 10x^4 - 3x^2 \]</p>
            </div>
          </div>
          
          <div class="problem-card difficulty-medium">
            <h4>Problem 2: With Constants</h4>
            <p>Differentiate \( y = (3x^2 + 2)(4x^3 - 5x) \)</p>
            <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
            <div class="solution">
              <p>Let \( u = 3x^2 + 2 \), \( v = 4x^3 - 5x \)</p>
              <p>\[ \frac{du}{dx} = 6x \], \( \frac{dv}{dx} = 12x^2 - 5 \)</p>
              <p>\[ \frac{dy}{dx} = v\frac{du}{dx} + u\frac{dv}{dx} = (4x^3 - 5x)(6x) + (3x^2 + 2)(12x^2 - 5) \]</p>
              <p>\[ \frac{dy}{dx} = 24x^4 - 30x^2 + 36x^4 - 15x^2 + 24x^2 - 10 \]</p>
              <p>\[ \frac{dy}{dx} = 60x^4 - 21x^2 - 10 \]</p>
            </div>
          </div>
          
          <div class="problem-card difficulty-hard">
            <h4>Problem 3: Multiple Factors</h4>
            <p>Find \( \frac{dy}{dx} \) for \( y = (x^2 + 1)(x^3 - 2x)(x + 4) \)</p>
            <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
            <div class="solution">
              <p><strong>Method 1: Multiply first, then differentiate</strong></p>
              <p>First multiply: \( (x^2 + 1)(x^3 - 2x) = x^5 - 2x^3 + x^3 - 2x = x^5 - x^3 - 2x \)</p>
              <p>Then multiply by \( (x + 4) \): \( (x^5 - x^3 - 2x)(x + 4) = x^6 + 4x^5 - x^4 - 4x^3 - 2x^2 - 8x \)</p>
              <p>Differentiate: \( \frac{dy}{dx} = 6x^5 + 20x^4 - 4x^3 - 12x^2 - 4x - 8 \)</p>
              
              <p><strong>Method 2: Extended Product Rule</strong></p>
              <p>Let \( u = x^2 + 1 \), \( v = x^3 - 2x \), \( w = x + 4 \)</p>
              <p>\[ \frac{d}{dx}[uvw] = vw\frac{du}{dx} + uw\frac{dv}{dx} + uv\frac{dw}{dx} \]</p>
              <p>\[ = (x^3 - 2x)(x + 4)(2x) + (x^2 + 1)(x + 4)(3x^2 - 2) + (x^2 + 1)(x^3 - 2x)(1) \]</p>
              <p>(This expands to the same result as Method 1)</p>
            </div>
          </div>
        </div>

        <div class="nav-buttons">
          <a href="Ch2_Sec2.3_apcalc_txb.html" class="nav-btn">Back ⬅ Section 2.3</a>
          <a href="Ch2_Sec2.5_apcalc_txb.html" class="nav-btn">Next ➡ Section 2.5</a>
        </div>
      </div>
    </div>
  </div>

  <div id="footer-placeholder"></div>

  <script>
    function toggleSolution(button) {
      const solution = button.nextElementSibling;
      if (solution.style.display === "none" || solution.style.display === "") {
        solution.style.display = "block";
        button.textContent = "Hide Solution";
      } else {
        solution.style.display = "none";
        button.textContent = "Show Solution";
      }
    }
    
    // Quiz functionality
    function checkAnswer(option, result) {
      const options = option.parentElement.children;
      const feedback = option.parentElement.nextElementSibling;
      const nextFeedback = feedback.nextElementSibling;
      
      // Remove all classes first
      for (let opt of options) {
        opt.classList.remove('correct', 'incorrect');
      }
      
      // Show appropriate feedback
      if (result === 'correct') {
        option.classList.add('correct');
        feedback.style.display = 'block';
        nextFeedback.style.display = 'none';
      } else {
        option.classList.add('incorrect');
        feedback.style.display = 'none';
        nextFeedback.style.display = 'block';
        
        // Find and highlight correct answer
        for (let opt of options) {
          if (opt.textContent.includes('v\\frac{du}{dx} + u\\frac{dv}{dx}') || opt.textContent.includes('9x^2 - 4x + 3')) {
            opt.classList.add('correct');
          }
        }
      }
    }

    // Product Rule Calculator
    document.getElementById('calculate-product').addEventListener('click', function() {
      const uInput = document.getElementById('u-function').value;
      const vInput = document.getElementById('v-function').value;
      const solutionElement = document.getElementById('product-solution');
      
      if (!uInput || !vInput) {
        solutionElement.innerHTML = 'Please enter both u and v functions.';
        return;
      }
      
      try {
        const uDeriv = calculatePolynomialDerivative(uInput);
        const vDeriv = calculatePolynomialDerivative(vInput);
        
        let solutionHTML = `
          <p>Let \( u = ${uInput} \) and \( v = ${vInput} \)</p>
          <p>Then \( \\frac{du}{dx} = ${uDeriv} \) and \( \\frac{dv}{dx} = ${vDeriv} \)</p>
          <p>Using the Product Rule:</p>
          <p>\[ \\frac{dy}{dx} = v\\frac{du}{dx} + u\\frac{dv}{dx} \]</p>
          <p>\[ = (${vInput})(${uDeriv}) + (${uInput})(${vDeriv}) \]</p>
        `;
        
        // Try to simplify if possible
        const simplified = simplifyProductRule(uInput, uDeriv, vInput, vDeriv);
        if (simplified) {
          solutionHTML += `<p><strong>Simplified:</strong> \( ${simplified} \)</p>`;
        }
        
        solutionElement.innerHTML = solutionHTML;
        
        // Re-render MathJax
        if (window.MathJax) {
          MathJax.typeset();
        }
        
      } catch (error) {
        solutionElement.innerHTML = 'Error: Could not calculate derivative. Please check your input format.';
      }
    });

    // Practice Problem Generator
    const productProblems = [
      {
        problem: "Find \( \\frac{dy}{dx} \) for \( y = (x^2 + 3)(2x - 1) \)",
        hint: "Let u = x² + 3 and v = 2x - 1, then apply Product Rule",
        solution: "\\frac{dy}{dx} = (2x - 1)(2x) + (x^2 + 3)(2) = 4x^2 - 2x + 2x^2 + 6 = 6x^2 - 2x + 6"
      },
      {
        problem: "Differentiate \( y = (3x - 2)(x^3 + 4x) \)",
        hint: "Let u = 3x - 2 and v = x³ + 4x",
        solution: "\\frac{dy}{dx} = (x^3 + 4x)(3) + (3x - 2)(3x^2 + 4) = 3x^3 + 12x + 9x^3 + 12x - 6x^2 - 8 = 12x^3 - 6x^2 + 24x - 8"
      },
      {
        problem: "Find \( \\frac{dy}{dx} \) for \( y = (x^4)(2x^2 + 5x) \)",
        hint: "You could use Product Rule or multiply first then use Power Rule",
        solution: "Using Product Rule: \\frac{dy}{dx} = (2x^2 + 5x)(4x^3) + (x^4)(4x + 5) = 8x^5 + 20x^4 + 4x^5 + 5x^4 = 12x^5 + 25x^4"
      }
    ];

    document.getElementById('generate-product-problem').addEventListener('click', function() {
      const randomIndex = Math.floor(Math.random() * productProblems.length);
      const problem = productProblems[randomIndex];
      
      document.getElementById('problem-display').innerHTML = `<p><strong>Problem:</strong> ${problem.problem}</p>`;
      document.getElementById('hint-area').innerHTML = `<strong>Hint:</strong> ${problem.hint}`;
      document.getElementById('solution-area').innerHTML = `<strong>Solution:</strong> \\[ ${problem.solution} \\]`;
      document.getElementById('hint-area').style.display = 'none';
      document.getElementById('solution-area').style.display = 'none';
      
      if (window.MathJax) {
        MathJax.typeset();
      }
    });

    document.getElementById('show-hint').addEventListener('click', function() {
      document.getElementById('hint-area').style.display = 'block';
    });

    document.getElementById('show-solution').addEventListener('click', function() {
      document.getElementById('solution-area').style.display = 'block';
      if (window.MathJax) {
        MathJax.typeset();
      }
    });

    // Polynomial derivative calculation
    function calculatePolynomialDerivative(expression) {
      expression = expression.replace(/\s/g, '').toLowerCase();
      expression = expression.replace(/t/g, 'x');
      
      const terms = expression.split(/(?=[+-])/).filter(term => term !== '');
      let derivativeTerms = [];
      
      for (let term of terms) {
        if (term === '+' || term === '-') continue;
        
        if (!term.includes('x')) continue;
        
        let coefficient = 1;
        let exponent = 1;
        
        const coefficientMatch = term.match(/^([+-]?\d*\.?\d*)/);
        if (coefficientMatch && coefficientMatch[1]) {
          if (coefficientMatch[1] === '+' || coefficientMatch[1] === '') {
            coefficient = 1;
          } else if (coefficientMatch[1] === '-') {
            coefficient = -1;
          } else {
            coefficient = parseFloat(coefficientMatch[1]);
          }
        }
        
        if (term.includes('^')) {
          const exponentMatch = term.match(/\^([+-]?\d+\.?\d*)/);
          if (exponentMatch) {
            exponent = parseFloat(exponentMatch[1]);
          }
        } else if (term.includes('x')) {
          exponent = 1;
        }
        
        const newCoefficient = coefficient * exponent;
        const newExponent = exponent - 1;
        
        let derivativeTerm = '';
        if (newCoefficient !== 0) {
          if (newCoefficient > 0 && derivativeTerms.length > 0) {
            derivativeTerm += '+';
          }
          
          if (newCoefficient === 1 && newExponent !== 0) {
            // Omit coefficient
          } else if (newCoefficient === -1 && newExponent !== 0) {
            derivativeTerm += '-';
          } else {
            if (Number.isInteger(newCoefficient)) {
              derivativeTerm += newCoefficient;
            } else {
              derivativeTerm += newCoefficient.toFixed(2);
            }
          }
          
          if (newExponent === 1) {
            derivativeTerm += 'x';
          } else if (newExponent > 1 || newExponent < 0) {
            derivativeTerm += `x^${newExponent}`;
          }
        }
        
        if (derivativeTerm !== '' && derivativeTerm !== '+') {
          derivativeTerms.push(derivativeTerm);
        }
      }
      
      if (derivativeTerms.length === 0) return '0';
      return derivativeTerms.join('');
    }

    // Simple product rule simplification
    function simplifyProductRule(u, uPrime, v, vPrime) {
      // This is a simplified implementation - in practice, you'd want a more robust system
      return `${v} \\cdot (${uPrime}) + ${u} \\cdot (${vPrime})`;
    }
    
    // Progress tracking
    document.getElementById('mark-complete-btn').addEventListener('click', function() {
      const progressBar = document.getElementById('progress-bar');
      progressBar.style.width = '100%';
      this.textContent = 'Completed!';
      this.disabled = true;
      localStorage.setItem('section-2.4-completed', 'true');
    });
    
    // Load progress on page load
    document.addEventListener('DOMContentLoaded', function() {
      if (localStorage.getItem('section-2.4-completed')) {
        const progressBar = document.getElementById('progress-bar');
        progressBar.style.width = '100%';
        const button = document.getElementById('mark-complete-btn');
        button.textContent = 'Completed!';
        button.disabled = true;
      }
      
      // Generate initial practice problem
      document.getElementById('generate-product-problem').click();
    });

    async function loadComponent(url, elementId, pageTitle = null) {
      try {
        const response = await fetch(url, { cache: "no-store" });
        if (!response.ok) throw new Error(`Failed to load ${url}: ${response.status}`);
        const html = await response.text();
        const container = document.getElementById(elementId);
        if (!container) return;
        container.innerHTML = html;
        if (pageTitle && elementId === 'header-placeholder') {
          const titleEl = container.querySelector('#section-title') || container.querySelector('h1');
          if (titleEl) titleEl.textContent = pageTitle;
          document.title = pageTitle;
        }
      } catch (err) {
        console.error(err);
        const el = document.getElementById(elementId);
        if (el) el.innerHTML = `<p style="color:red;">Error loading component: ${url}</p>`;
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await loadComponent('textbookheader.html', 'header-placeholder', 'Section 2.4 – The Product Rule');
      await loadComponent('textbooksidebar.html', 'sidebar-placeholder');
      await loadComponent('textbookfooter.html', 'footer-placeholder');

      const currentUrl = window.location.pathname.split('/').pop().split('?')[0];
      const links = document.querySelectorAll('#sidebar-placeholder a');
      links.forEach(link => {
        const linkUrl = link.getAttribute('href').split('?')[0];
        if (linkUrl === currentUrl) {
          link.classList.add('active');
          link.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      });
    });
  </script>

</body>
</html>
