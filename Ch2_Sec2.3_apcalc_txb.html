<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Section 2.3 – Classwork (Basic Rules & Context)</title>

  <script src="https://tklesson.com/resources-loader.js"></script>
  <script>loadCommonResources();</script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    * { box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      line-height: 1.6;
      background: #ffffff;
      color: #00274d;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    #header-placeholder, #footer-placeholder { width: 100%; }

    .page-container { display: flex; flex-grow: 1; }

    .sidebar {
      width: 250px;
      background: #00274d;
      color: white;
      padding: 20px;
      flex-shrink: 0;
      overflow-y: auto;
      max-height: 100vh;
    }

    .sidebar h3 { color: white; margin-top: 0; }
    .sidebar ul { list-style-type: none; padding: 0; }
    .sidebar ul li a {
      display: block;
      padding: 10px;
      color: #c0c0c0;
      text-decoration: none;
      border-bottom: 1px solid #0056b3;
    }
    .sidebar ul li a:hover { background: #0056b3; color: white; }
    .sidebar ul li a.active { background: #0056b3; color: white; font-weight: bold; }

    header {
      background: #00274d;
      color: white;
      padding: 20px;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header img { height: 50px; flex-shrink: 0; }
    header h1 {
      margin: 0;
      font-size: 1.8em;
      color: white;
      text-align: center;
      flex-grow: 1;
      flex-shrink: 1;
      min-width: 0;
      padding: 0 10px;
    }
    header a.home-link {
      color: white;
      text-decoration: none;
      font-size: 1em;
      background: #0056b3;
      padding: 6px 12px;
      border-radius: 6px;
      flex-shrink: 0;
    }
    header a.home-link:hover { background: #0073e6; }

    .footer {
      background: #00274d;
      color: white;
      text-align: center;
      padding: 20px;
      width: 100%;
      flex-shrink: 0;
    }

    .main-content { flex-grow: 1; }
    .container { padding: 20px; max-width: 900px; margin: auto; }

    h2 { color: #0056b3; border-bottom: 2px solid #0056b3; padding-bottom: 5px; }
    h3 { color: #0056b3; }

    .nav-buttons { display: flex; justify-content: space-between; margin: 30px auto; }
    .nav-btn {
      background: #0056b3;
      color: white;
      padding: 12px 25px;
      border-radius: 8px;
      text-decoration: none;
      font-size: 1.1em;
    }
    .nav-btn:hover { background: #0073e6; }

    .example, .tip, .check, .definition, .key-concept, .ap-exam-tip, .worked-example, .real-world-app, .practice-problem {
      background: #f0f8ff;
      border-left: 5px solid #0056b3;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
    }
    
    .worked-example { border-left-color: #28a745; }
    .practice-problem { border-left-color: #ff6b35; }
    .real-world-app { border-left-color: #ff6b35; }
    .definition { border-left-color: #28a745; }
    .key-concept { border-left-color: #ffc107; }
    .ap-exam-tip { border-left-color: #dc3545; }
    
    .check p { font-size: 1.2em; }

    .solution {
      display: none;
      background: #e6f2ff;
      border: 1px solid #0056b3;
      padding: 15px;
      margin-top: 10px;
      border-radius: 6px;
    }

    .show-solution-btn {
      background: #0056b3;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }
    .show-solution-btn:hover { background: #0073e6; }
    
    .interactive-widget {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
    }
    
    .interactive-controls {
      display: flex;
      gap: 10px;
      margin: 10px 0;
      flex-wrap: wrap;
    }
    
    .interactive-controls input, .interactive-controls button, .interactive-controls select {
      padding: 8px 12px;
      border: 1px solid #ced4da;
      border-radius: 4px;
    }
    
    .interactive-controls button {
      background: #0056b3;
      color: white;
      cursor: pointer;
      border: none;
    }
    
    .interactive-controls button:hover {
      background: #0073e6;
    }
    
    .interactive-result {
      margin-top: 15px;
      padding: 15px;
      background: #e9ecef;
      border-radius: 4px;
    }
    
    .learning-objectives {
      background: #e7f3ff;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    
    .learning-objectives h3 {
      margin-top: 0;
    }
    
    .learning-objectives ul {
      padding-left: 20px;
    }
    
    .learning-objectives li {
      margin-bottom: 8px;
    }
    
    .table-container {
      overflow-x: auto;
      margin: 20px 0;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th, td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    
    th {
      background-color: #0056b3;
      color: white;
    }
    
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    
    .progress-container {
      margin: 20px 0;
      background: #f1f1f1;
      border-radius: 8px;
      height: 10px;
    }
    
    .progress-bar {
      height: 100%;
      background: #0056b3;
      border-radius: 8px;
      width: 0%;
      transition: width 0.5s ease-in-out;
    }
    
    .section-completion {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .section-completion button {
      background: #0056b3;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
    }
    
    .section-completion button:hover {
      background: #0073e6;
    }
    
    .step-by-step {
      margin: 15px 0;
      padding-left: 20px;
    }
    
    .step {
      margin-bottom: 10px;
      position: relative;
    }
    
    .step-number {
      position: absolute;
      left: -20px;
      background: #0056b3;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8em;
    }
    
    .example-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .example-type {
      background: #0056b3;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.8em;
    }
    
    .problem-set {
      display: grid;
      gap: 20px;
      margin: 25px 0;
    }
    
    .problem-card {
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .problem-card h4 {
      margin-top: 0;
      color: #0056b3;
      border-bottom: 1px solid #e9ecef;
      padding-bottom: 10px;
    }
    
    .difficulty-easy { border-left: 4px solid #28a745; }
    .difficulty-medium { border-left: 4px solid #ffc107; }
    .difficulty-hard { border-left: 4px solid #dc3545; }
    
    .quiz-container {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      margin: 25px 0;
    }
    
    .quiz-question {
      margin-bottom: 20px;
    }
    
    .quiz-options {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 15px 0;
    }
    
    .quiz-option {
      padding: 10px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .quiz-option:hover {
      background: #e9ecef;
    }
    
    .quiz-option.correct {
      background: #d4edda;
      border-color: #c3e6cb;
    }
    
    .quiz-option.incorrect {
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .quiz-feedback {
      margin-top: 10px;
      padding: 10px;
      border-radius: 4px;
      display: none;
    }
    
    .quiz-feedback.correct {
      background: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
    }
    
    .quiz-feedback.incorrect {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }

    @media (max-width: 768px) {
      .page-container { flex-direction: column; }
      .sidebar { width: 100%; max-height: none; order: -1; }
      .interactive-controls { flex-direction: column; }
      .problem-set { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <script type="module" src="firebase-auth.js"></script>

  <div id="header-placeholder"></div>

  <div class="page-container">
    <div id="sidebar-placeholder"></div>

    <div class="main-content">
      <div class="container">
        <h2>2.3 – Classwork (Basic Rules & Context)</h2>
        
        <div class="learning-objectives">
          <h3>Learning Objectives</h3>
          <p>By the end of this section, you should be able to:</p>
          <ul>
            <li>Apply derivative rules to solve mixed practice problems</li>
            <li>Connect derivative concepts to real-world applications</li>
            <li>Solve problems involving multiple derivative rules</li>
            <li>Interpret derivatives in various contexts</li>
            <li>Build confidence through extensive practice</li>
          </ul>
        </div>
        
        <div class="section-completion">
          <span>Section Progress</span>
          <button id="mark-complete-btn">Mark as Complete</button>
        </div>
        <div class="progress-container">
          <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="interactive-widget">
          <h3>Derivative Calculator</h3>
          <p>Enter a function to find its derivative:</p>
          <div class="interactive-controls">
            <input type="text" id="function-input" placeholder="e.g., 3x^2 + 2x - 5" style="flex-grow: 1;">
            <button id="calculate-derivative">Calculate Derivative</button>
          </div>
          <div class="interactive-result" id="derivative-result">
            The derivative will appear here.
          </div>
        </div>

        <div class="interactive-widget">
          <h3>Motion Problem Solver</h3>
          <p>Enter position function to find velocity and acceleration:</p>
          <div class="interactive-controls">
            <input type="text" id="position-function" placeholder="e.g., t^3 - 6t^2 + 9t + 2" style="flex-grow: 1;">
            <button id="calculate-motion">Calculate Motion</button>
          </div>
          <div class="interactive-result" id="motion-result">
            <p><strong>Velocity:</strong> <span id="velocity-output">-</span></p>
            <p><strong>Acceleration:</strong> <span id="acceleration-output">-</span></p>
            <p><strong>Times at rest:</strong> <span id="rest-times">-</span></p>
          </div>
        </div>

        <div class="interactive-widget">
          <h3>Related Rates Calculator</h3>
          <p>Select a problem type:</p>
          <div class="interactive-controls">
            <select id="related-rates-type">
              <option value="sphere">Sphere Volume</option>
              <option value="circle">Circle Area</option>
              <option value="ladder">Ladder Problem</option>
            </select>
            <input type="number" id="rate-input" placeholder="Rate of change" step="0.1">
            <input type="number" id="value-input" placeholder="Current value" step="0.1">
            <button id="calculate-related">Calculate</button>
          </div>
          <div class="interactive-result" id="related-result">
            The solution will appear here.
          </div>
        </div>

        <h2>Practice Problem Sets</h2>
        
        <div class="problem-set">
          <div class="problem-card difficulty-easy">
            <h4>Problem 1: Basic Differentiation</h4>
            <p>Find the derivative of \( f(x) = 4x^3 - 2x^2 + 7x - 5 \)</p>
            <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
            <div class="solution">
              <p>\[ f'(x) = \frac{d}{dx}[4x^3] - \frac{d}{dx}[2x^2] + \frac{d}{dx}[7x] - \frac{d}{dx}[5] \]</p>
              <p>\[ f'(x) = 12x^2 - 4x + 7 \]</p>
            </div>
          </div>
          
          <div class="problem-card difficulty-medium">
            <h4>Problem 2: Motion Application</h4>
            <p>A ball is thrown upward with position function \( s(t) = -16t^2 + 64t + 80 \) feet. Find:</p>
            <p>(a) The velocity function</p>
            <p>(b) When the ball reaches its maximum height</p>
            <p>(c) The velocity when the ball hits the ground</p>
            <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
            <div class="solution">
              <p><strong>(a) Velocity function:</strong></p>
              <p>\[ v(t) = s'(t) = -32t + 64 \]</p>
              
              <p><strong>(b) Maximum height occurs when velocity is zero:</strong></p>
              <p>\[ -32t + 64 = 0 \]</p>
              <p>\[ t = 2 \text{ seconds} \]</p>
              
              <p><strong>(c) Ball hits ground when \( s(t) = 0 \):</strong></p>
              <p>\[ -16t^2 + 64t + 80 = 0 \]</p>
              <p>\[ t^2 - 4t - 5 = 0 \]</p>
              <p>\[ (t-5)(t+1) = 0 \]</p>
              <p>\[ t = 5 \text{ seconds} \]</p>
              <p>\[ v(5) = -32(5) + 64 = -96 \text{ ft/s} \]</p>
            </div>
          </div>
          
          <div class="problem-card difficulty-hard">
            <h4>Problem 3: Related Rates</h4>
            <p>A ladder 10 feet long rests against a vertical wall. If the bottom of the ladder slides away from the wall at 1 ft/s, how fast is the top of the ladder sliding down the wall when the bottom is 6 feet from the wall?</p>
            <button class="show-solution-btn" onclick="toggleSolution(this)">Show Solution</button>
            <div class="solution">
              <p><strong>Step 1: Set up the relationship</strong></p>
              <p>Let \( x \) = distance from wall to bottom of ladder</p>
              <p>Let \( y \) = height of top of ladder</p>
              <p>\[ x^2 + y^2 = 10^2 \]</p>
              
              <p><strong>Step 2: Differentiate with respect to time</strong></p>
              <p>\[ 2x\frac{dx}{dt} + 2y\frac{dy}{dt} = 0 \]</p>
              
              <p><strong>Step 3: Find values when \( x = 6 \)</strong></p>
              <p>\[ 6^2 + y^2 = 100 \]</p>
              <p>\[ y^2 = 64 \]</p>
              <p>\[ y = 8 \text{ ft} \]</p>
              
              <p><strong>Step 4: Solve for \( \frac{dy}{dt} \)</strong></p>
              <p>\[ 2(6)(1) + 2(8)\frac{dy}{dt} = 0 \]</p>
              <p>\[ 12 + 16\frac{dy}{dt} = 0 \]</p>
              <p>\[ \frac{dy}{dt} = -\frac{12}{16} = -0.75 \text{ ft/s} \]</p>
              <p>The top is sliding down at 0.75 ft/s.</p>
            </div>
          </div>
        </div>

        <div class="quiz-container">
          <h3>Quick Concept Check</h3>
          
          <div class="quiz-question">
            <p><strong>Question 1:</strong> What is the derivative of \( f(x) = 5x^4 - 3x^2 + 2 \)?</p>
            <div class="quiz-options">
              <div class="quiz-option" onclick="checkAnswer(this, 'correct')">\( 20x^3 - 6x \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( 5x^3 - 3x \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( 20x^3 - 6x + 2 \)</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">\( 4x^3 - 2x \)</div>
            </div>
            <div class="quiz-feedback correct">✓ Correct! You applied the power rule correctly to each term.</div>
            <div class="quiz-feedback incorrect">✗ Remember: The derivative of a constant is 0, and use the power rule: \( \frac{d}{dx}[x^n] = nx^{n-1} \)</div>
          </div>
          
          <div class="quiz-question">
            <p><strong>Question 2:</strong> If \( s(t) \) represents position, what does \( s'(t) \) represent?</p>
            <div class="quiz-options">
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Acceleration</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'correct')">Velocity</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Jerk</div>
              <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">Distance</div>
            </div>
            <div class="quiz-feedback correct">✓ Correct! Velocity is the derivative of position.</div>
            <div class="quiz-feedback incorrect">✗ Remember: Position → Velocity → Acceleration → Jerk (each is the derivative of the previous)</div>
          </div>
        </div>

        <div class="nav-buttons">
          <a href="Ch2_Sec2.2_apcalc_txb.html" class="nav-btn">Back ⬅ Section 2.2</a>
          <a href="Ch2_Sec2.4_apcalc_txb.html" class="nav-btn">Next ➡ Section 2.4</a>
        </div>
      </div>
    </div>
  </div>

  <div id="footer-placeholder"></div>

  <script>
    function toggleSolution(button) {
      const solution = button.nextElementSibling;
      if (solution.style.display === "none" || solution.style.display === "") {
        solution.style.display = "block";
        button.textContent = "Hide Solution";
      } else {
        solution.style.display = "none";
        button.textContent = "Show Solution";
      }
    }
    
    // Quiz functionality
    function checkAnswer(option, result) {
      const options = option.parentElement.children;
      const feedback = option.parentElement.nextElementSibling;
      const nextFeedback = feedback.nextElementSibling;
      
      // Remove all classes first
      for (let opt of options) {
        opt.classList.remove('correct', 'incorrect');
      }
      
      // Show appropriate feedback
      if (result === 'correct') {
        option.classList.add('correct');
        feedback.style.display = 'block';
        nextFeedback.style.display = 'none';
      } else {
        option.classList.add('incorrect');
        feedback.style.display = 'none';
        nextFeedback.style.display = 'block';
        
        // Find and highlight correct answer
        for (let opt of options) {
          if (opt.textContent.includes('20x^3 - 6x') || opt.textContent === 'Velocity') {
            opt.classList.add('correct');
          }
        }
      }
    }

    // Derivative Calculator
    document.getElementById('calculate-derivative').addEventListener('click', function() {
      const input = document.getElementById('function-input').value;
      const resultElement = document.getElementById('derivative-result');
      
      if (!input) {
        resultElement.innerHTML = 'Please enter a function.';
        return;
      }
      
      try {
        const derivative = calculatePolynomialDerivative(input);
        resultElement.innerHTML = `The derivative of \( ${input} \) is \( ${derivative} \).`;
        
        // Re-render MathJax
        if (window.MathJax) {
          MathJax.typeset();
        }
      } catch (error) {
        resultElement.innerHTML = 'Error: Could not calculate derivative. Please check your input format.';
      }
    });

    // Motion Problem Solver
    document.getElementById('calculate-motion').addEventListener('click', function() {
      const positionFunc = document.getElementById('position-function').value;
      const velocityOutput = document.getElementById('velocity-output');
      const accelerationOutput = document.getElementById('acceleration-output');
      const restTimesOutput = document.getElementById('rest-times');
      
      try {
        const velocity = calculatePolynomialDerivative(positionFunc);
        const acceleration = calculatePolynomialDerivative(velocity);
        const restTimes = findPolynomialZeros(velocity);
        
        velocityOutput.textContent = `v(t) = ${velocity}`;
        accelerationOutput.textContent = `a(t) = ${acceleration}`;
        restTimesOutput.textContent = restTimes.length > 0 ? 
          `t = ${restTimes.join(', ')} seconds` : 'Never at rest';
        
      } catch (error) {
        velocityOutput.textContent = 'Error';
        accelerationOutput.textContent = 'Error';
        restTimesOutput.textContent = 'Error calculating';
      }
    });

    // Related Rates Calculator
    document.getElementById('calculate-related').addEventListener('click', function() {
      const problemType = document.getElementById('related-rates-type').value;
      const rate = parseFloat(document.getElementById('rate-input').value);
      const value = parseFloat(document.getElementById('value-input').value);
      const resultElement = document.getElementById('related-result');
      
      if (isNaN(rate) || isNaN(value)) {
        resultElement.innerHTML = 'Please enter valid numbers for rate and value.';
        return;
      }
      
      let solution;
      switch (problemType) {
        case 'sphere':
          // Volume of sphere: V = (4/3)πr³, dV/dt = 4πr² dr/dt
          const drdt = rate / (4 * Math.PI * value * value);
          solution = `For a sphere with radius ${value} units and volume changing at ${rate} units³/s:<br>
                     The radius is changing at dr/dt = ${drdt.toFixed(4)} units/s`;
          break;
        case 'circle':
          // Area of circle: A = πr², dA/dt = 2πr dr/dt
          const drdtCircle = rate / (2 * Math.PI * value);
          solution = `For a circle with radius ${value} units and area changing at ${rate} units²/s:<br>
                     The radius is changing at dr/dt = ${drdtCircle.toFixed(4)} units/s`;
          break;
        case 'ladder':
          // Ladder problem: x² + y² = L²
          const y = Math.sqrt(100 - value * value); // Assuming 10 ft ladder
          const dydt = (-value * rate) / y;
          solution = `For a 10 ft ladder with bottom ${value} ft from wall moving at ${rate} ft/s:<br>
                     The top is sliding down at dy/dt = ${Math.abs(dydt).toFixed(4)} ft/s`;
          break;
      }
      
      resultElement.innerHTML = solution;
    });

    // Polynomial derivative calculation
    function calculatePolynomialDerivative(expression) {
      // Remove spaces and convert to lowercase
      expression = expression.replace(/\s/g, '').toLowerCase();
      
      // Handle common variables
      expression = expression.replace(/t/g, 'x');
      
      // Split into terms
      const terms = expression.split(/(?=[+-])/).filter(term => term !== '');
      let derivativeTerms = [];
      
      for (let term of terms) {
        if (term === '+' || term === '-') continue;
        
        // Handle constant term
        if (!term.includes('x')) {
          // Constant term - derivative is 0, so skip
          continue;
        }
        
        let coefficient = 1;
        let exponent = 1;
        
        // Extract coefficient
        const coefficientMatch = term.match(/^([+-]?\d*\.?\d*)/);
        if (coefficientMatch && coefficientMatch[1]) {
          if (coefficientMatch[1] === '+' || coefficientMatch[1] === '') {
            coefficient = 1;
          } else if (coefficientMatch[1] === '-') {
            coefficient = -1;
          } else {
            coefficient = parseFloat(coefficientMatch[1]);
          }
        }
        
        // Check if there's an exponent
        if (term.includes('^')) {
          const exponentMatch = term.match(/\^([+-]?\d+\.?\d*)/);
          if (exponentMatch) {
            exponent = parseFloat(exponentMatch[1]);
          }
        } else if (term.includes('x')) {
          exponent = 1;
        }
        
        // Calculate derivative
        const newCoefficient = coefficient * exponent;
        const newExponent = exponent - 1;
        
        // Format the term
        let derivativeTerm = '';
        if (newCoefficient !== 0) {
          // Add sign for positive terms after the first
          if (newCoefficient > 0 && derivativeTerms.length > 0) {
            derivativeTerm += '+';
          }
          
          // Handle coefficient
          if (newCoefficient === 1 && newExponent !== 0) {
            // Omit coefficient if it's 1
          } else if (newCoefficient === -1 && newExponent !== 0) {
            derivativeTerm += '-';
          } else {
            // Check if coefficient is integer
            if (Number.isInteger(newCoefficient)) {
              derivativeTerm += newCoefficient;
            } else {
              derivativeTerm += newCoefficient.toFixed(2);
            }
          }
          
          // Handle variable and exponent
          if (newExponent === 1) {
            derivativeTerm += 'x';
          } else if (newExponent > 1 || newExponent < 0) {
            derivativeTerm += `x^${newExponent}`;
          } else if (newExponent === 0) {
            // Just the constant - no x
          }
        }
        
        if (derivativeTerm !== '' && derivativeTerm !== '+') {
          derivativeTerms.push(derivativeTerm);
        }
      }
      
      if (derivativeTerms.length === 0) {
        return '0';
      }
      
      return derivativeTerms.join('');
    }

    // Find zeros of polynomial (for motion problems)
    function findPolynomialZeros(expression) {
      // Simple implementation for common cases
      expression = expression.replace(/\s/g, '').toLowerCase();
      
      // Handle simple quadratic: ax^2 + bx + c
      const quadraticMatch = expression.match(/^([+-]?\d*)x\^2([+-]\d+)x([+-]\d+)$/);
      if (quadraticMatch) {
        const a = parseFloat(quadraticMatch[1] || '1');
        const b = parseFloat(quadraticMatch[2]);
        const c = parseFloat(quadraticMatch[3]);
        
        const discriminant = b * b - 4 * a * c;
        if (discriminant >= 0) {
          const root1 = (-b + Math.sqrt(discriminant)) / (2 * a);
          const root2 = (-b - Math.sqrt(discriminant)) / (2 * a);
          return [root1.toFixed(2), root2.toFixed(2)].filter(r => r >= 0);
        }
      }
      
      // Handle linear: ax + b
      const linearMatch = expression.match(/^([+-]?\d*)x([+-]\d+)$/);
      if (linearMatch) {
        const a = parseFloat(linearMatch[1] || '1');
        const b = parseFloat(linearMatch[2]);
        const root = -b / a;
        return root >= 0 ? [root.toFixed(2)] : [];
      }
      
      return [];
    }
    
    // Progress tracking
    document.getElementById('mark-complete-btn').addEventListener('click', function() {
      const progressBar = document.getElementById('progress-bar');
      progressBar.style.width = '100%';
      this.textContent = 'Completed!';
      this.disabled = true;
      localStorage.setItem('section-2.3-completed', 'true');
    });
    
    // Load progress on page load
    document.addEventListener('DOMContentLoaded', function() {
      if (localStorage.getItem('section-2.3-completed')) {
        const progressBar = document.getElementById('progress-bar');
        progressBar.style.width = '100%';
        const button = document.getElementById('mark-complete-btn');
        button.textContent = 'Completed!';
        button.disabled = true;
      }
    });

    async function loadComponent(url, elementId, pageTitle = null) {
      try {
        const response = await fetch(url, { cache: "no-store" });
        if (!response.ok) throw new Error(`Failed to load ${url}: ${response.status}`);
        const html = await response.text();
        const container = document.getElementById(elementId);
        if (!container) return;
        container.innerHTML = html;
        if (pageTitle && elementId === 'header-placeholder') {
          const titleEl = container.querySelector('#section-title') || container.querySelector('h1');
          if (titleEl) titleEl.textContent = pageTitle;
          document.title = pageTitle;
        }
      } catch (err) {
        console.error(err);
        const el = document.getElementById(elementId);
        if (el) el.innerHTML = `<p style="color:red;">Error loading component: ${url}</p>`;
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await loadComponent('textbookheader.html', 'header-placeholder', 'Section 2.3 – Classwork');
      await loadComponent('textbooksidebar.html', 'sidebar-placeholder');
      await loadComponent('textbookfooter.html', 'footer-placeholder');

      const currentUrl = window.location.pathname.split('/').pop().split('?')[0];
      const links = document.querySelectorAll('#sidebar-placeholder a');
      links.forEach(link => {
        const linkUrl = link.getAttribute('href').split('?')[0];
        if (linkUrl === currentUrl) {
          link.classList.add('active');
          link.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      });
    });
  </script>

</body>
</html>
