<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AP Biology – Cellular & Molecular Biology | Tklesson</title>

<link rel="canonical" href="https://tklesson.com/" />
<link rel="icon" type="image/png" sizes="16x16" href="/Tklesson1-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/Tklesson1-32x32.png">
<link rel="apple-touch-icon" href="/Tklesson1-192x192.png">
<meta name="theme-color" content="#0f4c81">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Slab:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --primary: #0f4c81;
  --primary-light: #1a5d9f;
  --primary-dark: #0a3a66;
  --secondary: #27ae60;
  --secondary-light: #2ecc71;
  --secondary-dark: #219653;
  --accent: #e6375a;
  --light: #f8fafc;
  --dark: #1e293b;
  --gray: #94a3b8;
  --success: #27ae60;
  --error: #e74c3c;
  --warning: #f39c12;
  --text: #2d3748;
  --text-light: #718096;
  --border: #e2e8f0;
  --card-bg: #ffffff;
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Poppins', sans-serif;
  line-height: 1.6;
  color: var(--text);
  background: linear-gradient(135deg, #f0f8ff 0%, #f1f9f1 100%);
  min-height: 100vh;
}

.container {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1.5rem;
}

/* Header */
.quiz-header {
  background: var(--gradient);
  color: white;
  padding: 1.5rem 2rem;
  text-align: center;
  position: relative;
  overflow: hidden;
  box-shadow: var(--shadow);
}

.header-content {
  position: relative;
  z-index: 1;
}

.header-logo {
  height: 60px;
  margin-bottom: 0.5rem;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
}

.header-title {
  font-family: 'Roboto Slab', serif;
  font-size: 2.2rem;
  margin-bottom: 0.5rem;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.header-subtitle {
  font-size: 1.1rem;
  opacity: 0.9;
  color: #e2e8f0;
  font-weight: 400;
}

/* Quiz Container */
.quiz-container {
  background: white;
  border-radius: 1rem;
  margin: 2rem auto;
  padding: 2rem;
  box-shadow: var(--shadow-lg);
  position: relative;
  overflow: hidden;
}

.quiz-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 5px;
  background: var(--gradient);
}

.questions-container {
  margin-bottom: 2rem;
}

.question-card {
  background: #f8fafc;
  border-radius: 0.75rem;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  border-left: 4px solid var(--primary);
  transition: all 0.3s ease;
  position: relative;
}

.question-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow);
}

.question-number {
  position: absolute;
  top: -12px;
  left: 15px;
  background: var(--primary);
  color: white;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 0.9rem;
  box-shadow: var(--shadow);
}

.question-text {
  font-weight: 600;
  margin-bottom: 1.5rem;
  color: var(--dark);
  font-size: 1.1rem;
  padding-top: 0.5rem;
}

.options-container {
  display: grid;
  gap: 0.75rem;
}

.option {
  background: white;
  border: 2px solid var(--border);
  border-radius: 0.5rem;
  padding: 0.75rem 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 0.95rem;
  display: flex;
  align-items: flex-start;
}

.option-label {
  font-weight: 600;
  margin-right: 10px;
  min-width: 25px;
}

.option-content {
  flex: 1;
}

.option:hover {
  border-color: var(--primary);
  background: rgba(15, 76, 129, 0.03);
}

.option.selected {
  border-color: var(--primary);
  background: rgba(15, 76, 129, 0.08);
}

.option.correct {
  border-color: var(--success);
  background: rgba(39, 174, 96, 0.1);
}

.option.incorrect {
  border-color: var(--error);
  background: rgba(231, 76, 60, 0.1);
}

/* Buttons */
.buttons-container {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  margin-bottom: 1.5rem;
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  border: none;
  outline: none;
  font-size: 1rem;
  font-family: 'Poppins', sans-serif;
}

.btn-primary {
  background: var(--primary);
  color: white;
}

.btn-primary:hover {
  background: var(--primary-light);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-secondary {
  background: var(--secondary);
  color: white;
}

.btn-secondary:hover {
  background: var(--secondary-light);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-success {
  background: var(--success);
  color: white;
}

.btn-success:hover {
  background: #219653;
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

/* Results */
.results-container {
  margin-top: 2rem;
  padding: 1.5rem;
  border-radius: 0.75rem;
  background: #f1f5f9;
  display: none;
  border-left: 4px solid var(--primary);
}

.score-display {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 1rem;
  text-align: center;
  color: var(--dark);
}

/* Message */
.message {
  padding: 1rem;
  border-radius: 0.5rem;
  margin-top: 1rem;
  font-weight: 500;
  text-align: center;
  display: none;
}

.message-error {
  background: #fee2e2;
  color: var(--error);
  border: 1px solid #fecaca;
}

.message-success {
  background: #d1fae5;
  color: var(--success);
  border: 1px solid #a7f3d0;
}

/* Animation */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fadeIn {
  animation: fadeIn 0.5s ease forwards;
}

/* Progress Bar */
.progress-container {
  margin: 1.5rem 0;
}

.progress-bar {
  height: 8px;
  background: #e2e8f0;
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--primary);
  width: 0%;
  transition: width 0.5s ease;
}

.progress-text {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
  font-size: 0.9rem;
  color: var(--text-light);
}

/* Responsive */
@media (max-width: 768px) {
  .quiz-header {
    padding: 1rem;
  }
  
  .header-title {
    font-size: 1.8rem;
  }
  
  .header-subtitle {
    font-size: 1rem;
  }
  
  .quiz-container {
    padding: 1.5rem;
    margin: 1rem;
  }
  
  .buttons-container {
    flex-direction: column;
  }
  
  .btn {
    width: 100%;
  }
}
</style>
</head>
<body>

<header class="quiz-header">
    <div class="header-content">
        <img src="Tklesson1.png" alt="Tklesson Logo" class="header-logo">
        <h1 class="header-title">AP Biology – Cellular & Molecular Biology</h1>
        <p class="header-subtitle">20 Challenging Questions – Exam Level Difficulty</p>
    </div>
</header>

<div class="container">
    <div class="quiz-container">
        <div id="startScreen" style="text-align: center; padding: 2rem;">
            <h2 style="color: var(--primary); margin-bottom: 1rem;">AP Biology Challenge Quiz</h2>
            <p style="font-size: 1.1rem; margin-bottom: 1.5rem; line-height: 1.6;">
                This quiz contains 20 challenging AP-level questions covering cellular and molecular biology. 
                Questions are designed to test deep understanding and application of concepts.
            </p>
            <div style="background: #f0f8ff; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 2rem;">
                <h3 style="color: var(--primary-dark); margin-bottom: 0.75rem;">Topics Covered:</h3>
                <ul style="text-align: left; display: inline-block; margin: 0 auto;">
                    <li>Cellular Energetics</li>
                    <li>Cell Communication</li>
                    <li>Gene Expression & Regulation</li>
                    <li>Cell Cycle & Mitosis</li>
                    <li>Photosynthesis & Cellular Respiration</li>
                </ul>
            </div>
            <button id="startBtn" class="btn btn-primary" style="font-size: 1.2rem; padding: 1rem 2rem;">Begin AP Biology Quiz</button>
        </div>

        <div id="quizContent" style="display: none;">
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
                <div class="progress-text">
                    <span>Question: <span id="currentQuestion">1</span>/20</span>
                    <span>Time: <span id="quizTimer">25:00</span></span>
                </div>
            </div>
            
            <div id="questions-container" class="questions-container"></div>

            <div class="buttons-container">
                <button id="prevBtn" class="btn btn-secondary">Previous</button>
                <button id="nextBtn" class="btn btn-primary">Next Question</button>
                <button id="submitBtn" class="btn btn-success" style="display: none;">Submit Quiz</button>
                <button id="restartBtn" class="btn btn-secondary">Restart Quiz</button>
            </div>

            <div id="results-container" class="results-container"></div>
            <div id="message" class="message"></div>
        </div>
    </div>
</div>

<script>
// ============================================================
// AP Biology Challenging MCQ Quiz (20 Questions)
// ============================================================

const questions = [
  {
    q: "A researcher observes that a certain protein's activity increases when cAMP levels rise, but not when cGMP levels rise. Which signaling mechanism is most likely involved?",
    options: [
      "PKA activation through allosteric regulation",
      "Direct cAMP binding to the enzyme's active site",
      "G-protein coupled receptor with adenylate cyclase",
      "cAMP-gated ion channel opening"
    ],
    answer: 0,
    explanation: "cAMP typically activates Protein Kinase A (PKA), which phosphorylates target proteins. The cAMP binds to regulatory subunits of PKA, causing conformational change that releases catalytic subunits. This is a classic example of second messenger signaling in pathways like glycogen metabolism and hormone response."
  },
  {
    q: "In oxidative phosphorylation, cyanide inhibits cytochrome c oxidase. What immediate cellular effect would this cause?",
    options: [
      "Decreased ATP production",
      "Increased lactate fermentation",
      "Accumulation of NADH",
      "All of the above"
    ],
    answer: 3,
    explanation: "Cyanide blocks electron transport at complex IV, stopping the entire ETC. This prevents: 1) ATP synthesis (oxidative phosphorylation), 2) NAD⁺ regeneration (NADH accumulates), 3) Forces cells to anaerobic metabolism (lactate fermentation increases). Cyanide poisoning is fatal because cells can't produce sufficient ATP aerobically."
  },
  {
    q: "Which DNA mutation would likely be most harmful to a protein's function?",
    options: [
      "Frameshift near the 5' end",
      "Silent mutation in the third position",
      "Missense conservative substitution",
      "Deletion in an intron"
    ],
    answer: 0,
    explanation: "Frameshift mutations alter the reading frame, changing all downstream amino acids. Near the 5' end affects most of the protein. Conservative substitutions may not change function, silent mutations have no effect, and intron deletions may not affect the mature mRNA if splicing signals remain intact."
  },
  {
    q: "During meiosis, crossing over occurs in:",
    options: [
      "Prophase I",
      "Metaphase I",
      "Anaphase I",
      "Prophase II"
    ],
    answer: 0,
    explanation: "Crossing over occurs during prophase I of meiosis when homologous chromosomes pair up (synapsis) and exchange genetic material. This recombination increases genetic diversity. It doesn't occur in mitosis or meiosis II, which involve sister chromatid separation rather than homologous chromosome interaction."
  },
  {
    q: "The sodium-potassium pump moves ions:",
    options: [
      "Against their gradients using ATP",
      "Down their gradients passively",
      "Using co-transport with glucose",
      "Only during action potentials"
    ],
    answer: 0,
    explanation: "The Na⁺/K⁺ ATPase is a primary active transport pump that moves 3 Na⁺ out and 2 K⁺ in per ATP hydrolyzed, against their concentration gradients. This maintains resting membrane potential and creates gradients used for secondary active transport, not to be confused with voltage-gated channels during action potentials."
  },
  {
    q: "Rubisco's oxygenase activity results in:",
    options: [
      "Photorespiration",
      "Enhanced carbon fixation",
      "Reduced water loss",
      "Increased ATP synthesis"
    ],
    answer: 0,
    explanation: "Rubisco can fix either CO₂ (carboxylase activity) or O₂ (oxygenase activity). Oxygenase activity leads to photorespiration, a wasteful process that consumes energy and releases fixed carbon. C₄ and CAM plants have evolved mechanisms to minimize this by concentrating CO₂ around rubisco."
  },
  {
    q: "A hypertonic solution causes animal cells to:",
    options: [
      "Shrink",
      "Swell",
      "Lysе",
      "Divide"
    ],
    answer: 0,
    explanation: "In hypertonic solutions, water moves out of cells by osmosis, causing shrinkage (crenation). Plant cells undergo plasmolysis. In hypotonic solutions, animal cells swell and may lyse, while plant cells become turgid due to cell wall pressure."
  },
  {
    q: "Which directly provides energy for ATP synthase rotation?",
    options: [
      "Proton gradient",
      "Electron flow",
      "NADH oxidation",
      "Oxygen reduction"
    ],
    answer: 0,
    explanation: "ATP synthase is driven by the proton-motive force (Δp), which has two components: the proton gradient (ΔpH) and membrane potential (Δψ). Protons flowing down their gradient through the F₀ subunit cause rotation, driving ATP synthesis in the F₁ subunit—chemiosmosis as proposed by Peter Mitchell."
  },
  {
    q: "DNA replication is semiconservative because:",
    options: [
      "Each daughter molecule has one old strand",
      "It requires constant energy input",
      "It uses both DNA and RNA",
      "It occurs only in S phase"
    ],
    answer: 0,
    explanation: "The Meselson-Stahl experiment proved semiconservative replication: each daughter DNA molecule contains one original (parental) strand and one newly synthesized strand. Conservative replication would produce one old and one completely new molecule; dispersive would mix fragments."
  },
  {
    q: "Which enzyme adds RNA primers during replication?",
    options: [
      "Primase",
      "Ligase",
      "Polymerase I",
      "Helicase"
    ],
    answer: 0,
    explanation: "Primase synthesizes short RNA primers that provide a 3'-OH group for DNA polymerase to begin synthesis. DNA pol III extends from primers on leading strand and Okazaki fragments. DNA pol I removes RNA primers and replaces with DNA. Ligase seals nicks."
  },
  {
    q: "The lac operon is induced when:",
    options: [
      "Lactose is present, glucose absent",
      "Lactose absent, glucose present",
      "Both sugars present",
      "Neither sugar present"
    ],
    answer: 0,
    explanation: "Lac operon has dual control: 1) Lactose inactivates repressor (induction), 2) Low glucose increases cAMP, activating CAP (catabolite activation). Maximum expression occurs with lactose present (inducer) and glucose absent (no catabolite repression)."
  },
  {
    q: "Mitochondrial DNA is inherited:",
    options: [
      "Maternally",
      "Paternally",
      "Both parents equally",
      "Randomly"
    ],
    answer: 0,
    explanation: "Mitochondria (and chloroplasts) show maternal inheritance in most animals and plants. The egg contributes cytoplasm including organelles, while sperm contributes primarily nuclear DNA. This allows tracing maternal lineages and explains why mitochondrial diseases pass from mother to all children."
  },
  {
    q: "Which best describes competitive inhibition?",
    options: [
      "Binds active site",
      "Changes enzyme shape",
      "Requires allosteric site",
      "Irreversible binding"
    ],
    answer: 0,
    explanation: "Competitive inhibitors resemble substrates and bind the active site, blocking substrate access. They increase apparent Kₘ without affecting Vₘₐₓ (can be overcome by high substrate). Noncompetitive inhibitors bind elsewhere (allosteric), changing enzyme conformation and reducing Vₘₐₓ."
  },
  {
    q: "Apoptosis differs from necrosis in that apoptosis:",
    options: [
      "Is programmed cell death",
      "Causes inflammation",
      "Results from injury",
      "Lacks membrane blebbing"
    ],
    answer: 0,
    explanation: "Apoptosis is programmed, controlled cell death important in development and homeostasis. Cells shrink, chromatin condenses, and membrane blebs form apoptotic bodies phagocytosed without inflammation. Necrosis is traumatic cell death from injury causing inflammation."
  },
  {
    q: "PCR requires all EXCEPT:",
    options: [
      "DNA ligase",
      "DNA polymerase",
      "Primers",
      "Nucleotides"
    ],
    answer: 0,
    explanation: "PCR requires: 1) Thermostable DNA polymerase (Taq), 2) DNA template, 3) Primers flanking target, 4) dNTPs, 5) Buffer with Mg²⁺. Ligase is not needed; DNA is synthesized de novo. PCR amplifies DNA exponentially through denaturation, annealing, extension cycles."
  },
  {
    q: "The genetic code is:",
    options: [
      "Universal",
      "Different in mitochondria",
      "Species-specific",
      "Non-overlapping"
    ],
    answer: 3,
    explanation: "The genetic code is nearly universal (same codons specify same amino acids across most organisms), degenerate (multiple codons per amino acid), non-overlapping (each nucleotide in one codon only), and without gaps. Mitochondria have minor variations (e.g., AUA = Met not Ile)."
  },
  {
    q: "Which phase produces the most ATP per glucose?",
    options: [
      "Oxidative phosphorylation",
      "Glycolysis",
      "Krebs cycle",
      "Fermentation"
    ],
    answer: 0,
    explanation: "Complete glucose oxidation yields ~30-32 ATP: 2 from glycolysis, 2 from Krebs cycle, 26-28 from oxidative phosphorylation (ETC + chemiosmosis). Efficiency is ~34% of energy in glucose. Fermentation yields only 2 ATP net from substrate-level phosphorylation."
  },
  {
    q: "Restriction enzymes cut DNA at:",
    options: [
      "Specific sequences",
      "Random sites",
      "AT-rich regions",
      "Replication origins"
    ],
    answer: 0,
    explanation: "Restriction endonucleases recognize and cut specific palindromic DNA sequences (4-8 bp). Type II are used in molecular biology (e.g., EcoRI cuts GAATTC). They produce sticky or blunt ends for DNA cloning. Bacterial defense against bacteriophages."
  },
  {
    q: "Which directly proves evolution?",
    options: [
      "Fossil record",
      "Comparative anatomy",
      "Molecular homology",
      "All provide evidence"
    ],
    answer: 3,
    explanation: "Evolution is supported by multiple independent lines of evidence: 1) Fossil succession shows changes over time, 2) Comparative anatomy reveals homologous structures, 3) Molecular biology shows genetic similarities, 4) Biogeography shows distribution patterns, 5) Observations of natural selection and speciation."
  },
  {
    q: "HIV reverse transcriptase:",
    options: [
      "Makes DNA from RNA",
      "Proofreads carefully",
      "Copies host DNA",
      "Requires primers"
    ],
    answer: 0,
    explanation: "Retroviruses like HIV carry reverse transcriptase that synthesizes DNA from viral RNA genome. Error-prone (lacks proofreading) → high mutation rate → antigenic variation → vaccine difficulty. Integrase inserts DNA into host genome. RNA polymerase II transcribes viral genes."
  }
];

// DOM elements
const questionsContainer = document.getElementById('questions-container');
const submitBtn = document.getElementById('submitBtn');
const restartBtn = document.getElementById('restartBtn');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const resultsContainer = document.getElementById('results-container');
const messageEl = document.getElementById('message');
const startBtn = document.getElementById('startBtn');
const startScreen = document.getElementById('startScreen');
const quizContent = document.getElementById('quizContent');
const progressFill = document.getElementById('progressFill');
const currentQuestionEl = document.getElementById('currentQuestion');
const quizTimer = document.getElementById('quizTimer');

// Quiz state
let currentQuestionIndex = 0;
let userAnswers = new Array(questions.length).fill(-1);
let quizSubmitted = false;
let timeLeft = 1500; // 25 minutes in seconds
let timerInterval;

// Shuffle questions and options
function shuffleQuestions() {
    const shuffledQuestions = questions.map(q => {
        const indices = [0, 1, 2, 3];
        // Fisher-Yates shuffle
        for (let i = indices.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [indices[i], indices[j]] = [indices[j], indices[i]];
        }
        
        return {
            ...q,
            shuffledOptions: indices.map(i => q.options[i]),
            correctAnswerIndex: indices.indexOf(q.answer)
        };
    });
    
    // Shuffle the questions themselves
    for (let i = shuffledQuestions.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffledQuestions[i], shuffledQuestions[j]] = [shuffledQuestions[j], shuffledQuestions[i]];
    }
    
    return shuffledQuestions;
}

let currentQuestions = [];

// Initialize quiz
function initQuiz() {
    currentQuestions = shuffleQuestions();
    currentQuestionIndex = 0;
    quizSubmitted = false;
    userAnswers = new Array(currentQuestions.length).fill(-1);
    timeLeft = 1500;
    
    resultsContainer.style.display = 'none';
    messageEl.style.display = 'none';
    submitBtn.style.display = 'none';
    prevBtn.style.display = 'inline-block';
    nextBtn.style.display = 'inline-block';
    
    updateProgressBar();
    startTimer();
    renderQuestion();
}

// Start timer
function startTimer() {
    clearInterval(timerInterval);
    updateTimerDisplay();
    
    timerInterval = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            if (!quizSubmitted) {
                showMessage("Time's up! Submitting your quiz...", 'error');
                setTimeout(checkAnswers, 1000);
            }
        }
    }, 1000);
}

// Update timer display
function updateTimerDisplay() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    quizTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    
    // Color code for last 5 minutes
    if (timeLeft <= 300) {
        quizTimer.style.color = 'var(--error)';
        quizTimer.style.fontWeight = '600';
    }
}

// Update progress bar
function updateProgressBar() {
    const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
    progressFill.style.width = `${progress}%`;
    currentQuestionEl.textContent = currentQuestionIndex + 1;
}

// Render current question
function renderQuestion() {
    if (!currentQuestions.length) return;
    
    const question = currentQuestions[currentQuestionIndex];
    
    let optionsHTML = '';
    question.shuffledOptions.forEach((option, optionIndex) => {
        const isSelected = userAnswers[currentQuestionIndex] === optionIndex;
        const optionId = `q${currentQuestionIndex}_${optionIndex}`;
        const labels = ['A', 'B', 'C', 'D'];
        
        optionsHTML += `
            <div class="option ${isSelected ? 'selected' : ''}" data-index="${currentQuestionIndex}" data-option="${optionIndex}">
                <div class="option-label">${labels[optionIndex]}.</div>
                <div class="option-content">${option}</div>
                <input type="radio" id="${optionId}" name="q${currentQuestionIndex}" ${isSelected ? 'checked' : ''}>
            </div>
        `;
    });
    
    questionsContainer.innerHTML = `
        <div class="question-card animate-fadeIn">
            <div class="question-number">${currentQuestionIndex + 1}</div>
            <div class="question-text">${question.q}</div>
            <div class="options-container">${optionsHTML}</div>
        </div>
    `;
    
    // Update button states
    prevBtn.disabled = currentQuestionIndex === 0;
    nextBtn.textContent = currentQuestionIndex === currentQuestions.length - 1 ? 'Review Quiz' : 'Next Question';
    submitBtn.style.display = currentQuestionIndex === currentQuestions.length - 1 ? 'inline-block' : 'none';
    
    // Add event listeners to options
    document.querySelectorAll('.option').forEach(option => {
        option.addEventListener('click', function() {
            if (quizSubmitted) return;
            
            const questionIndex = parseInt(this.dataset.index);
            const optionIndex = parseInt(this.dataset.option);
            
            const questionOptions = document.querySelectorAll(`.option[data-index="${questionIndex}"]`);
            questionOptions.forEach(opt => opt.classList.remove('selected'));
            
            this.classList.add('selected');
            
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            
            userAnswers[questionIndex] = optionIndex;
            
            // Auto-advance on mobile or if setting enabled
            if (window.innerWidth < 768 && currentQuestionIndex < currentQuestions.length - 1) {
                setTimeout(() => nextQuestion(), 300);
            }
        });
    });
    
    updateProgressBar();
}

// Next question
function nextQuestion() {
    if (currentQuestionIndex < currentQuestions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
    } else {
        // At last question, scroll to top for review
        window.scrollTo({ top: 0, behavior: 'smooth' });
        showMessage("You've reached the end. Review your answers or submit.", 'success');
    }
}

// Previous question
function prevQuestion() {
    if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        renderQuestion();
    }
}

// Check answers
function checkAnswers() {
    const unanswered = userAnswers.filter(answer => answer === -1).length;
    
    if (unanswered > 0) {
        if (!confirm(`You have ${unanswered} unanswered questions. Submit anyway?`)) {
            return;
        }
    }
    
    clearInterval(timerInterval);
    
    let score = 0;
    let resultsHTML = '';
    
    currentQuestions.forEach((question, index) => {
        const userAnswerIndex = userAnswers[index];
        const isCorrect = userAnswerIndex === question.correctAnswerIndex;
        
        if (isCorrect) {
            score++;
        }
        
        const labels = ['A', 'B', 'C', 'D'];
        const userAnswer = userAnswerIndex === -1 ? 'Not answered' : 
            `${labels[userAnswerIndex]}: ${question.shuffledOptions[userAnswerIndex]}`;
        const correctAnswer = `${labels[question.correctAnswerIndex]}: ${question.shuffledOptions[question.correctAnswerIndex]}`;
        
        resultsHTML += `
            <div style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);">
                <div><strong>Question ${index + 1}:</strong> ${question.q}</div>
                <div style="margin-top: 0.5rem;"><strong>Your answer:</strong> ${userAnswer}</div>
                <div><strong>Correct answer:</strong> ${correctAnswer}</div>
                <div style="margin-top: 0.5rem; background: #f0f8ff; padding: 0.75rem; border-radius: 0.5rem; font-size: 0.9rem;">
                    <strong>Explanation:</strong> ${question.explanation}
                </div>
            </div>
        `;
    });
    
    const percentage = (score / currentQuestions.length) * 100;
    let grade = '';
    let feedback = '';
    
    if (percentage >= 90) {
        grade = '5 (Extremely well qualified)';
        feedback = 'Outstanding performance! You have excellent mastery of AP Biology concepts.';
    } else if (percentage >= 76) {
        grade = '4 (Well qualified)';
        feedback = 'Strong performance! You have a good grasp of most AP Biology topics.';
    } else if (percentage >= 60) {
        grade = '3 (Qualified)';
        feedback = 'Good work! You understand the fundamentals but should review some challenging areas.';
    } else if (percentage >= 45) {
        grade = '2 (Possibly qualified)';
        feedback = 'Needs improvement. Focus on cellular energetics, genetics, and molecular biology.';
    } else {
        grade = '1 (No recommendation)';
        feedback = 'Substantial review needed. Start with core concepts: cellular structure, metabolism, and basic genetics.';
    }
    
    resultsContainer.style.display = 'block';
    resultsContainer.innerHTML = `
        <div class="score-display">Score: ${score} / ${currentQuestions.length} (${percentage.toFixed(1)}%)</div>
        <div style="text-align: center; margin-bottom: 1.5rem; padding: 1rem; background: white; border-radius: 0.5rem; box-shadow: var(--shadow);">
            <div style="font-size: 1.2rem; color: var(--primary); margin-bottom: 0.5rem;">AP Score Equivalent: ${grade}</div>
            <div>${feedback}</div>
        </div>
        <h3 style="margin-bottom: 1rem; color: var(--primary);">Detailed Review:</h3>
        ${resultsHTML}
        <div style="text-align: center; margin-top: 1.5rem; font-size: 0.9rem; color: var(--text-light);">
            Use this review to identify areas for further study. Recommended resources: Campbell Biology, Khan Academy AP Biology, Bozeman Science videos.
        </div>
    `;
    
    // Scroll to results
    setTimeout(() => {
        resultsContainer.scrollIntoView({ behavior: 'smooth' });
    }, 500);
    
    quizSubmitted = true;
    submitBtn.style.display = 'none';
    prevBtn.style.display = 'none';
    nextBtn.style.display = 'none';
    
    showMessage(`Quiz submitted! Score: ${score}/${currentQuestions.length}`, 'success');
}

// Show message
function showMessage(text, type) {
    messageEl.textContent = text;
    messageEl.className = `message message-${type}`;
    messageEl.style.display = 'block';
    
    if (type !== 'error') {
        setTimeout(() => {
            messageEl.style.display = 'none';
        }, 4000);
    }
}

// Event listeners
startBtn.addEventListener('click', () => {
    startScreen.style.display = 'none';
    quizContent.style.display = 'block';
    initQuiz();
});

prevBtn.addEventListener('click', prevQuestion);
nextBtn.addEventListener('click', nextQuestion);
submitBtn.addEventListener('click', checkAnswers);

restartBtn.addEventListener('click', () => {
    if (confirm('Are you sure you want to restart? All progress will be lost.')) {
        initQuiz();
        showMessage('Quiz restarted. Good luck!', 'success');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
});

// Keyboard navigation
document.addEventListener('keydown', (e) => {
    if (!quizSubmitted) {
        if (e.key === 'ArrowLeft' || e.key === '1') {
            prevQuestion();
        } else if (e.key === 'ArrowRight' || e.key === '2') {
            nextQuestion();
        } else if (e.key >= 'a' && e.key <= 'd') {
            const optionIndex = e.key.charCodeAt(0) - 97;
            if (optionIndex >= 0 && optionIndex <= 3) {
                userAnswers[currentQuestionIndex] = optionIndex;
                renderQuestion();
            }
        } else if (e.key === 'Enter' && currentQuestionIndex === currentQuestions.length - 1) {
            checkAnswers();
        }
    }
});

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    quizContent.style.display = 'none';
    startScreen.style.display = 'block';
});
</script>

</body>
</html>
