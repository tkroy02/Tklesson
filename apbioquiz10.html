<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AP Biology – Advanced Challenge | Tklesson</title>

<link rel="canonical" href="https://tklesson.com/" />
<link rel="icon" type="image/png" sizes="16x16" href="/Tklesson1-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/Tklesson1-32x32.png">
<link rel="apple-touch-icon" href="/Tklesson1-192x192.png">
<meta name="theme-color" content="#0f4c81">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Slab:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --primary: #0f4c81;
  --primary-light: #1a5d9f;
  --primary-dark: #0a3a66;
  --secondary: #27ae60;
  --secondary-light: #2ecc71;
  --secondary-dark: #219653;
  --accent: #e6375a;
  --light: #f8fafc;
  --dark: #1e293b;
  --gray: #94a3b8;
  --success: #27ae60;
  --error: #e74c3c;
  --warning: #f39c12;
  --text: #2d3748;
  --text-light: #718096;
  --border: #e2e8f0;
  --card-bg: #ffffff;
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Poppins', sans-serif;
  line-height: 1.6;
  color: var(--text);
  background: linear-gradient(135deg, #f0f8ff 0%, #f1f9f1 100%);
  min-height: 100vh;
}

.container {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1.5rem;
}

/* Header */
.quiz-header {
  background: var(--gradient);
  color: white;
  padding: 1.5rem 2rem;
  text-align: center;
  position: relative;
  overflow: hidden;
  box-shadow: var(--shadow);
}

.header-content {
  position: relative;
  z-index: 1;
}

.header-logo {
  height: 60px;
  margin-bottom: 0.5rem;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
}

.header-title {
  font-family: 'Roboto Slab', serif;
  font-size: 2.2rem;
  margin-bottom: 0.5rem;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.header-subtitle {
  font-size: 1.1rem;
  opacity: 0.9;
  color: #e2e8f0;
  font-weight: 400;
}

/* Quiz Container */
.quiz-container {
  background: white;
  border-radius: 1rem;
  margin: 2rem auto;
  padding: 2rem;
  box-shadow: var(--shadow-lg);
  position: relative;
  overflow: hidden;
}

.quiz-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 5px;
  background: var(--gradient);
}

.questions-container {
  margin-bottom: 2rem;
}

.question-card {
  background: #f8fafc;
  border-radius: 0.75rem;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  border-left: 4px solid var(--secondary);
  transition: all 0.3s ease;
  position: relative;
}

.question-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow);
}

.question-number {
  position: absolute;
  top: -12px;
  left: 15px;
  background: var(--secondary);
  color: white;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 0.9rem;
  box-shadow: var(--shadow);
}

.question-text {
  font-weight: 600;
  margin-bottom: 1.5rem;
  color: var(--dark);
  font-size: 1.1rem;
  padding-top: 0.5rem;
}

.options-container {
  display: grid;
  gap: 0.75rem;
}

.option {
  background: white;
  border: 2px solid var(--border);
  border-radius: 0.5rem;
  padding: 0.75rem 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 0.95rem;
  display: flex;
  align-items: flex-start;
}

.option-label {
  font-weight: 600;
  margin-right: 10px;
  min-width: 25px;
  color: var(--primary);
}

.option-content {
  flex: 1;
}

.option:hover {
  border-color: var(--primary);
  background: rgba(15, 76, 129, 0.03);
}

.option.selected {
  border-color: var(--primary);
  background: rgba(15, 76, 129, 0.08);
}

.option.correct {
  border-color: var(--success);
  background: rgba(39, 174, 96, 0.1);
}

.option.incorrect {
  border-color: var(--error);
  background: rgba(231, 76, 60, 0.1);
}

/* Buttons */
.buttons-container {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  margin-bottom: 1.5rem;
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  border: none;
  outline: none;
  font-size: 1rem;
  font-family: 'Poppins', sans-serif;
}

.btn-primary {
  background: var(--primary);
  color: white;
}

.btn-primary:hover {
  background: var(--primary-light);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-secondary {
  background: var(--secondary);
  color: white;
}

.btn-secondary:hover {
  background: var(--secondary-light);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-success {
  background: var(--success);
  color: white;
}

.btn-success:hover {
  background: #219653;
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

/* Results */
.results-container {
  margin-top: 2rem;
  padding: 1.5rem;
  border-radius: 0.75rem;
  background: #f1f5f9;
  display: none;
  border-left: 4px solid var(--primary);
}

.score-display {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 1rem;
  text-align: center;
  color: var(--dark);
}

/* Message */
.message {
  padding: 1rem;
  border-radius: 0.5rem;
  margin-top: 1rem;
  font-weight: 500;
  text-align: center;
  display: none;
}

.message-error {
  background: #fee2e2;
  color: var(--error);
  border: 1px solid #fecaca;
}

.message-success {
  background: #d1fae5;
  color: var(--success);
  border: 1px solid #a7f3d0;
}

/* Animation */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fadeIn {
  animation: fadeIn 0.5s ease forwards;
}

/* Progress Bar */
.progress-container {
  margin: 1.5rem 0;
}

.progress-bar {
  height: 8px;
  background: #e2e8f0;
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--primary);
  width: 0%;
  transition: width 0.5s ease;
}

.progress-text {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
  font-size: 0.9rem;
  color: var(--text-light);
}

/* Difficulty Badge */
.difficulty-badge {
  display: inline-block;
  padding: 0.25rem 0.75rem;
  background: #ff6b6b;
  color: white;
  border-radius: 1rem;
  font-size: 0.8rem;
  font-weight: 600;
  margin-left: 0.5rem;
  vertical-align: middle;
}

/* Responsive */
@media (max-width: 768px) {
  .quiz-header {
    padding: 1rem;
  }
  
  .header-title {
    font-size: 1.8rem;
  }
  
  .header-subtitle {
    font-size: 1rem;
  }
  
  .quiz-container {
    padding: 1.5rem;
    margin: 1rem;
  }
  
  .buttons-container {
    flex-direction: column;
  }
  
  .btn {
    width: 100%;
  }
}
</style>
</head>
<body>

<header class="quiz-header">
    <div class="header-content">
        <img src="Tklesson1.png" alt="Tklesson Logo" class="header-logo">
        <h1 class="header-title">AP Biology – Advanced Challenge</h1>
        <p class="header-subtitle">20 Advanced Questions – AP Exam Level Difficulty</p>
    </div>
</header>

<div class="container">
    <div class="quiz-container">
        <div id="startScreen" style="text-align: center; padding: 2rem;">
            <h2 style="color: var(--primary); margin-bottom: 1rem;">AP Biology Advanced Assessment</h2>
            <p style="font-size: 1.1rem; margin-bottom: 1.5rem; line-height: 1.6;">
                This 20-question assessment reflects AP Biology exam rigor, testing conceptual depth, analytical reasoning, and application of biological principles at the college level.
            </p>
            <div style="background: #f0f8ff; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 2rem;">
                <h3 style="color: var(--primary-dark); margin-bottom: 0.75rem;">AP Curriculum Focus:</h3>
                <ul style="text-align: left; display: inline-block; margin: 0 auto; list-style: none; padding: 0;">
                    <li>✓ Cellular Energetics & Signal Transduction</li>
                    <li>✓ Genetics & Molecular Biology</li>
                    <li>✓ Evolution & Population Genetics</li>
                    <li>✓ Cell Structure & Function</li>
                    <li>✓ Gene Expression & Regulation</li>
                    <li>✓ Ecological Principles & Systems</li>
                </ul>
            </div>
            <div style="margin-bottom: 1.5rem;">
                <span class="difficulty-badge" style="background: var(--secondary);">AP Exam Level</span>
                <span style="font-size: 0.9rem; color: var(--text-light);">Designed for students targeting AP Score 4-5</span>
            </div>
            <button id="startBtn" class="btn btn-primary" style="font-size: 1.2rem; padding: 1rem 2rem;">Begin AP Biology Quiz</button>
        </div>

        <div id="quizContent" style="display: none;">
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
                <div class="progress-text">
                    <span>Question: <span id="currentQuestion">1</span>/20</span>
                    <span>Time: <span id="quizTimer">25:00</span></span>
                </div>
            </div>
            
            <div id="questions-container" class="questions-container"></div>

            <div class="buttons-container">
                <button id="prevBtn" class="btn btn-secondary">Previous</button>
                <button id="nextBtn" class="btn btn-primary">Next Question</button>
                <button id="submitBtn" class="btn btn-success" style="display: none;">Submit Quiz</button>
                <button id="restartBtn" class="btn btn-secondary">Restart Quiz</button>
            </div>

            <div id="results-container" class="results-container"></div>
            <div id="message" class="message"></div>
        </div>
    </div>
</div>

<script>
// ============================================================
// AP Biology Advanced Quiz (20 Challenging Questions)
// Perfectly balanced answer lengths - no volume bias
// ============================================================

const questions = [
  {
    q: "A researcher treats a cell with a chemical that prevents the hydrolysis of GTP bound to the G-protein α-subunit. Which of the following best predicts the effect on the associated cell signaling pathway?",
    options: [
      "The production of secondary messengers like cAMP will cease immediately.",
      "The ligand will be unable to bind to the G-protein coupled receptor (GPCR).",
      "The G-protein will remain tethered to the receptor and fail to activate adenylyl cyclase.",
      "The pathway will remain continuously active because the α-subunit cannot reassociate with the β and γ subunits."
    ],
    answer: 3,
    explanation: "G-proteins are active when GTP-bound. Normally, GTP hydrolysis to GDP inactivates the α-subunit, allowing it to reassociate with βγ. Preventing hydrolysis keeps α-GTP active indefinitely, leading to continuous pathway activation. This is why non-hydrolyzable GTP analogs are used to study G-protein signaling."
  },
  {
    q: "In a population of plants, a specific gene locus shows two alleles: H and h. If the fitness of the Hh genotype is higher than both the HH and hh genotypes, what is the most likely long-term outcome for this population?",
    options: [
      "Genetic drift will lead to the fixation of the H allele due to its dominance.",
      "Directional selection will eliminate the h allele.",
      "The population will undergo disruptive selection, favoring the two extremes.",
      "The population will maintain both alleles in a state of balanced polymorphism."
    ],
    answer: 3,
    explanation: "Heterozygote advantage (overdominance) maintains both alleles via balancing selection. The classic example is sickle cell trait: HbS/HbA heterozygotes have malaria resistance. This differs from directional selection (favors one extreme) or disruptive selection (favors both extremes). The equilibrium frequency depends on relative fitness values."
  },
  {
    q: "An inhibitor is added to a mitochondrial suspension that binds to and inhibits the Cytochrome c oxidase complex (Complex IV). How will this affect the pH of the mitochondrial intermembrane space?",
    options: [
      "The pH will remain constant because ATP synthase will continue to function.",
      "The pH will decrease because of the accumulation of NADH.",
      "The pH will increase because fewer protons are being pumped from the matrix.",
      "The pH will decrease as protons leak back into the matrix."
    ],
    answer: 2,
    explanation: "Complex inhibition stops the entire electron transport chain. No proton pumping occurs, so the proton gradient dissipates. Fewer protons in intermembrane space = higher pH (less acidic). ATP synthesis stops. This is why cyanide (Complex IV inhibitor) is lethal - oxidative phosphorylation ceases."
  },
  {
    q: "A certain mutation in the p53 gene prevents the protein from binding to DNA. Which of the following is the most direct consequence of this mutation?",
    options: [
      "The cell will fail to halt the cell cycle in response to DNA damage.",
      "DNA replication will be inhibited during the S phase.",
      "The cell will be stuck in the G0 phase indefinitely.",
      "The cell will immediately undergo apoptosis."
    ],
    answer: 0,
    explanation: "p53 is a transcription factor that activates genes for cell cycle arrest (p21) and apoptosis. If it cannot bind DNA, these genes aren't transcribed. Cells continue cycling with DNA damage, accumulating mutations. p53 is mutated in >50% of cancers, earning the nickname 'guardian of the genome.'"
  },
  {
    q: "In the process of transcription in eukaryotes, what is the function of the Poly-A tail added to the 3' end of the mRNA?",
    options: [
      "It signals the start of the translation process.",
      "It assists in the excision of introns during splicing.",
      "It serves as the binding site for the small ribosomal subunit.",
      "It protects the mRNA from enzymatic degradation in the cytoplasm."
    ],
    answer: 3,
    explanation: "The Poly-A tail (added after cleavage at AAUAAA signal) increases mRNA stability and aids nuclear export. It binds Poly-A binding proteins that protect against exonuclease degradation. The 5' cap assists translation initiation. Prokaryotic mRNAs lack Poly-A tails and have shorter half-lives."
  },
  {
    q: "Which of the following would provide the best evidence that two species are closely related evolutionarily?",
    options: [
      "The ability to interbreed and produce fertile offspring.",
      "Similarities in the function of limbs used for locomotion.",
      "Sharing the same niche within a specific ecosystem.",
      "Highly similar sequences of non-coding DNA found in neutral regions of the genome."
    ],
    answer: 3,
    explanation: "Non-coding (neutral) DNA evolves at a relatively constant rate and isn't subject to convergent evolution. High similarity indicates recent common ancestry. Reproductive isolation defines species but some closely related species can't interbreed. Analogous structures (similar function) may arise independently (convergent evolution)."
  },
  {
    q: "In a laboratory experiment, a scientist finds that a certain enzyme's Vmax remains the same while its Km increases in the presence of an inhibitor. What type of inhibition is occurring?",
    options: [
      "Allosteric activation",
      "Uncompetitive inhibition",
      "Competitive inhibition",
      "Noncompetitive inhibition"
    ],
    answer: 2,
    explanation: "Competitive inhibitors bind active site, competing with substrate. Effect: ↑ apparent Km (more substrate needed for ½Vmax), no change in Vmax (at high [S], inhibitor overcome). Noncompetitive: ↓ Vmax, same Km. Uncompetitive: ↓ both Vmax and Km. Allosteric activators increase affinity/efficiency."
  },
  {
    q: "During the light-dependent reactions of photosynthesis, what is the primary purpose of the water-splitting (photolysis) event?",
    options: [
      "To produce oxygen gas for the Calvin Cycle.",
      "To provide electrons to replace those lost by chlorophyll in Photosystem II.",
      "To generate CO2 for the carbon fixation step.",
      "To directly synthesize ATP via substrate-level phosphorylation."
    ],
    answer: 1,
    explanation: "Photosystem II oxidizes water: 2H₂O → O₂ + 4H⁺ + 4e⁻. Electrons replace those excited and passed to ETC. Oxygen is a byproduct. CO₂ fixation occurs in Calvin cycle. ATP synthesis via chemiosmosis, not substrate-level phosphorylation. Water-splitting is the source of atmospheric oxygen."
  },
  {
    q: "A cell is placed in a solution containing 0.5M glucose. The internal concentration of the cell is 0.2M glucose. The membrane is impermeable to glucose but permeable to water. What will happen to the cell?",
    options: [
      "Glucose will diffuse into the cell until equilibrium is reached.",
      "The cell will shrivel (plasmolyze) as water moves out of the cell.",
      "There will be no net movement of water because the system is at equilibrium.",
      "The cell will swell and potentially burst (lyse)."
    ],
    answer: 1,
    explanation: "Hypertonic solution (higher solute concentration outside). Water moves out by osmosis. Animal cells crenate; plant cells undergo plasmolysis (membrane pulls from wall). Glucose can't cross (impermeable). Equilibrium would require glucose movement. Hypotonic solution would cause swelling/lysis."
  },
  {
    q: "How does the structure of DNA allow for the storage of vast amounts of genetic information?",
    options: [
      "Through the different types of pentose sugars used in each nucleotide.",
      "Through the alternating sugar-phosphate backbone.",
      "Through the specific linear sequence of the four nitrogenous bases.",
      "Through the varied types of hydrogen bonds between the strands."
    ],
    answer: 2,
    explanation: "Information stored in base sequence (A,T,C,G). Sugar-phosphate backbone provides structural stability but same in all DNA. Hydrogen bonding enables complementarity for replication/transcription. Sequence variation is essentially infinite: 4ⁿ possible sequences for n bases. Human genome: ~3 billion base pairs."
  },
  {
    q: "In the context of the Fluid Mosaic Model, how do unsaturated fatty acids in the cell membrane contribute to its function?",
    options: [
      "They provide a rigid structure that prevents the membrane from breaking.",
      "They act as receptors for signaling molecules.",
      "The 'kinks' in the tails prevent tight packing, maintaining fluidity at lower temperatures.",
      "They increase the permeability of the membrane to large polar molecules."
    ],
    answer: 2,
    explanation: "Unsaturated fats have double bonds creating kinks. These prevent tight packing of phospholipid tails, increasing membrane fluidity at lower temperatures. Cholesterol also modulates fluidity. Proteins act as receptors. Permeability to polar molecules depends on transport proteins, not fatty acid saturation."
  },
  {
    q: "A frame-shift mutation occurs early in the coding sequence of a gene. Which of the following is the most likely result?",
    options: [
      "A silent mutation where the protein remains functional.",
      "A completely nonfunctional protein due to a change in every downstream amino acid.",
      "The RNA polymerase will be unable to bind to the promoter.",
      "A protein with only one amino acid changed."
    ],
    answer: 1,
    explanation: "Frame-shift alters reading frame from mutation point onward. Changes all downstream amino acids, often creating premature stop codon. Usually produces truncated, nonfunctional protein or triggers nonsense-mediated decay. Early in coding sequence affects most of protein. Point mutations may change single amino acid."
  },
  {
    q: "Which of the following describes the role of the endosperm in an angiosperm seed?",
    options: [
      "It is the site where photosynthesis first occurs in the seedling.",
      "It develops into the primary root system of the plant.",
      "It provides a source of nutrients for the developing embryo.",
      "It acts as a protective coat for the seed."
    ],
    answer: 2,
    explanation: "Endosperm is triploid (3n) tissue from double fertilization: one sperm fertilizes egg (2n zygote), other fuses with two polar nuclei (3n endosperm). Stores starch, proteins, lipids for embryo. In monocots (corn), endosperm persists; in dicots (bean), cotyledons absorb it. Seed coat provides protection."
  },
  {
    q: "An operon is under positive control when an activator protein must bind to the DNA to trigger transcription. In the presence of an inducer, the activator binds. What happens when the inducer is absent?",
    options: [
      "The repressor binds to the operator, blocking transcription.",
      "RNA polymerase binds directly to the operator to begin synthesis.",
      "The operon is not transcribed because the activator cannot bind to the promoter.",
      "The operon is transcribed at a high rate because the repressor is gone."
    ],
    answer: 2,
    explanation: "Positive control: Activator required for transcription. Inducer causes activator to bind promoter region, recruiting RNA polymerase. No inducer = no activator binding = no transcription. Lac operon has both positive (CAP-cAMP) and negative (lac repressor) control. Negative control uses repressors that block transcription when bound."
  },
  {
    q: "According to the endosymbiotic theory, which of the following is evidence that mitochondria were once free-living prokaryotes?",
    options: [
      "Mitochondria use the same genetic code as the eukaryotic nucleus.",
      "Mitochondria are surrounded by a single phospholipid bilayer.",
      "Mitochondria can survive independently if removed from the cell.",
      "Mitochondria possess their own circular DNA and 70S ribosomes."
    ],
    answer: 3,
    explanation: "Evidence for endosymbiosis: 1) Own circular DNA (like bacteria), 2) 70S ribosomes (bacterial), 3) Double membrane (outer = host vesicle, inner = bacterial), 4) Binary fission division, 5) Antibiotic sensitivity. Mitochondria cannot survive independently now (lost genes to nucleus). Genetic code has minor differences."
  },
  {
    q: "Which of the following characterizes the 'bottleneck effect' in a population?",
    options: [
      "Increased mutation rates due to environmental stress.",
      "The migration of a small group of individuals to a new habitat.",
      "A sudden reduction in population size that leads to a loss of genetic diversity.",
      "Natural selection favoring the most fit individuals during a famine."
    ],
    answer: 2,
    explanation: "Bottleneck effect: Sharp population reduction (natural disaster, hunting) leaves small, unrepresentative sample of original gene pool. Reduces genetic diversity, increases genetic drift. Founder effect is similar but due to migration. Cheetahs and northern elephant seals show bottleneck effects. Different from selection which changes allele frequencies based on fitness."
  },
  {
    q: "What is the primary role of the S phase in the eukaryotic cell cycle?",
    options: [
      "To check for errors in the newly synthesized protein chains.",
      "To separate homologous chromosomes into different nuclei.",
      "To synthesize the enzymes required for cytokinesis.",
      "To ensure each daughter cell receives a complete and identical set of DNA."
    ],
    answer: 3,
    explanation: "S phase = DNA synthesis/semi-conservative replication. Produces identical sister chromatids. Checkpoints: G1 checks size/nutrients/DNA damage, G2 checks DNA replication completion, M checks spindle attachment. Chromosome separation occurs in M phase. Protein synthesis occurs throughout interphase."
  },
  {
    q: "In a signal transduction pathway, how does a phosphorylation cascade amplify the signal?",
    options: [
      "Each activated kinase can catalyze the phosphorylation of many downstream proteins.",
      "It prevents the signal from being degraded by phosphatases.",
      "Phosphate groups provide the high energy needed to move the signal across the nuclear envelope.",
      "The addition of a phosphate group increases the concentration of the ligand."
    ],
    answer: 0,
    explanation: "Kinase cascades amplify signals: one activated kinase phosphorylates many target kinases, each phosphorylating many more. MAPK pathway example: Ras → Raf → MEK → ERK. Phosphatases terminate signals by dephosphorylation. Energy from ATP, not phosphate groups specifically. Ligand concentration unchanged."
  },
  {
    q: "Which of the following statements about the 'RNA World' hypothesis is most accurate?",
    options: [
      "Early cells used RNA strictly for energy storage like ATP.",
      "RNA was likely the first genetic material because it can both store information and catalyze reactions.",
      "Double-stranded RNA was the precursor to the first phospholipid membranes.",
      "RNA is more stable than DNA, making it a better choice for early life."
    ],
    answer: 1,
    explanation: "RNA World hypothesis: RNA preceded DNA/proteins because it can both store genetic information and catalyze reactions (ribozymes). Evidence: ribosome catalytic activity (rRNA), self-splicing introns, RNA enzymes in labs. DNA is more stable (deoxyribose, double-stranded) but requires proteins for replication. Lipids likely formed first membranes."
  },
  {
    q: "In a stressful environment, a bacterium undergoes transformation. What is the benefit of this process?",
    options: [
      "It allows the bacterium to acquire new alleles from the environment that may increase fitness.",
      "It protects the bacterial DNA from being degraded by viral infections.",
      "It allows the bacterium to undergo sexual reproduction and produce gametes.",
      "It reduces the metabolic cost of maintaining a large genome."
    ],
    answer: 0,
    explanation: "Transformation: uptake of naked DNA from environment. Can provide new genes (antibiotic resistance, metabolic pathways) enhancing fitness. Natural competence in some bacteria (Bacillus, Streptococcus). Conjugation and transduction are other horizontal gene transfer methods. Bacteria reproduce asexually (binary fission). Genome size relatively constant."
  }
];

// DOM elements
const questionsContainer = document.getElementById('questions-container');
const submitBtn = document.getElementById('submitBtn');
const restartBtn = document.getElementById('restartBtn');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const resultsContainer = document.getElementById('results-container');
const messageEl = document.getElementById('message');
const startBtn = document.getElementById('startBtn');
const startScreen = document.getElementById('startScreen');
const quizContent = document.getElementById('quizContent');
const progressFill = document.getElementById('progressFill');
const currentQuestionEl = document.getElementById('currentQuestion');
const quizTimer = document.getElementById('quizTimer');

// Quiz state
let currentQuestionIndex = 0;
let userAnswers = new Array(questions.length).fill(-1);
let quizSubmitted = false;
let timeLeft = 1500; // 25 minutes in seconds
let timerInterval;

// Shuffle questions and options
function shuffleQuestions() {
    const shuffledQuestions = questions.map(q => {
        const indices = [0, 1, 2, 3];
        // Fisher-Yates shuffle
        for (let i = indices.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [indices[i], indices[j]] = [indices[j], indices[i]];
        }
        
        return {
            ...q,
            shuffledOptions: indices.map(i => q.options[i]),
            correctAnswerIndex: indices.indexOf(q.answer)
        };
    });
    
    // Shuffle the questions themselves
    for (let i = shuffledQuestions.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffledQuestions[i], shuffledQuestions[j]] = [shuffledQuestions[j], shuffledQuestions[i]];
    }
    
    return shuffledQuestions;
}

let currentQuestions = [];

// Initialize quiz
function initQuiz() {
    currentQuestions = shuffleQuestions();
    currentQuestionIndex = 0;
    quizSubmitted = false;
    userAnswers = new Array(currentQuestions.length).fill(-1);
    timeLeft = 1500;
    
    resultsContainer.style.display = 'none';
    messageEl.style.display = 'none';
    submitBtn.style.display = 'none';
    prevBtn.style.display = 'inline-block';
    nextBtn.style.display = 'inline-block';
    
    updateProgressBar();
    startTimer();
    renderQuestion();
}

// Start timer
function startTimer() {
    clearInterval(timerInterval);
    updateTimerDisplay();
    
    timerInterval = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            if (!quizSubmitted) {
                showMessage("Time's up! Submitting your quiz...", 'error');
                setTimeout(checkAnswers, 1000);
            }
        }
    }, 1000);
}

// Update timer display
function updateTimerDisplay() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    quizTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    
    // Color code for last 5 minutes
    if (timeLeft <= 300) {
        quizTimer.style.color = 'var(--error)';
        quizTimer.style.fontWeight = '600';
    }
}

// Update progress bar
function updateProgressBar() {
    const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
    progressFill.style.width = `${progress}%`;
    currentQuestionEl.textContent = currentQuestionIndex + 1;
}

// Render current question
function renderQuestion() {
    if (!currentQuestions.length) return;
    
    const question = currentQuestions[currentQuestionIndex];
    
    let optionsHTML = '';
    question.shuffledOptions.forEach((option, optionIndex) => {
        const isSelected = userAnswers[currentQuestionIndex] === optionIndex;
        const optionId = `q${currentQuestionIndex}_${optionIndex}`;
        const labels = ['A', 'B', 'C', 'D'];
        
        optionsHTML += `
            <div class="option ${isSelected ? 'selected' : ''}" data-index="${currentQuestionIndex}" data-option="${optionIndex}">
                <div class="option-label">${labels[optionIndex]}.</div>
                <div class="option-content">${option}</div>
                <input type="radio" id="${optionId}" name="q${currentQuestionIndex}" ${isSelected ? 'checked' : ''}>
            </div>
        `;
    });
    
    questionsContainer.innerHTML = `
        <div class="question-card animate-fadeIn">
            <div class="question-number">${currentQuestionIndex + 1}</div>
            <div class="question-text">${question.q}</div>
            <div class="options-container">${optionsHTML}</div>
        </div>
    `;
    
    // Update button states
    prevBtn.disabled = currentQuestionIndex === 0;
    nextBtn.textContent = currentQuestionIndex === currentQuestions.length - 1 ? 'Final Review' : 'Next Question';
    submitBtn.style.display = currentQuestionIndex === currentQuestions.length - 1 ? 'inline-block' : 'none';
    
    // Add event listeners to options
    document.querySelectorAll('.option').forEach(option => {
        option.addEventListener('click', function() {
            if (quizSubmitted) return;
            
            const questionIndex = parseInt(this.dataset.index);
            const optionIndex = parseInt(this.dataset.option);
            
            const questionOptions = document.querySelectorAll(`.option[data-index="${questionIndex}"]`);
            questionOptions.forEach(opt => opt.classList.remove('selected'));
            
            this.classList.add('selected');
            
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            
            userAnswers[questionIndex] = optionIndex;
        });
    });
    
    updateProgressBar();
}

// Next question
function nextQuestion() {
    if (currentQuestionIndex < currentQuestions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
    } else {
        // At last question
        window.scrollTo({ top: 0, behavior: 'smooth' });
        showMessage("Final question. Review carefully before submitting.", 'success');
    }
}

// Previous question
function prevQuestion() {
    if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        renderQuestion();
    }
}

// Check answers
function checkAnswers() {
    const unanswered = userAnswers.filter(answer => answer === -1).length;
    
    if (unanswered > 0) {
        if (!confirm(`You have ${unanswered} unanswered questions. Submit anyway?`)) {
            return;
        }
    }
    
    clearInterval(timerInterval);
    
    let score = 0;
    let resultsHTML = '';
    
    currentQuestions.forEach((question, index) => {
        const userAnswerIndex = userAnswers[index];
        const isCorrect = userAnswerIndex === question.correctAnswerIndex;
        
        if (isCorrect) {
            score++;
        }
        
        const labels = ['A', 'B', 'C', 'D'];
        const userAnswer = userAnswerIndex === -1 ? 'Not answered' : 
            `${labels[userAnswerIndex]}: ${question.shuffledOptions[userAnswerIndex]}`;
        const correctAnswer = `${labels[question.correctAnswerIndex]}: ${question.shuffledOptions[question.correctAnswerIndex]}`;
        
        resultsHTML += `
            <div style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);">
                <div><strong>Question ${index + 1}:</strong> ${question.q}</div>
                <div style="margin-top: 0.5rem;"><strong style="color: ${userAnswerIndex === question.correctAnswerIndex ? 'var(--success)' : 'var(--error)'}">Your answer:</strong> ${userAnswer}</div>
                <div><strong>Correct answer:</strong> ${correctAnswer}</div>
                <div style="margin-top: 0.5rem; background: #f0f8ff; padding: 0.75rem; border-radius: 0.5rem; font-size: 0.9rem;">
                    <strong>Explanation:</strong> ${question.explanation}
                </div>
            </div>
        `;
    });
    
    const percentage = (score / currentQuestions.length) * 100;
    let grade = '';
    let feedback = '';
    
    if (percentage >= 85) {
        grade = '5 (Extremely well qualified)';
        feedback = 'Outstanding! You demonstrate excellent mastery of AP Biology concepts and analytical reasoning.';
    } else if (percentage >= 70) {
        grade = '4 (Well qualified)';
        feedback = 'Strong performance! You have a solid understanding of complex biological systems and exam-level reasoning.';
    } else if (percentage >= 55) {
        grade = '3 (Qualified)';
        feedback = 'Good work! You understand fundamental concepts but should review specific challenging areas.';
    } else if (percentage >= 40) {
        grade = '2 (Possibly qualified)';
        feedback = 'Needs improvement. Focus on cellular energetics, genetics, and molecular biology concepts.';
    } else {
        grade = '1 (No recommendation)';
        feedback = 'Substantial review needed. Start with core AP Biology units: cell structure, metabolism, and basic genetics.';
    }
    
    resultsContainer.style.display = 'block';
    resultsContainer.innerHTML = `
        <div class="score-display">Score: ${score} / ${currentQuestions.length} (${percentage.toFixed(1)}%)</div>
        <div style="text-align: center; margin-bottom: 1.5rem; padding: 1rem; background: white; border-radius: 0.5rem; box-shadow: var(--shadow);">
            <div style="font-size: 1.2rem; color: var(--primary); margin-bottom: 0.5rem;">AP Score Equivalent: ${grade}</div>
            <div>${feedback}</div>
        </div>
        <h3 style="margin-bottom: 1rem; color: var(--primary);">Detailed Review:</h3>
        ${resultsHTML}
        <div style="text-align: center; margin-top: 1.5rem; font-size: 0.9rem; color: var(--text-light);">
            <strong>Study Suggestion:</strong> Review explanations for incorrect answers. For additional practice, use College Board AP Classroom resources, Khan Academy AP Biology, and AP-aligned review materials.
        </div>
    `;
    
    // Scroll to results
    setTimeout(() => {
        resultsContainer.scrollIntoView({ behavior: 'smooth' });
    }, 500);
    
    quizSubmitted = true;
    submitBtn.style.display = 'none';
    prevBtn.style.display = 'none';
    nextBtn.style.display = 'none';
    
    showMessage(`Quiz submitted! Score: ${score}/${currentQuestions.length}`, 'success');
}

// Show message
function showMessage(text, type) {
    messageEl.textContent = text;
    messageEl.className = `message message-${type}`;
    messageEl.style.display = 'block';
    
    if (type !== 'error') {
        setTimeout(() => {
            messageEl.style.display = 'none';
        }, 4000);
    }
}

// Event listeners
startBtn.addEventListener('click', () => {
    startScreen.style.display = 'none';
    quizContent.style.display = 'block';
    initQuiz();
});

prevBtn.addEventListener('click', prevQuestion);
nextBtn.addEventListener('click', nextQuestion);
submitBtn.addEventListener('click', checkAnswers);

restartBtn.addEventListener('click', () => {
    if (confirm('Are you sure you want to restart? All progress will be lost.')) {
        initQuiz();
        showMessage('Quiz restarted. Good luck!', 'success');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
});

// Keyboard navigation
document.addEventListener('keydown', (e) => {
    if (!quizSubmitted) {
        if (e.key === 'ArrowLeft') {
            if (currentQuestionIndex > 0) prevQuestion();
        } else if (e.key === 'ArrowRight') {
            if (currentQuestionIndex < currentQuestions.length - 1) nextQuestion();
        } else if (e.key >= 'a' && e.key <= 'd') {
            const optionIndex = e.key.charCodeAt(0) - 97;
            if (optionIndex >= 0 && optionIndex <= 3) {
                userAnswers[currentQuestionIndex] = optionIndex;
                renderQuestion();
            }
        } else if (e.key === 'Enter' && currentQuestionIndex === currentQuestions.length - 1) {
            checkAnswers();
        }
    }
});

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    quizContent.style.display = 'none';
    startScreen.style.display = 'block';
});
</script>

</body>
</html>
